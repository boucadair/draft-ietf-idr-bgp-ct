<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>BGP Classful Transport Planes</title>
<meta content="Kaliraj Vairavakkalai" name="author">
<meta content="Natrajan Venkataraman" name="author">
<meta content='
       This document specifies a mechanism, referred to as "Intent Driven
      Service Mapping" to express association of overlay routes with underlay
      routes satisfying a certain SLA using BGP. The document describes a
      framework for classifying underlay routes into transport classes and
      mapping service routes to specific transport class. 
       The "Transport class" construct maps to a desired SLA and can be used
      to realize the "Topology Slice" in 5G Network slicing architecture. 
       This document specifies BGP protocol procedures that enable
      dissemination of such service mapping information that may span multiple
      cooperating administrative domains. These domains may be administetered
      by the same provider or by closely co-ordinating provider networks. 
       A new BGP transport layer address family (SAFI 76) is defined for
      this purpose that uses RFC-4364 technology and follows RFC-8277 NLRI
      encoding. This new address family is called "BGP Classful Transport",
      aka BGP CT. 
       BGP CT makes it possible to advertise multiple tunnels to the same
      destination address, thus avoiding need of multiple loopbacks on the
      egress node. 
       It carries transport prefixes across tunnel domain boundaries (e.g.
      in Inter-AS Option-C networks), which is parallel to BGP LU (SAFI 4) .
      It disseminates "Transport class" information for the transport prefixes
      across the participating domains, which is not possible with BGP LU.
      This makes the end-to-end network a "Transport Class" aware tunneled
      network. 
       Just like BGP LU (SAFI 4), BGP CT family (SAFI 76) is used in
      inter-AS option-C networks. The Service Mapping procedures described in
      this document apply in the same manner to Intra-AS service end points as
      well as Inter-AS option-A, option-B, option-C variations. Examples of
      these variations are given in Appendix A. 
    ' name="description">
<meta content="xml2rfc 3.13.0" name="generator">
<meta content="draft-ietf-idr-bgp-ct-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.13.0
    Python 3.8.9
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.2
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 3.1.2
    kitchen 1.2.6
    lxml 4.9.0
    MarkupSafe 2.1.1
    pycountry 22.3.5
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.28.1
    setuptools 49.2.1
    six 1.15.0
-->
<link href="draft-ietf-idr-bgp-ct.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  pre.breakable {
    break-inside: auto;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">BGP Classful Transport Planes</td>
<td class="right">April 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Vairavakkalai &amp; Venkataraman</td>
<td class="center">Expires 11 October 2023</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-idr-bgp-ct-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-04-09" class="published">9 April 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Experimental</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2023-10-11">11 October 2023</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Vairavakkalai, <span class="editor">Ed.</span>
</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
<div class="author">
      <div class="author-name">N. Venkataraman, <span class="editor">Ed.</span>
</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">BGP Classful Transport Planes</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a mechanism, referred to as "Intent Driven
      Service Mapping" to express association of overlay routes with underlay
      routes satisfying a certain SLA using BGP. The document describes a
      framework for classifying underlay routes into transport classes and
      mapping service routes to specific transport class.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The "Transport class" construct maps to a desired SLA and can be used
      to realize the "Topology Slice" in 5G Network slicing architecture.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document specifies BGP protocol procedures that enable
      dissemination of such service mapping information that may span multiple
      cooperating administrative domains. These domains may be administetered
      by the same provider or by closely co-ordinating provider networks.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">A new BGP transport layer address family (SAFI 76) is defined for
      this purpose that uses RFC-4364 technology and follows RFC-8277 NLRI
      encoding. This new address family is called "BGP Classful Transport",
      aka BGP CT.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
<p id="section-abstract-5">BGP CT makes it possible to advertise multiple tunnels to the same
      destination address, thus avoiding need of multiple loopbacks on the
      egress node.<a href="#section-abstract-5" class="pilcrow">¶</a></p>
<p id="section-abstract-6">It carries transport prefixes across tunnel domain boundaries (e.g.
      in Inter-AS Option-C networks), which is parallel to BGP LU (SAFI 4) .
      It disseminates "Transport class" information for the transport prefixes
      across the participating domains, which is not possible with BGP LU.
      This makes the end-to-end network a "Transport Class" aware tunneled
      network.<a href="#section-abstract-6" class="pilcrow">¶</a></p>
<p id="section-abstract-7">Just like BGP LU (SAFI 4), BGP CT family (SAFI 76) is used in
      inter-AS option-C networks. The Service Mapping procedures described in
      this document apply in the same manner to Intra-AS service end points as
      well as Inter-AS option-A, option-B, option-C variations. Examples of
      these variations are given in Appendix A.<a href="#section-abstract-7" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-requirements-language-2">
<a href="#name-requirements-language-2" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-note.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in BCP 14
      <span><a href="#RFC2119" class="xref">RFC 2119</a> [<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span><a href="#RFC8174" class="xref">RFC
      8174</a> [<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown
      here.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-2">
<a href="#name-status-of-this-memo-2" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 11 October 2023.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-2">
<a href="#name-copyright-notice-2" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-2">
<a href="#name-table-of-contents-2" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-2" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology-2" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-transport-class-2" class="xref">Transport Class</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-transport-class-route-target" class="xref">"Transport Class" Route Target Extended Community</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-transport-route-database-2" class="xref">Transport Route Database</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-nexthop-resolution-scheme-2" class="xref">Nexthop Resolution Scheme</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-bgp-classful-transport-famil" class="xref">BGP Classful Transport Family NLRI</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-carrying-multiple-encapsulat" class="xref">Carrying multiple encapsulation information</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-usage-of-route-distinguisher" class="xref">Usage of Route Distinguisher and Label Allocation Modes</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-comparison-with-other-famili" class="xref">Comparison with other families using RFC-8277 encoding</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-protocol-procedures-2" class="xref">Protocol Procedures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-preparing-the-network-to-dep" class="xref">Preparing the network to deploy Classful Transport planes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-origination-of-classful-tran" class="xref">Origination of Classful Transport route</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-ingress-node-receiving-class" class="xref">Ingress node receiving Classful Transport route</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="xref">10.4</a>.  <a href="#name-border-node-readvertising-cl" class="xref">Border node readvertising Classful Transport route with nexthop self</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="xref">10.5</a>.  <a href="#name-border-node-receiving-classf" class="xref">Border node receiving Classful Transport route on EBGP</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="xref">10.6</a>.  <a href="#name-avoiding-path-hiding-through" class="xref">Avoiding path-hiding through Route Reflectors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a href="#section-10.7" class="xref">10.7</a>.  <a href="#name-avoiding-loop-between-route-" class="xref">Avoiding loop between Route Reflectors in forwarding path</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.8">
                <p id="section-toc.1-1.10.2.8.1"><a href="#section-10.8" class="xref">10.8</a>.  <a href="#name-ingress-node-receiving-servi" class="xref">Ingress node receiving service route with Mapping Community</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.9">
                <p id="section-toc.1-1.10.2.9.1"><a href="#section-10.9" class="xref">10.9</a>.  <a href="#name-coordinating-between-domains" class="xref">Coordinating between domains using different community namespaces</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.10">
                <p id="section-toc.1-1.10.2.10.1"><a href="#section-10.10" class="xref">10.10</a>. <a href="#name-best-effort-transport-class-2" class="xref">Best effort transport class</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-flowspec-redirect-to-ip-2" class="xref">Flowspec Redirect to IP</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-bgp-ct-egress-te-2" class="xref">BGP CT Egress TE</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-interaction-with-bgp-attribu" class="xref">Interaction with BGP attributes specifying nexthop address and color</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-signaling-intent-across-pe-c" class="xref">Signaling Intent across PE-CE link</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-using-dscp-in-multinexthop-a" class="xref">Using DSCP in MultiNexthop attribute</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-using-mpls-label-in-multinex" class="xref">Using MPLS Label in MultiNexthop attribute</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-scaling-considerations-2" class="xref">Scaling considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-avoiding-unintended-spread-o" class="xref">Avoiding unintended spread of BGP CT routes across domains</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-constrained-distribution-of-" class="xref">Constrained distribution of PNHs to SNs (On Demand Nexthop)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.3">
                <p id="section-toc.1-1.15.2.3.1"><a href="#section-15.3" class="xref">15.3</a>.  <a href="#name-limiting-scope-of-visibility" class="xref">Limiting scope of visibility of PE loopback as PNHs</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-oam-considerations-2" class="xref">OAM considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="xref">17</a>. <a href="#name-applicability-to-network-sli" class="xref">Applicability to Network Slicing</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-18" class="xref">18</a>. <a href="#name-srv6-support-2" class="xref">SRv6 support</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-19" class="xref">19</a>. <a href="#name-illustration-of-bgp-ct-proce" class="xref">Illustration of BGP CT procedures in Inter AS option-C</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.1">
                <p id="section-toc.1-1.19.2.1.1"><a href="#section-19.1" class="xref">19.1</a>.  <a href="#name-topology-6" class="xref">Topology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.2">
                <p id="section-toc.1-1.19.2.2.1"><a href="#section-19.2" class="xref">19.2</a>.  <a href="#name-service-layer-route-exchange-4" class="xref">Service Layer route exchange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.3">
                <p id="section-toc.1-1.19.2.3.1"><a href="#section-19.3" class="xref">19.3</a>.  <a href="#name-transport-layer-route-propag" class="xref">Transport Layer route propagation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.4">
                <p id="section-toc.1-1.19.2.4.1"><a href="#section-19.4" class="xref">19.4</a>.  <a href="#name-data-plane-view-2" class="xref">Data plane view</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.4.2.1">
                    <p id="section-toc.1-1.19.2.4.2.1.1"><a href="#section-19.4.1" class="xref">19.4.1</a>.  <a href="#name-steady-state-2" class="xref">Steady state</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.4.2.2">
                    <p id="section-toc.1-1.19.2.4.2.2.1"><a href="#section-19.4.2" class="xref">19.4.2</a>.  <a href="#name-local-repair-of-primary-path" class="xref">Local repair of primary path</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19.2.4.2.3">
                    <p id="section-toc.1-1.19.2.4.2.3.1"><a href="#section-19.4.3" class="xref">19.4.3</a>.  <a href="#name-absorbing-failure-of-primary" class="xref">Absorbing failure of primary path. Fallback to best-effort tunnels.</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#section-20" class="xref">20</a>. <a href="#name-deployment-considerations-2" class="xref">Deployment considerations.</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.1">
                <p id="section-toc.1-1.20.2.1.1"><a href="#section-20.1" class="xref">20.1</a>.  <a href="#name-managing-transport-route-vis" class="xref">Managing Transport Route Visibility</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2">
                <p id="section-toc.1-1.20.2.2.1"><a href="#section-20.2" class="xref">20.2</a>.  <a href="#name-managing-intent-at-service-a" class="xref">Managing Intent at Service and Transport layers.</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.1">
                    <p id="section-toc.1-1.20.2.2.2.1.1"><a href="#section-20.2.1" class="xref">20.2.1</a>.  <a href="#name-service-layer-color-manageme" class="xref">Service layer Color Management</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.2">
                    <p id="section-toc.1-1.20.2.2.2.2.1"><a href="#section-20.2.2" class="xref">20.2.2</a>.  <a href="#name-non-agreeing-color-domains-2" class="xref">Non-Agreeing Color Domains</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.2.2.3">
                    <p id="section-toc.1-1.20.2.2.2.3.1"><a href="#section-20.2.3" class="xref">20.2.3</a>.  <a href="#name-heterogeneous-agreeing-color" class="xref">Heterogeneous Agreeing Color Domains</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.3">
                <p id="section-toc.1-1.20.2.3.1"><a href="#section-20.3" class="xref">20.3</a>.  <a href="#name-migration-scenarios-2" class="xref">Migration scenarios.</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.3.2.1">
                    <p id="section-toc.1-1.20.2.3.2.1.1"><a href="#section-20.3.1" class="xref">20.3.1</a>.  <a href="#name-bgp-ct-islands-connected-via" class="xref">BGP CT islands connected via BGP LU domain.</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20.2.3.2.2">
                    <p id="section-toc.1-1.20.2.3.2.2.1"><a href="#section-20.3.2" class="xref">20.3.2</a>.  <a href="#name-bgp-ct-interop-between-mpls-an" class="xref">BGP CT - Interop between MPLS and other forwarding technologies.</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#section-21" class="xref">21</a>. <a href="#name-iana-considerations-2" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.1">
                <p id="section-toc.1-1.21.2.1.1"><a href="#section-21.1" class="xref">21.1</a>.  <a href="#name-new-bgp-safi-2" class="xref">New BGP SAFI</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2">
                <p id="section-toc.1-1.21.2.2.1"><a href="#section-21.2" class="xref">21.2</a>.  <a href="#name-new-format-for-bgp-extended-" class="xref">New Format for BGP Extended Community</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2.2.1">
                    <p id="section-toc.1-1.21.2.2.2.1.1"><a href="#section-21.2.1" class="xref">21.2.1</a>.  <a href="#name-existing-registries-to-be-mo" class="xref">Existing registries to be modified</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.2.2.2">
                    <p id="section-toc.1-1.21.2.2.2.2.1"><a href="#section-21.2.2" class="xref">21.2.2</a>.  <a href="#name-new-registries-to-be-created" class="xref">New registries to be created</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.3">
                <p id="section-toc.1-1.21.2.3.1"><a href="#section-21.3" class="xref">21.3</a>.  <a href="#name-mpls-oam-code-points-2" class="xref">MPLS OAM code points</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21.2.4">
                <p id="section-toc.1-1.21.2.4.1"><a href="#section-21.4" class="xref">21.4</a>.  <a href="#name-best-effort-transport-class-i" class="xref">Best Effort Transport Class ID</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#section-22" class="xref">22</a>. <a href="#name-security-considerations-2" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#section-23" class="xref">23</a>. <a href="#name-normative-references-2" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24">
            <p id="section-toc.1-1.24.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-applicability-to-intra-as-an" class="xref">Applicability to Intra AS and different Inter AS deployments.</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1">
                <p id="section-toc.1-1.24.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-intra-as-usecase-2" class="xref">Intra AS usecase</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1.2.1">
                    <p id="section-toc.1-1.24.2.1.2.1.1"><a href="#appendix-A.1.1" class="xref">A.1.1</a>.  <a href="#name-topology-7" class="xref">Topology</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1.2.2">
                    <p id="section-toc.1-1.24.2.1.2.2.1"><a href="#appendix-A.1.2" class="xref">A.1.2</a>.  <a href="#name-transport-layer-4" class="xref">Transport Layer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.1.2.3">
                    <p id="section-toc.1-1.24.2.1.2.3.1"><a href="#appendix-A.1.3" class="xref">A.1.3</a>.  <a href="#name-service-layer-route-exchange-5" class="xref">Service Layer route exchange</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2">
                <p id="section-toc.1-1.24.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-inter-as-option-a-usecase-2" class="xref">Inter AS option-A usecase</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2.2.1">
                    <p id="section-toc.1-1.24.2.2.2.1.1"><a href="#appendix-A.2.1" class="xref">A.2.1</a>.  <a href="#name-topology-8" class="xref">Topology</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2.2.2">
                    <p id="section-toc.1-1.24.2.2.2.2.1"><a href="#appendix-A.2.2" class="xref">A.2.2</a>.  <a href="#name-transport-layer-5" class="xref">Transport Layer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.2.2.3">
                    <p id="section-toc.1-1.24.2.2.2.3.1"><a href="#appendix-A.2.3" class="xref">A.2.3</a>.  <a href="#name-service-layer-route-exchange-6" class="xref">Service Layer route exchange</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.3">
                <p id="section-toc.1-1.24.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-inter-as-option-b-usecase-2" class="xref">Inter AS option-B usecase</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.3.2.1">
                    <p id="section-toc.1-1.24.2.3.2.1.1"><a href="#appendix-A.3.1" class="xref">A.3.1</a>.  <a href="#name-topology-9" class="xref">Topology</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.3.2.2">
                    <p id="section-toc.1-1.24.2.3.2.2.1"><a href="#appendix-A.3.2" class="xref">A.3.2</a>.  <a href="#name-transport-layer-6" class="xref">Transport Layer</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.24.2.3.2.3">
                    <p id="section-toc.1-1.24.2.3.2.3.1"><a href="#appendix-A.3.3" class="xref">A.3.3</a>.  <a href="#name-service-layer-route-exchange-7" class="xref">Service Layer route exchange</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25">
            <p id="section-toc.1-1.25.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-why-reuse-rfc-8277-and-rfc-4" class="xref">Why reuse RFC 8277 and RFC 4364?</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.25.2.1">
                <p id="section-toc.1-1.25.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-update-packing-consideration" class="xref">Update packing considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26">
            <p id="section-toc.1-1.26.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-scaling-using-bgp-mpls-names" class="xref">Scaling using BGP MPLS Namespaces</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.1">
                <p id="section-toc.1-1.26.2.1.1"><a href="#appendix-C.1" class="xref">C.1</a>.  <a href="#name-illustration-2" class="xref">Illustration.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.2">
                <p id="section-toc.1-1.26.2.2.1"><a href="#appendix-C.2" class="xref">C.2</a>.  <a href="#name-topology-10" class="xref">Topology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.3">
                <p id="section-toc.1-1.26.2.3.1"><a href="#appendix-C.3" class="xref">C.3</a>.  <a href="#name-context-protocol-nexthop-add" class="xref">Context Protocol Nexthop Address (CPNH)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.4">
                <p id="section-toc.1-1.26.2.4.1"><a href="#appendix-C.4" class="xref">C.4</a>.  <a href="#name-service-forwarding-helper-an" class="xref">Service Forwarding Helper, and changes to transport layer.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.5">
                <p id="section-toc.1-1.26.2.5.1"><a href="#appendix-C.5" class="xref">C.5</a>.  <a href="#name-bgp-mpls-namespace-address-f" class="xref">BGP MPLS Namespace Address family (AFI:16399, SAFI:128)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.6">
                <p id="section-toc.1-1.26.2.6.1"><a href="#appendix-C.6" class="xref">C.6</a>.  <a href="#name-changes-to-service-layer-rou" class="xref">Changes to Service Layer route exchange</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.26.2.7">
                <p id="section-toc.1-1.26.2.7.1"><a href="#appendix-C.7" class="xref">C.7</a>.  <a href="#name-analysis-of-forwarding-behav" class="xref">Analysis of forwarding behavior</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.27">
            <p id="section-toc.1-1.27.1"><a href="#appendix-D" class="xref">Appendix D</a>.  <a href="#name-bgp-ct-deployment-in-srv6-ne" class="xref">BGP CT deployment in SRv6 networks</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.28">
            <p id="section-toc.1-1.28.1"><a href="#appendix-E" class="xref"></a><a href="#name-contributors-2" class="xref">Contributors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.28.2.1">
                <p id="section-toc.1-1.28.2.1.1"><a href="#appendix-E.1" class="xref"></a><a href="#name-co-authors-2" class="xref">Co-Authors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.28.2.2">
                <p id="section-toc.1-1.28.2.2.1"><a href="#appendix-E.2" class="xref"></a><a href="#name-other-contributors-2" class="xref">Other Contributors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.29">
            <p id="section-toc.1-1.29.1"><a href="#appendix-F" class="xref"></a><a href="#name-acknowledgements-2" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.30">
            <p id="section-toc.1-1.30.1"><a href="#appendix-G" class="xref"></a><a href="#name-authors-addresses-2" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction-2">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The mechanisms defined in this document enable brownfiled networks
      deployed using existing technologies like RSVP-TE and greenfield
      networks that use technologies like SPRING achieve 'Intent Driven
      Service Mapping'.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">To facilitate this, the tunnels in a network can be grouped by the
      purpose they serve into a "Transport Class". These tunnels could be
      created using any signaling protocol including but not limited to LDP,
      RSVP-TE, BGP LU or SPRING. The tunnels may use MPLS, IPv4 or IPv6
      forwarding and carry one of the signaled payload types (e.g. MPLS).
      Tunnels may exist between different pair of end points. Multiple tunnels
      may exist between the same pair of end points.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">A Transport Class consists of tunnels created by various protocols
      that satisfy the properties of the class. For example, a "Gold"
      transport class may consist of tunnels that traverse the shortest path
      with fast re-route protection. A "Silver" transport class may hold
      tunnels that traverse shortest paths without protection. A "To NbrAS
      Foo" transport class may hold tunnels that exit to neighboring AS Foo
      and so on.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The extensions specified in this document can be used to create a BGP
      transport tunnel that potentially spans domains while preserving its
      Transport Class. Examples of domain are Autonomous System (AS) or IGP
      area. Within each domain, there is a second level underlay tunnel used
      by BGP to cross the domain. The second level underlay tunnels could be
      hetrogeneous; each domain may use a different type of tunnel (e.g. MPLS,
      IP, GRE or SRv6) and use a different signaling mechanism. A domain
      boundary is demarcated by a rewrite of BGP nexthop to 'self' while
      readvertising BGP CT transport routes. Examples of domain boundary are
      inter-AS links and inter-region ABRs. The path uses MPLS label-switching
      when crossing domain boundaries and uses the native intra-AS tunnel of
      the desired transport class when traversing within a domain.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Overlay routes carry sufficient indication of the desired Transport
      Classes in the form of a BGP community called the "Mapping community".
      The "route resolution" procedure on the ingress node selects an
      appropriate tunnel whose destination matches (LPM) the nexthop of the
      overlay route belonging to the corresponding Transport Class. If the
      overlay route is carried in BGP, the protocol nexthop (or PNH) is
      carried as an attribute of the route.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The PNH of the overlay route is also referred to as "Service
      Endpoint" (SEP). The SEP may exist in the same domain as the service
      ingress node or lie in a different domain, which is adjacent or
      non-adjacent. In the former case, reachability to the SEP is provided by
      an intra-domain tunneling protocol and in the latter case, reachability
      to the SEP is via BGP transport families (e.g. SAFI 4 or 76).<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">In this architecture, the intra-domain transport protocols (e.g.
      RSVP-TE, SRTE) are also "Transport Class aware". They publish ingress
      routes in the Transport Route Database associated with the Transport
      Class at the tunnel ingress node. These routes are used to resolve BGP
      routes inluding BGP CT which may be further readvertised to adjacent
      domains to extend this tunnel. How exactly the transport protocols are
      made transport class aware is outside the scope of this document.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">This document describes mechanisms to:<a href="#section-1-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-1-9.1">Model a "Transport Class" as a "Transport Route Database" on a
          router and to collect tunnel ingress routes of a certain class.<a href="#section-1-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-1-9.2">Enable service routes to resolve over an intended Transport Class
          by virtue of carrying the appropriate "Mapping Community", which
          results in using the corresponding Transport Route Database for
          finding nexthop reachability.<a href="#section-1-9.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-1-9.3">Publish tunnel ingress routes in a Transport Route Database via
          BGP without any path hiding using BGP VPN and Add-path procedures,
          such that overlay routes in the receiving domains can also resolve
          over tunnels of the associated Transport Class.<a href="#section-1-9.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-1-9.4">Provide a way for cooperating domains to reconcile any
          differences in extended community namespaces and interoperate
          between different transport signaling protocols in each domain.<a href="#section-1-9.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-1-10">In this document we focus mainly on MPLS as the intra-domain
      transport tunnel forwarding technology, but the mechanisms described
      here would work in similar manner for non-MPLS (e.g. IP, GRE, UDP or
      SRv6) transport tunnel forwarding technologies too.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">This document assumes MPLS forwarding as the defacto standard when
      crossing domain boundaries. However mechanisms specified in this
      document can also support different forwarding technologies (e.g. SRv6).
      Section 17 (SRv6 support) in this document describes the application of
      BGP CT over SRv6 data plane.<a href="#section-1-11" class="pilcrow">¶</a></p>
<p id="section-1-12">The document <span><a href="#Intent-Routing" class="xref">Intent-aware Routing using
      Color</a> [<a href="#Intent-Routing" class="xref">Intent-Routing</a>]</span> describes various use cases and applications of procedures
      described in this document.<a href="#section-1-12" class="pilcrow">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-terminology-2">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology-2" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">LSP: Label Switched Path.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">TE : Traffic Engineering.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">SN : Service Node. A router that sends or receives BGP Service routes
      (e.g. SAFIs 1, 128) with self as nexthop.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">BN : Border Node. A router that sends or receives BGP Transport
      routes (e.g. SAFI 4, 76) with self as nexthop.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">TN : Transport Node, P-router.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">BGP VPN : VPNs built using RFC4364 mechanisms.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">RT : Route-Target extended community.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">RD : Route-Distinguisher.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">VRF: Virtual Router Forwarding Table.<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">CsC: Carrier serving Carrier VPN.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">PNH : Protocol-Nexthop address carried in a BGP Update message.<a href="#section-2-11" class="pilcrow">¶</a></p>
<p id="section-2-12">EP : End point, a loopback address in the network.<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13">SEP : Service End point, the PNH of a Service route.<a href="#section-2-13" class="pilcrow">¶</a></p>
<p id="section-2-14">LPM : Longest Prefix Match.<a href="#section-2-14" class="pilcrow">¶</a></p>
<p id="section-2-15">SLA: Service Level Agreement.<a href="#section-2-15" class="pilcrow">¶</a></p>
<p id="section-2-16">EPE: Egress Peer Engineering.<a href="#section-2-16" class="pilcrow">¶</a></p>
<p id="section-2-17">UHP Label: Ultimate Hop Pop label.<a href="#section-2-17" class="pilcrow">¶</a></p>
<p id="section-2-18">PHP Label: Penultimate Hop Pop label.<a href="#section-2-18" class="pilcrow">¶</a></p>
<p id="section-2-19">Service Family : BGP address family used for advertising routes for
      "data traffic" as opposed to tunnels (e.g. SAFI 1 or 128).<a href="#section-2-19" class="pilcrow">¶</a></p>
<p id="section-2-20">Transport Family : BGP address family used for advertising tunnels,
      which are in turn used by service routes for resolution (e.g. SAFI 4 or
      76).<a href="#section-2-20" class="pilcrow">¶</a></p>
<p id="section-2-21">Transport Tunnel : A tunnel over which a service may place traffic
      (e.g. GRE, UDP, LDP, RSVP-TE or SPRING).<a href="#section-2-21" class="pilcrow">¶</a></p>
<p id="section-2-22">Tunnel Ingress Route: Route to Tunnel Destination/Endpoint installed
      at the headend (ingress) of the tunnel by the tunneling protocol.<a href="#section-2-22" class="pilcrow">¶</a></p>
<p id="section-2-23">Tunnel Domain : A domain of the network containing SNs and BNs under
      a single administrative control that has tunnels between them. An
      end-to-end tunnel spanning several adjacent tunnel domains can be
      created by "stitching" them together using labels.<a href="#section-2-23" class="pilcrow">¶</a></p>
<p id="section-2-24">Transport Class : A group of transport tunnels offering the same
      SLA.<a href="#section-2-24" class="pilcrow">¶</a></p>
<p id="section-2-25">Transport Class RT : A Route-Target extended community used to
      identify a specific Transport Class.<a href="#section-2-25" class="pilcrow">¶</a></p>
<p id="section-2-26">Transport Route Database : At the SN and BN, a Transport Class has an
      associated Transport Route Database that collects its tunnel ingress
      routes.<a href="#section-2-26" class="pilcrow">¶</a></p>
<p id="section-2-27">Transport Plane : An end to end plane comprising of transport tunnels
      belonging to same Transport Class. Tunnels of same Transport Class are
      stitched together by BGP CT route readvertisements with nexthop self to
      enable Label-Swap forwarding across domain boundaries.<a href="#section-2-27" class="pilcrow">¶</a></p>
<p id="section-2-28">Mapping Community : BGP Community/Extended-community on a BGP route
      that maps it to resolve over a Transport Class. E.g. color:0:100,
      transport-target:0:100.<a href="#section-2-28" class="pilcrow">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-transport-class-2">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-transport-class-2" class="section-name selfRef">Transport Class</a>
      </h2>
<p id="section-3-1">A Transport Class is defined as a set of transport tunnels that share
      the same SLA. It is encoded as the Transport Class RT, which is a new
      Route-Target extended community.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">A Transport Class is configured at SN and BN with RD and Route Target
      attributes. Creation of a Transport Class instantiates its corresponding
      Transport Route Database.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The operator may configure an SN/BN to classify a tunnel into an
      appropriate Transport Class, which causes the tunnel's ingress route to
      be installed in the corresponding Transport Route Database. These routes
      are used to resolve BGP routes inluding BGP CT which may be further
      readvertised to adjacent domains to extend this tunnel.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Alternatively, a router receiving the transport routes in BGP with
      appropriate signaling information can associate those ingress routes to
      the appropriate Transport Class. E.g. for Classful Transport family
      (SAFI 76) routes, the Transport Class RT indicates the Transport Class.
      For BGP LU family(SAFI 4) routes, import processing based on Communities
      or inter-AS source-peer may be used to place the route in the desired
      Transport Class.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">When the ingress route is received via <span><a href="#SRTE" class="xref">SRTE</a> [<a href="#SRTE" class="xref">SRTE</a>]</span> with "Color:Endpoint" as the NLRI that encodes
      the Transport Class as an integer 'Color', the 'Color' is mapped to a
      Transport Class during import processing. SRTE ingress route for
      'Endpoint' is installed in the corresponding Transport Route Database.
      The SRTE tunnel will be extended by a BGP CT advertisement with NLRI
      'RD:Endpoint', Transport Class RT and a new label. The MPLS swap route
      thus installed for the new label will pop the label and deliver
      decapsulated traffic into the path determined by SRTE route.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6"><span><a href="#RFC8664" class="xref">RFC8664</a> [<a href="#RFC8664" class="xref">RFC8664</a>]</span> extends PCEP to carry SRTE
      Color. This color association learnt from PCEP is also mapped to a
      Transport Class thus associating the PCEP signaled SRTE LSP with the
      desired Transport Class.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">Similarly, <span><a href="#PCEP-RSVP-COLOR" class="xref">PCEP-RSVP-COLOR</a> [<a href="#PCEP-RSVP-COLOR" class="xref">PCEP-RSVP-COLOR</a>]</span>
      extends PCEP to carry RSVP Color. This color association learnt from
      PCEP is also mapped to a Transport Class thus associating the PCEP
      signaled RSVP-TE LSP with the desired Transport Class.<a href="#section-3-7" class="pilcrow">¶</a></p>
</section>
<section id="section-4">
      <h2 id="name-transport-class-route-target">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-transport-class-route-target" class="section-name selfRef">"Transport Class" Route Target Extended Community</a>
      </h2>
<p id="section-4-1">This document defines a new type of Route Target, called "Transport
      Class" Route Target Extended Community.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">"Transport Class" Route Target extended community is a transitive
      extended community <span><a href="#RFC4360" class="xref">EXT-COMM</a> [<a href="#RFC4360" class="xref">RFC4360</a>]</span> of
      extended-type, with a new Format (Type high = 0xa) and SubType as 0x2
      (Route Target).<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">This new Route Target Format has the following encoding:<a href="#section-4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-4">
<pre>



 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Type= 0xa   | SubType= 0x02 |            Reserved           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Transport Class ID                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

      Fig 1: "Transport Class" Route Target Extended Community

 Type: 1 octet

    Type field contains value 0xa.

 SubType: 1 octet

    Subtype field contain 0x2. This indicates 'Route Target'.

 Transport Class ID: 4 octets

    The least significant 32-bits of the value field contain the
    "Transport Class" identifier, which is an unsigned non-zero
    32-bit integer.

    This document reserves the Transport class ID value 0 to
    represent "Best Effort Transport Class ID"

 The remaining 2 octets after SubType field are Reserved. They MUST
 be set to zero on transmission, SHOULD be ignored on reception and
 left unaltered.

</pre><a href="#section-4-4" class="pilcrow">¶</a>
</div>
<p id="section-4-5">The "Transport class" Route Target Extended community follows the
      mechanisms for VPN route import/export as specified in <span><a href="#RFC4364" class="xref">BGP VPN</a> [<a href="#RFC4364" class="xref">RFC4364</a>]</span> and follows the Constrained Route
      Distribution mechanisms as specified in <span><a href="#RFC4684" class="xref">Route
      Target Constraints</a> [<a href="#RFC4684" class="xref">RFC4684</a>]</span><a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">A BGP speaker that implements RT Constraint <span><a href="#RFC4684" class="xref">Route Target Constraints</a> [<a href="#RFC4684" class="xref">RFC4684</a>]</span> MUST apply the RT
      Constraint procedures to the "Transport class" Route Target Extended
      community as well.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">The Transport Class Route Target Extended community is carried on
      Classful Transport family routes and allows associating them with
      appropriate Transport Route Databases at receiving BGP speakers.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">Use of the Transport Class Route Target Extended community with a new
      Type code avoids conflicts with any VPN Route Target assignments already
      in use for service families.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
<section id="section-5">
      <h2 id="name-transport-route-database-2">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-transport-route-database-2" class="section-name selfRef">Transport Route Database</a>
      </h2>
<p id="section-5-1">A Transport Route Database is a logical collection of transport
      routes pertaining to the same Transport Class. Tunnel endpoint addresses
      in this database belong to the "Provider Namespace".<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Overlay routes that want to use a specific Transport Class confine
      the scope of nexthop resolution to the set of routes contained in the
      corresponding Transport Route Database.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The Transport Route Database can be realized as a "Routing Table"
      referred in <a href="https://www.rfc-editor.org/rfc/rfc4271#section-9.1.2.1">Section
      9.1.2.1 of RFC4271</a> which is a control plane only database.
      However, an implementation may choose a different methodology to realize
      this logical construct in such a way that it supports the procedures
      defined in this document.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">SN or BN originate routes for 'Classful Transport' address family
      from the Transport Route Database. These routes have NLRI "RD:Endpoint",
      Transport Class RT and an MPLS label. 'Classful Transport' family routes
      received with Transport Class RT are imported into its corresponding
      Transport Route Database.<a href="#section-5-4" class="pilcrow">¶</a></p>
</section>
<div id="Nexthop_Resoln_Schm">
<section id="section-6">
      <h2 id="name-nexthop-resolution-scheme-2">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-nexthop-resolution-scheme-2" class="section-name selfRef">Nexthop Resolution Scheme</a>
      </h2>
<p id="section-6-1">An implementation may provide an option for the service route to
      resolve over less preferred Transport Classes, should the resolution
      over preferred or "primary" Transport Class fail.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">To accomplish this, the set of service routes may be associated with
      a user-configured "Resolution Scheme" that consists of the primary
      Transport Class and an optional ordered list of fallback Transport
      Classes.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">A community known as "Mapping Community" is configured for a
      "resolution scheme". Mapping community is a "role" and not a new type of
      community; any BGP community or extended community may play this role. A
      Mapping Community maps to exactly one Resolution Scheme. A Resolution
      Scheme comprises of one primary transport class and optionally, one or
      more fallback transport classes. The Resolution scheme is used to
      realize the desired Intent.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">An example of mapping community is color:0:100, described in RFC
      9012, or the transport-target:0:100 described in section 4 in this
      document.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">A BGP route is associated with a resolution scheme during import
      processing. The first community on the route that matches a Mapping
      Community of a locally configured Resolution Scheme is considered the
      effective Mapping Community for the route. The Resolution Scheme thus
      found is used when resolving the route's PNH. If a route contains more
      than one Mapping Community, it indicates that the route considers these
      distinct Mapping Communities as equivalent in Intent. So, the first
      community that maps to a Resolution Scheme is chosen as the effective
      mapping community.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">A transport route received in BGP Classful Transport family SHOULD
      use a Resolution Scheme that contains the primary Transport Class
      without any fallback to best effort tunnels. The primary Transport Class
      is identified by the Transport Class RT carried on the route. Thus,
      Transport Class RT serves as the Mapping Community for BGP CT
      routes.<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">A service route received in a BGP service family MAY map to a
      Resolution Scheme that contains the primary Transport Class identified
      by the Mapping Community on the route and a fallback to best effort
      Transport Class. The primary Transport Class is identified by the
      Mapping Community carried on the route. For e.g. the Extended Color
      community may serve as the Mapping Community for service routes.
      Color:0:&lt;n&gt; MAY map to a Resolution Scheme that has primary
      Transport Class &lt;n&gt; and a fallback to best-effort Transport
      Class.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">The Resolution Scheme mechanism not only works with SPRING transport
      protocols to realize Intent based forwarding, but also with existing
      tunneling technologies like RSVP TE, GRE, UDP, etc. Not assuming a
      specific tunneling technology makes the BGP CT architecture backward and
      forward compatible with existing and newer tunneling protocols,
      respectively. It is compatible with SPRING, but there is no specific
      dependency on SPRING. It is more generic and has broader
      applicability.<a href="#section-6-8" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-bgp-classful-transport-famil">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-bgp-classful-transport-famil" class="section-name selfRef">BGP Classful Transport Family NLRI</a>
      </h2>
<p id="section-7-1">The Classful Transport (CT) family will use the existing AFI of IPv4
      or IPv6 and a new SAFI 76 "Classful Transport" that will apply to both
      IPv4 and IPv6 AFIs. These AFI, SAFI pair of values MUST be negotiated in
      Multiprotocol Extensions capability described in <span>[<a href="#RFC4760" class="xref">RFC4760</a>]</span> to be able to send and receive BGP CT routes.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The "Classful Transport" SAFI NLRI itself is encoded as specified in
      <span><a href="#RFC8277" class="xref">https://tools.ietf.org/html/rfc8277#section-2</a> [<a href="#RFC8277" class="xref">RFC8277</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">When AFI/SAFI is 1/76, the Classful Transport NLRI Prefix consists of
      an 8-byte RD followed by an IPv4 prefix. When AFI/SAFI is 2/76, the
      Classful Transport NLRI Prefix consists of an 8-byte RD followed by an
      IPv6 prefix.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">Procedures described for SAFI 4 or SAFI 128 in <span><a href="#RFC8277" class="xref">https://tools.ietf.org/html/rfc8277#section-2</a> [<a href="#RFC8277" class="xref">RFC8277</a>]</span>
      apply for SAFI 76 as well. BGP CT routes MAY carry multiple labels in
      the NLRI, by negotiating the Multiple Labels Capability as described in
      <span><a href="#RFC8277" class="xref">https://www.rfc-editor.org/rfc/rfc8277#section-2.1</a> [<a href="#RFC8277" class="xref">RFC8277</a>]</span><a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">For easy reference, the following figure illustrates a BGP Classful
      Transport family NLRI when single Label is advertised (Multiple Labels
      Capability is not negotiated):<a href="#section-7-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7-6">
<pre>

      0                   1                   2                   3
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |    Length     |                 Label                 |Rsrv |S|
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     ~                     Route Distinguisher (8 bytes)             |
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                     IPv4/IPv6 Prefix                          ~
     |                                                               |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

         Fig 2: SAFI 76 "Classful Transport" NLRI

 Length: 1 octet

    The Length field consists of a single octet.  It specifies the
    length in bits of the remainder of the NLRI field.

    Note that the length will always be the sum of 20 (number of bits
    in Label field), plus 3 (number of bits in Rsrv field), plus 1
    (number of bits in S field), plus the length in bits of the
    Prefix (RD:IP prefix).

    In an MP_REACH_NLRI attribute whose SAFI is 76, the Prefix
    (RD + IP prefix) will be 96 bits or less if the AFI is 1
    and will be 192 bits or less if the AFI is 2.

    As specified in [RFC4760], the actual length of the NLRI field
    will be the number of bits specified in the Length field, rounded
    up to the nearest integral number of octets.

 Label:

     The Label field is a 20-bit field containing an MPLS label value
     (see [RFC3032]).

 Rsrv:

     This 3-bit field SHOULD be set to zero on transmission and MUST be
     ignored on reception.

 S:
     When single label is advertised, this 1-bit field MUST be set to
     one on transmission and MUST be ignored on reception.


 Route Distinguihser:

     8 byte RD as defined in [RFC4364 Sec 4.2].

 IPv4/IPv6 Prefix:

    IPv4 prefix, if AFI/SAFI 1/76.
    IPv6 prefix, if AFI/SAFI 2/76.

</pre><a href="#section-7-6" class="pilcrow">¶</a>
</div>
<p id="section-7-7">Attributes on a Classful Transport route include the Transport Class
      Route-Target extended community, which is used to associate the route
      with the correct Transport Route Databases on SNs and BNs in the
      network.<a href="#section-7-7" class="pilcrow">¶</a></p>
<p id="section-7-8">SAFI 76 routes can be sent with either IPv4 or IPv6 nexthop. The type
      of nexthop is inferred from the length of the nexthop.<a href="#section-7-8" class="pilcrow">¶</a></p>
<p id="section-7-9">When the length of Next Hop Address field is 24 (or 48) the nexthop
      address is of type VPN-IPv6 with 8-octet RD set to zero (potentially
      followed by the link-local VPN-IPv6 address of the next hop with an
      8-octet RD set to zero).<a href="#section-7-9" class="pilcrow">¶</a></p>
<p id="section-7-10">When the length of the Next Hop Address field is 12 the nexthop
      address is of type VPN-IPv4 with 8-octet RD set to zero.<a href="#section-7-10" class="pilcrow">¶</a></p>
<div id="CTMultiEncap">
<section id="section-7.1">
        <h3 id="name-carrying-multiple-encapsulat">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-carrying-multiple-encapsulat" class="section-name selfRef">Carrying multiple encapsulation information</a>
        </h3>
<p id="section-7.1-1">To allow interoperating with nodes supporting different forwarding
        technologies, a BGP CT route allows carrying multiple encapsulation
        information.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">MPLS Label is carried using <span><a href="#RFC8277" class="xref">RFC 8277</a> [<a href="#RFC8277" class="xref">RFC8277</a>]</span>
        encoding. A node that does not support MPLS forwarding advertises the
        special label 3 (Implicit Null) in the RFC 8277 MPLS Label field.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">SRv6 SID is carried using Prefix SID attribute as specified in
        <span><a href="#RFC9252" class="xref">RFC 9252</a> [<a href="#RFC9252" class="xref">RFC9252</a>]</span>, without Transposition Scheme.
        The Transposition Length is set to 0 and Transposition Offset is set
        to 0 to indicate nothing is transposed and that the entire SRv6 SID
        value is encoded in the SID Information Sub-TLV.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">UDP tunneling information is carried using TEA attribute as
        specified in <span><a href="#RFC9012" class="xref">RFC 9012</a> [<a href="#RFC9012" class="xref">RFC9012</a>]</span>.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="section-8">
      <h2 id="name-usage-of-route-distinguisher">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-usage-of-route-distinguisher" class="section-name selfRef">Usage of Route Distinguisher and Label Allocation Modes</a>
      </h2>
<p id="section-8-1">RD aids in troubleshooting a BGP CT network by uniquely identifying
      the originator of a route across a multi domain network.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Use of RD also allows the option for signaling forwarding diversity
      within the same Transport Class. The same Egress PE can advertise
      multiple BGP CT routes for an EP belonging to the same Transport
      Class.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">E.g. multiple RDx:EP1 prefixes can be advertised for an EP1 to
      different set of BGP peers in order to collect traffic statistics for
      them. In absense of RD, duplicated Transport Class/Color values will be
      needed in the transport network to achieve such use cases.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">In a BGP CT network, the number of routes at an Ingress PE is a
      function of unique EPs multiplied by BNs in the ingress domain that do
      nexthop self. BGP CT provides flexible RD and Label allocation modes to
      address operational requirements in a multi-domain network.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">The allocation of RD is done at the point of origin of the BGP CT
      route. This can either be an Egress SN or a BN. The default RD
      allocation mode is to use unique RD per originiating node for an EP.
      This mode allows for the ingress to uniquely identify each originated
      path. Alternatively, the same RD may be provisioned for multiple
      originators of the same EP. This mode can be used when the ingress does
      not require full visibility of all nodes originating an EP.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">A label is allocated for a BGP CT route when it is advertised with
      nexthop self by a SN or a BN. An implementation may use different label
      allocation modes with BGP-CT. The recommended label allocation mode is
      per-prefix as it provides better traffic convergence properties than
      per-nexthop label allocation mode. Furthermore, BGP-CT offers two
      flavors for per-prefix label allocation. The first flavor assigns a
      label for each unique "RD, EP". The second flavor assigns a label for
      each unique "Transport Class, EP" while ignoring the RD.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">The impacts on control plane and forwarding behavior for the above
      modes are detailed with an example in <span><a href="#CTRouteVis" class="xref">Managing
      Transport Route Visibility</a> (<a href="#CTRouteVis" class="xref">Section 20.1</a>)</span><a href="#section-8-7" class="pilcrow">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-comparison-with-other-famili">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-comparison-with-other-famili" class="section-name selfRef">Comparison with other families using RFC-8277 encoding</a>
      </h2>
<p id="section-9-1">SAFI 128 (Inet-VPN) is an RFC8277 encoded family that carries service
      prefixes in the NLRI, where the prefixes come from the customer
      namespaces and are contexualized into separate user virtual service RIBs
      called VRFs using RFC4364 procedures.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">SAFI 4 (BGP LU) is an RFC8277 encoded family that carries transport
      prefixes in the NLRI, where the prefixes come from the provider
      namespace.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">SAFI 76 (Classful Transport) is an RFC8277 encoded family that
      carries transport prefixes in the NLRI, where the prefixes come from the
      provider namespace and are contexualized into separate Transport Route
      Databases using RFC4364 procedures.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">It is worth noting that SAFI 128 has been used to carry transport
      prefixes in "L3VPN Inter-AS Carrier's carrier" scenario, where BGP
      LU/LDP prefixes in CsC VRF are advertised in SAFI 128 towards the
      remote-end client carrier.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">In this document a new AFI/SAFI is used instead of reusing SAFI 128
      to carry these transport routes because it is operationally advantageous
      to segregate transport and service prefixes into separate address
      families. E.g. It allows to safely enable "per-prefix" label allocation
      scheme for Classful Transport prefixes without affecting SAFI 128
      service prefixes which may have huge scale. The "per prefix" label
      allocation scheme keeps the routing churn local during topology
      changes.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">A new family also facilitates having a different readvertisement path
      of the transport family routes in a network than the service route
      readvertisement path. Service routes (Inet-VPN) are exchanged over an
      EBGP multihop session between Autonomous systems with nexthop unchanged;
      whereas Classful Transport routes are readvertised over EBGP single hop
      sessions with "nexthop self" rewrite over inter-AS links.<a href="#section-9-6" class="pilcrow">¶</a></p>
<p id="section-9-7">The Classful Transport family is similar in vein to BGP LU, in that
      it carries transport prefixes. The only difference is that it also
      carries in Route Target, an indication of which Transport Class the
      transport prefix belongs to and uses RD to disambiguate multiple
      instances of the same transport prefix in a BGP Update.<a href="#section-9-7" class="pilcrow">¶</a></p>
</section>
<section id="section-10">
      <h2 id="name-protocol-procedures-2">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-protocol-procedures-2" class="section-name selfRef">Protocol Procedures</a>
      </h2>
<p id="section-10-1">This section summarizes the procedures followed by various nodes
      speaking Classful Transport family.<a href="#section-10-1" class="pilcrow">¶</a></p>
<section id="section-10.1">
        <h3 id="name-preparing-the-network-to-dep">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-preparing-the-network-to-dep" class="section-name selfRef">Preparing the network to deploy Classful Transport planes</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.1-1.1">Operator decides on the Transport Classes that exist in the
            network and allocates a Transport Class Route Target to identify
            each Transport Class.<a href="#section-10.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.1-1.2">Operator configures Transport Classes on the SNs and BNs in the
            network with Transport Class Route Targets and unique
            Route-Distinguishers.<a href="#section-10.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.1-1.3">Implementations MAY provide automatic generation and assignment
            of RD, RT values; they MAY also provide a way to manually override
            the automatic mechanism in order to deal with any conflicts that
            may arise with existing RD, RT values in different network domains
            participating in the deployment.<a href="#section-10.1-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-10.2">
        <h3 id="name-origination-of-classful-tran">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-origination-of-classful-tran" class="section-name selfRef">Origination of Classful Transport route</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.2-1.1">At the ingress node of the tunnel's home domain, the tunneling
            protocols install tunnel ingress routes in the Transport Route
            Database associated with the Transport Class the tunnel belongs
            to.<a href="#section-10.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.2-1.2">The egress node of the tunnel i.e. the tunnel endpoint
            originates the BGP Classful Transport route with NLRI containing
            RD:TunnelEndpoint, Transport Class RT and PNH TunnelEndpoint,
            which will resolve over the tunnel route in Transport Route
            Database at the ingress node. When the tunnel is up, the Classful
            Transport BGP route will become usable and get re-advertised.<a href="#section-10.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.2-1.3">Alternatively, the ingress node may advertise this tunnel
            destination into BGP as a Classful Transport family route with
            NLRI RD:TunnelEndpoint, attaching a 'Transport Class' Route Target
            that identifies the Transport Class. This BGP CT route is
            advertised to EBGP peers and IBGP peers in neighboring domains.
            This route SHOULD NOT be advertised to the IBGP core that contains
            the tunnel.<a href="#section-10.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.2-1.4">Unique RD SHOULD be used by the originator of a Classful
            Transport route to disambiguate the multiple BGP advertisements
            for a transport end point.<a href="#section-10.2-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-10.3">
        <h3 id="name-ingress-node-receiving-class">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-ingress-node-receiving-class" class="section-name selfRef">Ingress node receiving Classful Transport route</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.3-1.1">On receiving a BGP Classful Transport route with a PNH that is
          not directly connected (e.g. an IBGP-route), a Mapping Community on
          the route (the Transport Class RT) indicates which Resolution Scheme
          this route maps to. The resolution scheme for a Transport Class RT
          with Transport class ID "C1" contains Transport Route Database for
          Transport Class with same ID. In cases where Transport class "C1"
          tunnels are not available in a domain the administrator MAY
          customize the Resolution scheme to map to a different set of
          transport class available in that domain.<a href="#section-10.3-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.3-1.2">The routes in the associated Transport Route Databases are used
          to resolve the received PNH. If the resolution process does not find
          a matching route in any of the associated Transport Route Databases,
          the BGP CT route MUST be considered unusable for forwarding purpose
          and be withdrawn.<a href="#section-10.3-1.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-10.4">
        <h3 id="name-border-node-readvertising-cl">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-border-node-readvertising-cl" class="section-name selfRef">Border node readvertising Classful Transport route with nexthop self</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.4-1.1">The BN allocates an MPLS label to advertise upstream in Classful
          Transport NLRI. The BN also installs an MPLS route for that label
          that swaps the incoming label with a label received from the
          downstream BGP speaker or pops the incoming label. It then pushes
          received traffic to the transport tunnel or direct interface that
          the Classful Transport route's PNH resolved over.<a href="#section-10.4-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.4-1.2">The label SHOULD be allocated with "per-prefix" label allocation
          semantics. RD is stripped from the BGP CT NLRI prefix when a BGP CT
          route is added to a Transport Route Database. The IP prefix in the
          Transport Route Database context (Transport-Class, IP-prefix) is
          used as the key to do per-prefix label allocation. This helps in
          avoiding BGP CT route churn through out the CT network when a
          failure happens in a domain. The failure is not propagated further
          than the BN closest to the failure.<a href="#section-10.4-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.4-1.3">The value of advertised MPLS label is locally significant, and is
          dynamic by default. The BN may provide option to allocate a value
          from a statically carved out range. This can be achieved using
          locally configured export policy, or via mechanisms described in
          <span><a href="#RFC8669" class="xref">BGP Prefix-SID</a> [<a href="#RFC8669" class="xref">RFC8669</a>]</span>.<a href="#section-10.4-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-10.5">
        <h3 id="name-border-node-receiving-classf">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-border-node-receiving-classf" class="section-name selfRef">Border node receiving Classful Transport route on EBGP</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.5-1.1">If the route is received with PNH that is known to be directly
          connected (e.g. EBGP single-hop peering address), the directly
          connected interface is checked for MPLS forwarding capability. No
          other nexthop resolution process is performed as the inter-AS link
          can be used for any Transport Class.<a href="#section-10.5-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.5-1.2">If the inter-AS links should honor Transport Class, then the BN
          SHOULD follow procedures of an Ingress node described above and
          perform nexthop resolution process. The interface routes SHOULD be
          installed in the Transport Route Database belonging to the
          associated Transport Class.<a href="#section-10.5-1.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-10.6">
        <h3 id="name-avoiding-path-hiding-through">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-avoiding-path-hiding-through" class="section-name selfRef">Avoiding path-hiding through Route Reflectors</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.6-1.1">When multiple BNs exist such that theu advertise a RD:EP prefix
          to RRs, the RRs may hide all but one of the BNs, unless <span><a href="#RFC7911" class="xref">ADDPATH</a> [<a href="#RFC7911" class="xref">RFC7911</a>]</span> is used for the Classful Transport
          family. This is similar to L3VPN option-B scenarios. Hence ADDPATH
          SHOULD be used for Classful Transport family, to avoid path-hiding
          through RRs.<a href="#section-10.6-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-10.7">
        <h3 id="name-avoiding-loop-between-route-">
<a href="#section-10.7" class="section-number selfRef">10.7. </a><a href="#name-avoiding-loop-between-route-" class="section-name selfRef">Avoiding loop between Route Reflectors in forwarding path</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.7-1.1">Pair of redundant ABRs, each acting as an RR with nexthop self
          may chose each other as best path instead of the upstream ASBR,
          causing a traffic forwarding loop.<a href="#section-10.7-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.7-1.2">Implementations SHOULD provide a way to alter the tie-breaking
          rule specified in <span><a href="#RFC4456" class="xref">BGP RR</a> [<a href="#RFC4456" class="xref">RFC4456</a>]</span> to tie-break
          on CLUSTER_LIST step before ROUTER-ID step, when performing path
          selection for BGP CT routes. RFC4456 considers pure RR which is not
          in forwarding path. When RR is in forwarding path and reflects
          routes with nexthop self as is the case for ABR BNs in a BGP
          transport network, this rule may cause loops. This document suggests
          the following modification to the BGP Decision Process Tie Breaking
          rules (Sect. 9.1.2.2, <span>[<a href="#RFC4271" class="xref">RFC4271</a>]</span>) when doing path
          selection for BGP CT family routes:<a href="#section-10.7-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.7-1.3">The following rule SHOULD be inserted between Steps e) and f): a
          BGP Speaker SHOULD prefer a route with the shorter CLUSTER_LIST
          length. The CLUSTER_LIST length is zero if a route does not carry
          the CLUSTER_LIST attribute.<a href="#section-10.7-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.7-1.4">
            <p id="section-10.7-1.4.1">Some deployment considerations can also help in avoiding this
          problem:<a href="#section-10.7-1.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.7-1.4.2.1">IGP metric should be assigned such that "ABR to redundant
              ABR" cost is inferior than "ABR to upstream ASBR" cost.<a href="#section-10.7-1.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.7-1.4.2.2">Tunnels belonging to non best effort Transport Classes SHOULD
              NOT be provisioned between ABRs. This will ensure that the route
              received from an ABR with nexthop self will not be usable at a
              redundant ABR.<a href="#section-10.7-1.4.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-10.7-1.4.3"> This avoids possibility of such loops altogether.<a href="#section-10.7-1.4.3" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
<section id="section-10.8">
        <h3 id="name-ingress-node-receiving-servi">
<a href="#section-10.8" class="section-number selfRef">10.8. </a><a href="#name-ingress-node-receiving-servi" class="section-name selfRef">Ingress node receiving service route with Mapping Community</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.8-1.1">Service routes received with Mapping Community resolve using
          Transport Route Databases determined by the Resolution Scheme. If
          the resolution process does not find a Tunnel Ingress Route in any
          of the Transport Route Databases, the service route MUST be
          considered unusable for forwarding purpose and be withdrawn.<a href="#section-10.8-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-10.9">
        <h3 id="name-coordinating-between-domains">
<a href="#section-10.9" class="section-number selfRef">10.9. </a><a href="#name-coordinating-between-domains" class="section-name selfRef">Coordinating between domains using different community namespaces</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.9-1.1">Cooperating option-C domains may sometimes not agree on RT, RD,
          Mapping community or Transport Route Target values because of
          differences in community namespaces (e.g. during network mergers or
          renumbering for expansion). Such deployments may deploy mechanisms
          to map and rewrite the Route Target values on domain boundaries,
          using per ASBR import policies. This is no different than any other
          BGP VPN family. Mechanisms used in inter-AS VPN deployments may be
          used with the Classful Transport family also.<a href="#section-10.9-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.9-1.2">The Resolution Schemes SHOULD allow association with multiple
          Mapping Communities. This helps with renumbering, network mergers or
          transitions.<a href="#section-10.9-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.9-1.3">Deploying unique RDs is strongly RECOMMENDED because it helps in
          troubleshooting by uniquely identifying originator of a route and
          avoids path-hiding.<a href="#section-10.9-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.9-1.4">This document defines a new format of Route-Target
          extended-community to carry Transport Class, this avoids collision
          with regular Route Target namespace used by service routes.<a href="#section-10.9-1.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-10.10">
        <h3 id="name-best-effort-transport-class-2">
<a href="#section-10.10" class="section-number selfRef">10.10. </a><a href="#name-best-effort-transport-class-2" class="section-name selfRef">Best effort transport class</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-10.10-1.1">It is possible to represent 'Best effort' SLA also as a Transport
          class. Today BGP LU (SAFI 4) is used to extend best effort intra
          domain tunnels to other domains.<a href="#section-10.10-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.10-1.2">Alternatively, BGP CT (SAFI 76) may be used to carry best effort
          tunnels also. This document reserves the Transport class ID value 0
          to represent "Best Effort Transport Class ID". However,
          implementations SHOULD provide configuration to use a different
          value for this purpose.<a href="#section-10.10-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.10-1.3">The 'Best Effort Transport Class ID" value is used in the
          'Transport Class ID' field of Transport Route Target extended
          community that is attached to the BGP CT route that advertises a
          best effort tunnel endpoint. The route target thus formed is called
          the "Best Effort Transport class route target".<a href="#section-10.10-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.10-1.4">When a BN or SN receives a BGP CT route with Best Effort
          Transport class route target as the mapping community, the Best
          effort Resolution scheme is used for resolving the BGP nexthop, and
          the resultant route is installed in best effort transport route
          database. if no best effort tunnel was found to resolve the BGP
          nexthop, the BGP CT route MUST be considered unusable, and not be
          propagated further.<a href="#section-10.10-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.10-1.5">When a BGP speaker receives an overlay route without any explicit
          mapping community, the Best effort Resolution scheme is used for
          resolving the BGP nexthop on the route. This behavior is backward
          compatible to behavior of an implementation that does not follow
          procedures described in this document.<a href="#section-10.10-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-10.10-1.6">Implementations MAY provide configuration to selectively install
          BGP CT routes to the FIB, to provide reachability for control plane
          peering towards end points in other domains.<a href="#section-10.10-1.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</section>
<section id="section-11">
      <h2 id="name-flowspec-redirect-to-ip-2">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-flowspec-redirect-to-ip-2" class="section-name selfRef">Flowspec Redirect to IP</a>
      </h2>
<p id="section-11-1">Flowspec routes using Redirect to IP nexthop is described in <span><a href="#FLOWSPEC-REDIR-IP" class="xref">BGP Flow-Spec Redirect to IP
      Action</a> [<a href="#FLOWSPEC-REDIR-IP" class="xref">FLOWSPEC-REDIR-IP</a>]</span><a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">Such Flowspec BGP routes with Redirect to IP nexthop can be attached
      with a Mapping Community (e.g. Color:0:100), which allows redirecting
      the flow traffic over a tunnel to the IP nexthop satisfying the desired
      SLA (e.g. Transport Class color 100).<a href="#section-11-2" class="pilcrow">¶</a></p>
<p id="section-11-3">Flowspec BGP family acts as just another service that can make use of
      BGP CT architecture to achieve Flow based forwarding with SLAs.<a href="#section-11-3" class="pilcrow">¶</a></p>
</section>
<section id="section-12">
      <h2 id="name-bgp-ct-egress-te-2">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-bgp-ct-egress-te-2" class="section-name selfRef">BGP CT Egress TE</a>
      </h2>
<p id="section-12-1">Mechanisms described in <span><a href="#BGP-LU-EPE" class="xref">BGP LU EPE</a> [<a href="#BGP-LU-EPE" class="xref">BGP-LU-EPE</a>]</span>
      also applies to BGP CT family.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">The Peer/32 or Peer/128 EPE route MAY be originated in BGP CT family
      with appropriate Mapping Community (e.g. transport-target:0:100), thus
      allowing an EPE path to the peer that satisfies the desired SLA.<a href="#section-12-2" class="pilcrow">¶</a></p>
</section>
<section id="section-13">
      <h2 id="name-interaction-with-bgp-attribu">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-interaction-with-bgp-attribu" class="section-name selfRef">Interaction with BGP attributes specifying nexthop address and color</a>
      </h2>
<p id="section-13-1">The Tunnel Encapsulation Attribute described in <span><a href="#RFC9012" class="xref">RFC9012</a> [<a href="#RFC9012" class="xref">RFC9012</a>]</span> can be used to request a specific type
      of tunnel encapsulation. Usage of this attribute may apply to BGP
      service routes or transport routes, including BGP Classful Transport
      family routes.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">Mechanisms described in <span><a href="#MULTI-NH-ATTR" class="xref">BGP MultiNexthop
      Attribute</a> [<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> allow a BGP route to carry multiple nexthop addresses.
      It also allows specifying 'Transport Class ID' as a qualifier for each
      Nexthop address.<a href="#section-13-2" class="pilcrow">¶</a></p>
<p id="section-13-3">It should be noted that in such cases "Transport Class/Color" can
      exist in multiple places on the same route, and a precedence order needs
      to be established to determine which Transport class the route's nexthop
      should resolve over. This document suggests the following order of
      precedence, more preferred first:<a href="#section-13-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-13-4.1">Transport Class ID SubTLV, in MultiNexthop Attribute.<a href="#section-13-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-13-4.2">Color SubTLV, in Tunnel Encapsulation Attribute.<a href="#section-13-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-13-4.3">Transport Target Extended community, on BGP CT route.<a href="#section-13-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-13-4.4">Color Extended community, on BGP service route.<a href="#section-13-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-13-5"> The above precedence order follows more specific scoping of
      Color to less specific scoping.<a href="#section-13-5" class="pilcrow">¶</a></p>
<p id="section-13-6">Transport Class ID specified for Nexthop-Leg subTLV in a MultiNextHop
      attribute is more specific indication of Color than Color subTLV in a
      TEA, which inturn is more specific than Mapping Community (Transport
      Target) on a BGP CT transport route, which is inturn more specific than
      a Service route scoped Mapping Community (Color Extended community).<a href="#section-13-6" class="pilcrow">¶</a></p>
</section>
<section id="section-14">
      <h2 id="name-signaling-intent-across-pe-c">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-signaling-intent-across-pe-c" class="section-name selfRef">Signaling Intent across PE-CE link</a>
      </h2>
<p id="section-14-1">It may be desirable to allow a CE device to indicate in the data
      packet it sends what treatment it desires (the Intent) when the packet
      is forwarded within the provider network.<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">This section describes the mechanisms that enable such signaling.
      These procedures use existing service families (SAFI 1) on the PE-CE
      link, with a new BGP attribute. It does not require a forklift upgrade
      of the PE-CE session with a new set of address families.<a href="#section-14-2" class="pilcrow">¶</a></p>
<span id="name-intent-on-pe-ce-link-2"></span><div id="Intent_PE_CE">
<figure id="figure-1">
        <div class="alignLeft art-text artwork" id="section-14-3.1">
<pre>

                                    ---Gold-----&gt;
                      [CE1]-----[PE1]---[P]----[PE2]-----[CE2]
                                    ---Bronze---&gt;
                      11.0.0.0                         22.0.0.0
                          ----  Traffic direction ----&gt;
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-intent-on-pe-ce-link-2" class="selfRef">Intent on PE-CE link.</a>
        </figcaption></figure>
</div>
<section id="section-14.1">
        <h3 id="name-using-dscp-in-multinexthop-a">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-using-dscp-in-multinexthop-a" class="section-name selfRef">Using DSCP in MultiNexthop attribute</a>
        </h3>
<p id="section-14.1-1">One such indication can be in form of DSCP code point (<span><a href="#RFC2474" class="xref">RFC2474</a> [<a href="#RFC2474" class="xref">RFC2474</a>]</span>) in IP header.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<p id="section-14.1-2">Let PE1 be configured to map DSCP1 to Gold Transport class, and
        DSCP2 to Bronze Transport class. Based on the DSCP code point received
        on the IP traffic from CE1, the PE1 forwards the IP packet over a Gold
        or Bronze tunnel. Thus the forwarding is not based on just the
        destination IP address, but also the DSCP code point. This is known as
        Class Based Forwarding (CBF). Today CBF is configured at the PE1
        devices and CE1 doesn't receive any indication in BGP signaling
        regarding what DSCP code points are being offered by the provider
        network.<a href="#section-14.1-2" class="pilcrow">¶</a></p>
<p id="section-14.1-3">With a <span><a href="#MULTI-NH-ATTR" class="xref">BGP MultiNexthop
        Attribute</a> [<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> attached to a SAFI 1 service route, it is possible to
        extend the PE-CE BGP signalling to communicate such information to the
        CE1. In above example, the MNH contains two Nexthop Legs, described by
        two Forwarding Instruction TLVs. Each Nexthop Leg contains the PE1
        nexthop address in Endpoint Identifier TLV (<span>[<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> Sec 5.5.1.), the Transport class ID (Color)
        (<span>[<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> Sec 5.5.2.2.) for Gold, Bronze
        respectively, and associated DSCP code-point (<span>[<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> Sec 5.5.3.4.) to the CE1 device. This allows
        the CE to discover what transport classes exist in the provider
        network, and which DSCP codepoint to encode so that traffic is
        forwarded using the desired transport class.<a href="#section-14.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-14.2">
        <h3 id="name-using-mpls-label-in-multinex">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-using-mpls-label-in-multinex" class="section-name selfRef">Using MPLS Label in MultiNexthop attribute</a>
        </h3>
<p id="section-14.2-1">If the CE-PE link is MPLS enabled, a distinch MPLS label can also
        be used to identify the transport class. PE1 can allocate a MPLS Label
        L1 for the tuple "VPN Label, PNH Address, Transport class ID" and
        advertise to CE1. When MPLS packet with label L1 is received from CE1,
        the label is Popped, VPN Label if any is pushed, and then push tunnel
        encap information related to "PNH address, Transport class ID". PE1
        may thus do forwarding based on MPLS label without performaing any IP
        lookup. This allows for PE1 to be a low IP FIB device and still
        support CBF. The number of MPLS Labels will be proportional to the
        number of unique VPN labels received.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<p id="section-14.2-2">A <span><a href="#MULTI-NH-ATTR" class="xref">BGP MultiNexthop Attribute</a> [<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> is
        attached to a SAFI 1 service route to convey the MPLS Label
        information to CE1. In above example, the MNH contains two Nexthop
        Legs, described by two Forwarding Instruction TLVs. Each Nexthop Leg
        contains the PE1 nexthop address in Endpoint Identifier TLV (<span>[<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> Sec 5.5.1.), the Transport class ID (Color)
        (<span>[<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> Sec 5.5.2.2.) for Gold, Bronze
        respectively, and associated MPLS Label (<span>[<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> Sec 5.5.3.1.) to the CE1 device. This allows
        the CE to discover what transport classes exist in the provider
        network, and which MPLS Label to encode so that traffic is forwarded
        using the desired transport class.<a href="#section-14.2-2" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-15">
      <h2 id="name-scaling-considerations-2">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-scaling-considerations-2" class="section-name selfRef">Scaling considerations</a>
      </h2>
<section id="section-15.1">
        <h3 id="name-avoiding-unintended-spread-o">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-avoiding-unintended-spread-o" class="section-name selfRef">Avoiding unintended spread of BGP CT routes across domains</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.1-1.1">
            <span><a href="#RFC8212" class="xref">RFC8212</a> [<a href="#RFC8212" class="xref">RFC8212</a>]</span> suggests BGP speakers
          require explicit configuration of both BGP Import and Export
          Policies in order to receive or send routes over EBGP sessions.<a href="#section-15.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.1-1.2">It is recommended to follow this for BGP CT routes. It will
          prohibit unintended advertisement of transport routes throughout the
          BGP CT transport domain which may span across multiple AS domains.
          This will conserve usage of MPLS label and nexthop resources in the
          network. An ASBR of a domain can be provisioned to allow routes with
          only the Transport Route Targets that are required by SNs in the
          domain.<a href="#section-15.1-1.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-15.2">
        <h3 id="name-constrained-distribution-of-">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-constrained-distribution-of-" class="section-name selfRef">Constrained distribution of PNHs to SNs (On Demand Nexthop)</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.2-1.1">This section describes how the number of Protocol Nexthops
          advertised to a SN or BN can be constrained using BGP Classsful
          Transport and <span><a href="#RFC4684" class="xref">Route Target Constraints
          (RTC)</a> [<a href="#RFC4684" class="xref">RFC4684</a>]</span>.<a href="#section-15.2-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.2-1.2">An egress SN MAY advertise BGP CT route for RD:eSN with two Route
          Targets: transport-target:0:&lt;TC&gt; and a RT carrying
          &lt;eSN&gt;:&lt;TC&gt;. Where TC is the Transport Class identifier,
          and eSN is the IP-address used by SN as BGP nexthop in its service
          route advertisements.<a href="#section-15.2-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.2-1.3">Note that such use of the IP address specific route target
          &lt;eSN&gt;:&lt;TC&gt; is optional in a BGP CT network. It is
          required only if there is a requirement to prune the propagation of
          the transport route for an egress node eSN to only the set of
          ingress nodes that need it. When only RT of
          transport-target:0:&lt;TC&gt; is used, the pruning happens in
          granularity of Transport Class ID (Color), and not BGP nexthop; BGP
          CT routes will not be advertised into domains with PEs that dont
          import its transport class.<a href="#section-15.2-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.2-1.4">The transport-target:0:&lt;TC&gt; is the new type of route target
          (Transport Class RT) defined in this document. It is carried in BGP
          extended community attribute (BGP attribute code 16).<a href="#section-15.2-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.2-1.5">The RT carrying &lt;eSN&gt;:&lt;TC&gt; MAY be an IP-address
          specific regular RT (BGP attribute code 16), IPv6-address specific
          RT (BGP attribute code 25), or a Wide-communities based RT (BGP
          attribute code 34) as described in <span><a href="#RTC-Ext" class="xref">Route
          Target Constrain Extension</a> [<a href="#RTC-Ext" class="xref">RTC-Ext</a>]</span>. This document recommends using
          Wide-communities based RT for the same.<a href="#section-15.2-1.5" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.2-1.6">An ingress SN MAY import BGP CT routes with Route Target carrying
          &lt;eSN&gt;:&lt;TC&gt;. The ingress SN MAY learn the eSN values
          either by configuration, or it MAY discover them from the BGP
          nexthop field in the BGP VPN service routes received from eSN. A BGP
          ingress SN receiving a BGP service route with nexthop of eSN SHOULD
          generate a RTC/Extended-RTC route for Route Target prefix &lt;Origin
          ASN&gt;:&lt;eSN&gt;/[80|176] in order to learn BGP CT transport
          routes to reach eSN. This allows constrained distribution of the
          transport routes to the PNHs actually required by iSN.<a href="#section-15.2-1.6" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.2-1.7">When path of route propogation of BGP CT routes is same as the
          RTC routes, a BN would learn the RTC routes advertised by ingress
          SNs and propagate further. This will allow constraining distribution
          of BGP CT routes for a PNH to only the necessary BNs in the network,
          closer to the egress SN.<a href="#section-15.2-1.7" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.2-1.8">This mechanism provides "On Demand Nexthop" of BGP CT routes,
          which help with the scaling of MPLS forwarding state at SN and
          BN.<a href="#section-15.2-1.8" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.2-1.9">However, the amount of state carried in RTC family may become
          proportional to number of PNHs in the network. To strike a balance,
          the RTC route advertisements for &lt;Origin
          ASN&gt;:&lt;eSN&gt;/[80|176] MAY be confined to the BNs in home
          region of ingress-SN, or the BNs of a super core.<a href="#section-15.2-1.9" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.2-1.10">Such a BN in the core of the network SHOULD import BGP CT routes
          with Transport-Target:0:&lt;TC&gt; and generate a RTC route for
          &lt;Origin ASN&gt;:0:&lt;TC&gt;/96, while not propagating the more
          specific RTC requests for specific PNHs. This will let the BN learn
          transport routes to all eSN nodes. But confine their propagation to
          ingress-SNs.<a href="#section-15.2-1.10" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-15.3">
        <h3 id="name-limiting-scope-of-visibility">
<a href="#section-15.3" class="section-number selfRef">15.3. </a><a href="#name-limiting-scope-of-visibility" class="section-name selfRef">Limiting scope of visibility of PE loopback as PNHs</a>
        </h3>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-15.3-1.1">It may be even more desirable to limit the number of PNHs that
          are globaly visible in the network. This is possible using mechanism
          described in <span><a href="#MPLS-NAMESPACES" class="xref">MPLS
          Namespaces</a> [<a href="#MPLS-NAMESPACES" class="xref">MPLS-NAMESPACES</a>]</span><a href="#section-15.3-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.3-1.2">Such that advertisement of PE loopback addresses as next-hop in
          BGP service routes is confined to the region they belong to. An
          anycast IP-address called "Context Protocol Nexthop Address" (CPNH)
          abstracts the SNs in a region from other regions in the network,
          swapping the SN scoped service label with a CPNH scoped private
          namespace label.<a href="#section-15.3-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-15.3-1.3">This provides much greater advantage in terms of scaling and
          convergence. Changes to implement this feature are required only on
          the local region's BNs and RRs.<a href="#section-15.3-1.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</section>
<section id="section-16">
      <h2 id="name-oam-considerations-2">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-oam-considerations-2" class="section-name selfRef">OAM considerations</a>
      </h2>
<p id="section-16-1">Standard MPLS OAM procedures specified in <span>[<a href="#RFC8029" class="xref">RFC8029</a>]</span>
      also apply to BGP Classful Transport.<a href="#section-16-1" class="pilcrow">¶</a></p>
<p id="section-16-2">The 'Target FEC Stack' sub-TLV for IPv4 Classful Transport has a
      Sub-Type of [TBD], and a length of 13. The Value field consists of the
      RD advertised with the Classful Transport prefix, the IPv4 prefix (with
      trailing 0 bits to make 32 bits in all) and a prefix length encoded as
      follows:<a href="#section-16-2" class="pilcrow">¶</a></p>
<span id="name-classful-transport-ipv4-fec-2"></span><div id="FECv4">
<figure id="figure-2">
        <div class="alignLeft art-text artwork" id="section-16-3.1">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Route Distinguisher                      |
      |                          (8 octets)                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         IPv4 prefix                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Prefix Length |                 Must Be Zero                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-classful-transport-ipv4-fec-2" class="selfRef">Classful Transport IPv4 FEC</a>
        </figcaption></figure>
</div>
<p id="section-16-4">The 'Target FEC Stack' sub-TLV for IPv6 Classful Transport has a
      Sub-Type of [TBD], and a length of 25. The Value field consists of the
      RD advertised with the Classful Transport prefix, the IPv6 prefix (with
      trailing 0 bits to make 128 bits in all) and a prefix length encoded as
      follows:<a href="#section-16-4" class="pilcrow">¶</a></p>
<span id="name-classful-transport-ipv6-fec-2"></span><div id="FECv6">
<figure id="figure-3">
        <div class="alignLeft art-text artwork" id="section-16-5.1">
<pre>
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                      Route Distinguisher                      |
      |                          (8 octets)                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                         IPv6 prefix                           |
      |                                                               |
      |                                                               |
      |                                                               |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      | Prefix Length |                 Must Be Zero                  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-classful-transport-ipv6-fec-2" class="selfRef">Classful Transport IPv6 FEC</a>
        </figcaption></figure>
</div>
</section>
<section id="section-17">
      <h2 id="name-applicability-to-network-sli">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-applicability-to-network-sli" class="section-name selfRef">Applicability to Network Slicing</a>
      </h2>
<p id="section-17-1">In Network Slicing, the Transport Slice Controller (TSC) sets up the
      Topology (e.g. RSVP-TE, SR-TE tunnels with desired characteristics) and
      resources (e.g. polices/shapers) in a transport network to create a
      Transport Slice. The Transport Class construct described in this
      document represents the "Topology Slice" portion of this equation.<a href="#section-17-1" class="pilcrow">¶</a></p>
<p id="section-17-2">The TSC can use the Transport Class Identifier (Color value) to
      provision a transport tunnel in a specific Topology Slice.<a href="#section-17-2" class="pilcrow">¶</a></p>
<p id="section-17-3">Further, Network Slice Controller can use the Mapping Community on
      the service route to map traffic to the desired Transport Slice.<a href="#section-17-3" class="pilcrow">¶</a></p>
</section>
<section id="section-18">
      <h2 id="name-srv6-support-2">
<a href="#section-18" class="section-number selfRef">18. </a><a href="#name-srv6-support-2" class="section-name selfRef">SRv6 support</a>
      </h2>
<p id="section-18-1">This section describes how BGP CT may be used to set up inter domain
      tunnels of a certain Transport Class, when using Segment Routing over
      IPv6 (SRv6) data plane on the inter AS links or as an intra AS tunneling
      mechanism.<a href="#section-18-1" class="pilcrow">¶</a></p>
<p id="section-18-2"><span>[<a href="#RFC8986" class="xref">RFC8986</a>]</span> specifies the SRv6 Endpoint behaviors (End
      USD, End.BM, End.B6.Encaps). <span>[<a href="#SRV6-INTER-DOMAIN" class="xref">SRV6-INTER-DOMAIN</a>]</span>
      specifies the SRv6 Endpoint behaviors (END.REPLACE, END.REPLACEB6 and
      END.DB6). These are leveraged for BGP CT with SRv6 data plane.<a href="#section-18-2" class="pilcrow">¶</a></p>
<p id="section-18-3">The BGP Classful Transport route update for SRv6 MUST include an
      attribute containing SRv6 SID information. This may be either the BGP
      Prefix-SID attribute as specified in <span>[<a href="#RFC9252" class="xref">RFC9252</a>]</span>or the BGP
      MultiNexthop attribute as specified in <span><a href="#MULTI-NH-ATTR" class="xref">BGP
      MultiNexthop Attribute</a> [<a href="#MULTI-NH-ATTR" class="xref">MULTI-NH-ATTR</a>]</span> section 5.5.3.3. If the Prefix-SID
      attribute is used, it MUST NOT include SRv6 SID structure for
      Transposition described in <span>[<a href="#RFC9252" class="xref">RFC9252</a>]</span>.<a href="#section-18-3" class="pilcrow">¶</a></p>
<p id="section-18-4">It should be noted that prefixes carried in BGP CT family are
      transport layer end-points, e.g. PE loopback addresses. Thus the SRv6
      SID carried in a BGP CT route is also a transport layer identifier. For
      an illustration of BGP CT deployment in SRv6 newtorks, please refer to
      Appendix D <a href="#AppendixD" class="xref">Appendix D</a> .<a href="#section-18-4" class="pilcrow">¶</a></p>
</section>
<div id="CTProc">
<section id="section-19">
      <h2 id="name-illustration-of-bgp-ct-proce">
<a href="#section-19" class="section-number selfRef">19. </a><a href="#name-illustration-of-bgp-ct-proce" class="section-name selfRef">Illustration of BGP CT procedures in Inter AS option-C</a>
      </h2>
<section id="section-19.1">
        <h3 id="name-topology-6">
<a href="#section-19.1" class="section-number selfRef">19.1. </a><a href="#name-topology-6" class="section-name selfRef">Topology</a>
        </h3>
<span id="name-multi-domain-bgp-ct-network-2"></span><div id="RDLabelVisibility">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-19.1-1.1">
<pre>

                [RR26]      [RR27]                       [RR16]
                 |            |                             |
                 |            |                             |
                 |+-[ABR23]--+|+--[ASBR21]---[ASBR13]-+|+--[PE11]--+
                 ||          |||          `  /        |||          |
[CE41]--[PE25]--[P28]       [P29]          `/        [P15]     [CE31]
                 |           | |           /`         | |          |
                 |           | |          /  `        | |          |
                 |           | |         /    `       | |          |
                 +--[ABR24]--+ +--[ASBR22]---[ASBR14]-+ +--[PE12]--+


       |                |                  |                    |
       +                +                  +                    +
    CE |     region-1   |   region-2       |                    |CE
   AS4              ...AS2...                       AS1          AS3

41.41.41.41  ------------ Traffic Direction ----------&gt;   31.31.31.31
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-multi-domain-bgp-ct-network-2" class="selfRef">Multi-Domain BGP CT Network</a>
          </figcaption></figure>
</div>
<p id="section-19.1-2">This example shows a provider network that comprises of two
        Autonomous systems, AS1, AS2. They are serving customers AS3, AS4
        respectively. Traffic direction being described is CE41 to CE31. CE31
        may request a specific SLA (e.g. Gold for this traffic), when
        traversing these provider networks.<a href="#section-19.1-2" class="pilcrow">¶</a></p>
<p id="section-19.1-3">AS2 is further divided into two regions. So, there are three tunnel
        domains in provider space. AS1 uses ISIS Flex-Algo intra-domain
        tunnels, whereas AS2 uses RSVP-TE intra-domain tunnels.<a href="#section-19.1-3" class="pilcrow">¶</a></p>
<p id="section-19.1-4">The network has two Transport classes: Gold with transport class id
        100, Bronze with transport class id 200. These transport classes are
        provisioned at the PEs and the Border nodes (ABRs, ASBRs) in the
        network.<a href="#section-19.1-4" class="pilcrow">¶</a></p>
<p id="section-19.1-5">Following tunnels exist for Gold transport class.<a href="#section-19.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-19.1-6.1">PE25_to_ABR23_gold - RSVP-TE tunnel<a href="#section-19.1-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-19.1-6.2">PE25_to_ABR24_gold - RSVP-TE tunnel<a href="#section-19.1-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-19.1-6.3">ABR23_to_ASBR22_gold - RSVP-TE tunnel<a href="#section-19.1-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-19.1-6.4">ASBR13_to_PE11_gold - ISIS FlexAlgo tunnel<a href="#section-19.1-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-19.1-6.5">ASBR14_to_PE11_gold - ISIS FlexAlgo tunnel<a href="#section-19.1-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-19.1-7">Following tunnels exist for Bronze transport class.<a href="#section-19.1-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-19.1-8.1">PE25_to_ABR23_bronze - RSVP-TE tunnel<a href="#section-19.1-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-19.1-8.2">ABR23_to_ASBR21_bronze - RSVP-TE tunnel<a href="#section-19.1-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-19.1-8.3">ABR23_to_ASBR22_bronze - RSVP-TE tunnel<a href="#section-19.1-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-19.1-8.4">ABR24_to_ASBR21_bronze - RSVP-TE tunnel<a href="#section-19.1-8.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-19.1-8.5">ASBR13_to_PE12_bronze - ISIS FlexAlgo tunnel<a href="#section-19.1-8.5" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-19.1-8.6">ASBR14_to_PE11_bronze - ISIS FlexAlgo tunnel<a href="#section-19.1-8.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-19.1-9">These tunnels are either provisioned or auto-discovered to belong
        to transport class 100 or 200.<a href="#section-19.1-9" class="pilcrow">¶</a></p>
</section>
<section id="section-19.2">
        <h3 id="name-service-layer-route-exchange-4">
<a href="#section-19.2" class="section-number selfRef">19.2. </a><a href="#name-service-layer-route-exchange-4" class="section-name selfRef">Service Layer route exchange</a>
        </h3>
<p id="section-19.2-1">Service nodes PE11, PE12 negotiate service families (SAFIs 1, 128)
        on the BGP session with RR16. Service helpers RR16 and RR26 exchange
        these service routes with nexthop unchanged over a multihop EBGP
        session between the two AS. PE25 negotiates service families (SAFIs 1,
        128) with RR26.<a href="#section-19.2-1" class="pilcrow">¶</a></p>
<p id="section-19.2-2">The PEs see each other as nexthop in the BGP Update for service
        family (SAFIs 1, 128) routes. Addpath send, receive is enabled on both
        directions on the EBGP multihop session between RR16 and RR26 for
        SAFIs 1, 128. Addpath send is negotiated in the RR to PE direction in
        each AS. This is to avoid path hiding of service routes at RR. E.g.
        SAFI 1 routes advertised by both PE11 and PE12. Or, SAFI 128 routes
        originated by both PE11 and PE12 using same RD.<a href="#section-19.2-2" class="pilcrow">¶</a></p>
<p id="section-19.2-3">Forwarding happens using service routes installed at service nodes
        PE25, PE11, PE12 only. Service routes received from CEs are not
        present in any other nodes' FIB in the network.<a href="#section-19.2-3" class="pilcrow">¶</a></p>
<p id="section-19.2-4">As an example, CE31 advertises a route for prefix 31.31.31.31 with
        nexthop as self to PE11, PE12. CE31 can attach a Mapping Community
        Color:0:100 on this route, to indicate its request for Gold SLA. Or,
        PE11 can attach the same using locally configured policies.<a href="#section-19.2-4" class="pilcrow">¶</a></p>
<p id="section-19.2-5">Consider CE31 is getting VPN service from PE11. The RD1:31.31.31.31
        route is readvertised in SAFI 128 by PE11 with nexthop self (1.1.1.1)
        and label V-L1, to RR16 with the Mapping Community Color:0:100
        attached. RR16 advertises this route with Addpath-ID to RR26 which
        readvertises to PE25 with nexthop unchanged. Now PE25 can resolve the
        PNH 1.1.1.1 using transport routes received in BGP CT or BGP LU.<a href="#section-19.2-5" class="pilcrow">¶</a></p>
<p id="section-19.2-6">Using Addpath, service routes advertised by PE11 and PE12 for SAFIs
        1, 128 reach PE25 via RR16, RR26 with the nexthop unchanged, as PE11
        or PE12.<a href="#section-19.2-6" class="pilcrow">¶</a></p>
<p id="section-19.2-7">The IP FIB at PE25 VRF will have a route for 31.31.31.31 with a
        nexthop when resolved, that points to a Gold tunnel in ingress
        domain.<a href="#section-19.2-7" class="pilcrow">¶</a></p>
</section>
<section id="section-19.3">
        <h3 id="name-transport-layer-route-propag">
<a href="#section-19.3" class="section-number selfRef">19.3. </a><a href="#name-transport-layer-route-propag" class="section-name selfRef">Transport Layer route propagation</a>
        </h3>
<p id="section-19.3-1">Egress nodes PE11, PE12 negotiate BGP CT family with transport
        ASBRs ASBR13, ASBR14. These egress nodes originate BGP CT routes for
        tunnel endpoint addresses, that are advertised as nexthop in BGP
        service routes. In this example both PEs participate in transport
        classes Gold and Bronze. The protocol procedures are explained using
        Gold SLA plane and the Bronze SLA plane is used to highlight the path
        hiding aspects.<a href="#section-19.3-1" class="pilcrow">¶</a></p>
<p id="section-19.3-2">PE11 is provisioned with transport class 100, RD value 1.1.1.1:10
        and a transport-target:0:100 for Gold tunnels. And a Transport class
        200 with RD value 1.1.1.1:20, and transport route target 0:200 for
        Bronze tunnels. Similarly, PE12 is provisioned with transport class
        100, RD value 1.1.1.2:10 and a transport-target:0:100 for Gold
        tunnels. And transport class 200, RD value 1.1.1.2:20 with
        transport-target:0:200 for Bronze tunnels. Note that in this example
        the BGP CT routes carry only the transport class route target, and no
        IP address format route target.<a href="#section-19.3-2" class="pilcrow">¶</a></p>
<p id="section-19.3-3">The RD value originated by an egress node is not modified by any
        BGP speakers when the route is readvertised to the ingress node. Thus
        the RD can be used to identify the originator (unique RD provisioned)
        or set of originators (RD reused on multiple nodes).<a href="#section-19.3-3" class="pilcrow">¶</a></p>
<p id="section-19.3-4">Similarly, these transport classes are also configured on ASBRs,
        ABRs and PEs with same Transport Route Target and unique RDs.<a href="#section-19.3-4" class="pilcrow">¶</a></p>
<p id="section-19.3-5">ASBR13 and ASBR14 negotiate BGP CT family with transport ASBRs
        ASBR21, ASBR22 in neighboring AS. They negotiate BGP CT family with
        RR27 in region 2, which reflects BGP CT routes to ABR23, ABR24. ABR23,
        ABR24 negotiate BGP CT family with Ingress node PE25 in region 1. BGP
        LU family is also negotiated on these sessions alongside BGP CT
        family. BGP LU carries "best effort" transport class routes, BGP CT
        carries gold, bronze transport class routes.<a href="#section-19.3-5" class="pilcrow">¶</a></p>
<p id="section-19.3-6">PE11 is provisioned to originate BGP CT route with Gold SLA to
        endpoint PE11. This route is sent with NLRI RD prefix
        1.1.1.1:10:1.1.1.1, Label B-L0, nexthop 1.1.1.1 and a route target
        extended community transport-target:0:100. Label B-L0 can either be
        Implicit Null (Label 3) or a Ultimate Hop Pop (UHP) label.<a href="#section-19.3-6" class="pilcrow">¶</a></p>
<p id="section-19.3-7">This route is received by ASBR13 and it resolves over the tunnel
        ASBR13_to_PE11_gold. The route is then readvertised by ASBR13 in BGP
        CT family to ASBRs ASBR21, ASBR22 according to export policy. This
        route is sent with same NLRI RD prefix 1.1.1.1:10:1.1.1.1, Label B-L1,
        nexthop self, and transport-target:0:100. MPLS swap route is installed
        at ASBR13 for B-L1 with a nexthop pointing to ASBR13_to_PE11_gold
        tunnel.<a href="#section-19.3-7" class="pilcrow">¶</a></p>
<p id="section-19.3-8">Similarly ASBR14 also receives BGP CT route for 1.1.1.1:10:1.1.1.1
        from PE11 and it resolves over the tunnel ASBR14_to_PE11_gold. The
        route is then readvertised by ASBR14 in BGP CT family to ASBRs ASBR21,
        ASBR22 according to export policy. This route is sent with same NLRI
        RD prefix 1.1.1.1:10:1.1.1.1, Label B-L2, nexthop self, and
        transport-target:0:100. MPLS swap route is installed at ASBR14 for
        B-L1 with a nexthop pointing to ASBR14_to_PE11_gold tunnel.<a href="#section-19.3-8" class="pilcrow">¶</a></p>
<p id="section-19.3-9">In the Bronze plane, BGP CT route with Bronze SLA to endpoint PE11
        is originated by PE11 with a NLRI containing RD prefix
        1.1.1.1:20:1.1.1.1, and appropriate label. The RD allows both Gold and
        Bronze advertisements traverse path selection pinchpoints without any
        path hiding at RRs or ASBRs. And route target extended community
        transport-target:0:200 lets the route resolve over Bronze tunnels in
        the network, similar to the process being described for Gold SLA
        path.<a href="#section-19.3-9" class="pilcrow">¶</a></p>
<p id="section-19.3-10">Moving back to the Gold plane, ASBR21 receives the Gold SLA BGP CT
        routes for NLRI RD prefix 1.1.1.1:10:1.1.1.1 over the single hop EBGP
        sessions from ASBR13, ASBR14, and can compute ECMP/FRR towards them.
        ASBR21 readvertises BGP CT route for 1.1.1.1:10:1.1.1.1 with nexthop
        self (loopback adderss 2.2.2.1) to RR27, advertising a new label B-L3.
        MPLS swap route is installed for label B-L3 at ASBR21 to swap to
        received label B-L1, B-L2 and forward to ASBR13, ASBR14 respectively.
        RR27 readvertises this BGP CT route to ABR23, ABR24 with label and
        nexthop unchanged.<a href="#section-19.3-10" class="pilcrow">¶</a></p>
<p id="section-19.3-11">Similarly, ASBR22 receives BGP CT route 1.1.1.1:10:1.1.1.1 over the
        single hop EBGP sessions from ASBR13, ASBR14, and readvertises with
        nexthop self (loopback adderss 2.2.2.2) to RR27, advertising a new
        label B-L4. MPLS swap route is installed for label B-L4 at ASBR22 to
        swap to received label B-L1, B-L2 and forward to ASBR13, ASBR14
        respectively. RR27 readvertises this BGP CT route also to ABR23, ABR24
        with label and nexthop unchanged.<a href="#section-19.3-11" class="pilcrow">¶</a></p>
<p id="section-19.3-12">Addpath is enabled for BGP CT family on the sessions between RR27
        and ASBRs, ABRs such that routes for 1.1.1.1:10:1.1.1.1 with the
        nexthops ASBR21 and ASBR22 are reflected to ABR23, ABR24 without any
        path hiding. Thus giving ABR23 visibiity of both available nexthops
        for Gold SLA.<a href="#section-19.3-12" class="pilcrow">¶</a></p>
<p id="section-19.3-13">ABR23 receives the route with nexthop 2.2.2.1, label B-L3 from
        RR27. The route target "transport-target:0:100" on this route acts as
        Mapping Community, and instructs ABR23 to strictly resolve the nexthop
        using transport class 100 routes only. ABR23 is unable to find a route
        for 2.2.2.1 with transport class 100. Thus it considers this route
        unusable and does not propagate it further. This prunes ASBR21 from
        Gold SLA tunneled path.<a href="#section-19.3-13" class="pilcrow">¶</a></p>
<p id="section-19.3-14">ABR23 also receives the route with nexthop 2.2.2.2, label B-L4 from
        RR27. The route target "transport-target:0:100" on this route acts as
        Mapping Community, and instructs ABR23 to strictly resolve the nexthop
        using transport class 100 routes only. ABR23 successfully resolves the
        nexthop to point to ABR23_to_ASBR22_gold tunnel. ABR23 readvertises
        this BGP CT route with nexthop self (loopback address 2.2.2.3) and a
        new label B-L5 to PE25. Swap route for B-L5 is installed by ABR23 to
        swap to label B-L4, and forward into ABR23_to_ASBR22_gold tunnel.<a href="#section-19.3-14" class="pilcrow">¶</a></p>
<p id="section-19.3-15">PE25 receives the BGP CT route for prefix 1.1.1.1:10:1.1.1.1 with
        label B-L5, nexthop 2.2.2.3 and transport-target:0:100 from RR26. And
        it similarly resolves the nexthop 2.2.2.3 over transport class 100,
        pushing labels associated with PE25_to_ABR23_gold tunnel.<a href="#section-19.3-15" class="pilcrow">¶</a></p>
<p id="section-19.3-16">In this manner, the Gold transport LSP "ASBR13_to_PE11_gold" in
        egress-domain is extended by BGP CT until the ingress-node PE25 in
        ingress domain, to create an end-to-end Gold SLA path. MPLS swap
        routes are installed at ASBR13, ASBR22 and ABR23, when propagating the
        PE11 BGP CT Gold transport class route 1.1.1.1:10:1.1.1.1 with nexthop
        self towards PE25.<a href="#section-19.3-16" class="pilcrow">¶</a></p>
<p id="section-19.3-17">The BGP CT LSP thus formed, originates in PE25, and terminates in
        ASBR13 (assuming PE11 advertised Implicit Null), traversing over the
        Gold underlay LSPs in each domain. ASBR13 uses UHP to stitch the BGP
        CT LSP into the "ASBR13_to_PE11_gold" LSP to traverse the last domain,
        thus satisfying Gold SLA end-to-end.<a href="#section-19.3-17" class="pilcrow">¶</a></p>
<p id="section-19.3-18">When PE25 receives service routes from RR26 with nexthop 1.1.1.1
        and mapping community Color:0:100, it resolves over this BGP CT route
        1.1.1.1:10:1.1.1.1. Thus pushing label B-L5, and pushing as top label
        the labels associated with PE25_to_ABR23_gold tunnel.<a href="#section-19.3-18" class="pilcrow">¶</a></p>
</section>
<section id="section-19.4">
        <h3 id="name-data-plane-view-2">
<a href="#section-19.4" class="section-number selfRef">19.4. </a><a href="#name-data-plane-view-2" class="section-name selfRef">Data plane view</a>
        </h3>
<section id="section-19.4.1">
          <h4 id="name-steady-state-2">
<a href="#section-19.4.1" class="section-number selfRef">19.4.1. </a><a href="#name-steady-state-2" class="section-name selfRef">Steady state</a>
          </h4>
<p id="section-19.4.1-1">This section describes how the data plane looks like in steady
          state.<a href="#section-19.4.1-1" class="pilcrow">¶</a></p>
<p id="section-19.4.1-2">CE41 transmits an IP packet with destination as 31.31.31.31. On
          receiving this packet PE25 performs a lookup in the IP FIB
          associated with the CE41 interface. This lookup yeids the service
          route that pushes the VPN service label V-L1, BGP CT label B-L5, and
          labels for PE25_to_ABR23_gold tunnel. Thus PE25 encapsulates the IP
          packet in MPLS packet with label V-L1(innermost), B-L5, and top
          label as PE25_to_ABR23_gold tunnel. This MPLS packet is thus
          transmitted to ABR23 using Gold SLA.<a href="#section-19.4.1-2" class="pilcrow">¶</a></p>
<p id="section-19.4.1-3">ABR23 decapsulates the packet received on PE25_to_ABR23_gold
          tunnel as required, and finds the MPLS packet with label B-L5. It
          performs lookup for label B-L5 in the global MPLS FIB. This yields
          the route that swaps label B-L5 with label B-L4, and pushes top
          label provided by ABR23_to_ASBR22_gold tunnel. Thus ABR23 transmits
          the MPLS packet with label B-L4 to ASBR22, on a tunnel that
          satisfies Gold SLA.<a href="#section-19.4.1-3" class="pilcrow">¶</a></p>
<p id="section-19.4.1-4">ASBR22 similarly performs a lookup for label B-L4 in global MPLS
          FIB, finds the route that swaps label B-L4 with label B-L2, and
          forwards to ASBR13 over the directly connected MPLS enabled
          interface. This interface is a common resource not dedicated to any
          specific transport class, in this example.<a href="#section-19.4.1-4" class="pilcrow">¶</a></p>
<p id="section-19.4.1-5">ASBR13 receives the MPLS packet with label B-L2, and performs a
          lookup in MPLS FIB, finds the route that pops label B-L2, and pushes
          labels associated with ASBR13_to_PE11_gold tunnel. This transmits
          the MPLS packet with VPN label V-L1 to PE11 using a tunnel that
          preserves Gold SLA in AS 1.<a href="#section-19.4.1-5" class="pilcrow">¶</a></p>
<p id="section-19.4.1-6">PE11 receives the MPLS packet with V-L1, and performs VPN
          forwarding. Thus transmitting the original IP payload from CE41 to
          CE31. The payload has traversed path satisfying Gold SLA
          end-to-end.<a href="#section-19.4.1-6" class="pilcrow">¶</a></p>
</section>
<section id="section-19.4.2">
          <h4 id="name-local-repair-of-primary-path">
<a href="#section-19.4.2" class="section-number selfRef">19.4.2. </a><a href="#name-local-repair-of-primary-path" class="section-name selfRef">Local repair of primary path</a>
          </h4>
<p id="section-19.4.2-1">This section describes how the data plane at ASBR22 reacts when
          link between ASBR22 and ASBR13 experiences a failure, and an
          alternate path exists.<a href="#section-19.4.2-1" class="pilcrow">¶</a></p>
<p id="section-19.4.2-2">Assuming ASBR22_to_ASBR13 link goes down, such that traffic with
          Gold SLA going to PE11 needs repair. ASBR22 has an alternate BGP CT
          route for 1.1.1.1:10:1.1.1.1 from ASBR14. This has been
          preprogrammed in forwarding by ASBR22 as FRR backup nexthop for
          label B-L4. This allows the Gold SLA traffic to be locally repaired
          at ASBR22 without the failure event propagated in the BGP CT
          network. In this case, ingress node PE25 will not know there was a
          failure, and traffic restoration will be independent of prefix scale
          (PIC).<a href="#section-19.4.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-19.4.3">
          <h4 id="name-absorbing-failure-of-primary">
<a href="#section-19.4.3" class="section-number selfRef">19.4.3. </a><a href="#name-absorbing-failure-of-primary" class="section-name selfRef">Absorbing failure of primary path. Fallback to best-effort tunnels.</a>
          </h4>
<p id="section-19.4.3-1">This section describes how the data plane reacts when gold path
          experiences a failure, but no alternate path exists.<a href="#section-19.4.3-1" class="pilcrow">¶</a></p>
<p id="section-19.4.3-2">Assuming tunnel ABR23_to_ASBR22_gold goes down, such that now
          end-to-end Gold path does not exist in the network. This makes the
          BGP CT route for RD prefix 1.1.1.1:10:1.1.1.1 unusable at ABR23.
          This makes ABR23 send a BGP withdrawal for 1.1.1.1:10:1.1.1.1 to
          PE25.<a href="#section-19.4.3-2" class="pilcrow">¶</a></p>
<p id="section-19.4.3-3">Withdrawal for 1.1.1.1:10:1.1.1.1 allows PE25 to react to the
          loss of gold path to 1.1.1.1. Assuming PE25 is provisioned to use
          best-effort transport class as the backup path, this withdrawal of
          BGP CT route allows PE25 to adjust the nexthop of the VPN
          Service-route to push the labels provided by the BGP LU route. That
          repairs the traffic to go via best effort path. PE25 can also be
          provisioned to use Bronze transport class as the backup path. The
          repair will happen in similar manner in that case as-well.<a href="#section-19.4.3-3" class="pilcrow">¶</a></p>
<p id="section-19.4.3-4">Traffic repair to absorb the failure happens at ingress node
          PE25, in a service prefix scale independent manner. This is called
          PIC (Prefix scale Independent Convergence). The repair time will be
          proportional to time taken for withdrawing the BGP CT route.<a href="#section-19.4.3-4" class="pilcrow">¶</a></p>
<p id="section-19.4.3-5">The above examples demostrate the various levels of failsafe
          mechanisms available to protect traffic in a BGP CT network.<a href="#section-19.4.3-5" class="pilcrow">¶</a></p>
</section>
</section>
</section>
</div>
<section id="section-20">
      <h2 id="name-deployment-considerations-2">
<a href="#section-20" class="section-number selfRef">20. </a><a href="#name-deployment-considerations-2" class="section-name selfRef">Deployment considerations.</a>
      </h2>
<div id="CTRouteVis">
<section id="section-20.1">
        <h3 id="name-managing-transport-route-vis">
<a href="#section-20.1" class="section-number selfRef">20.1. </a><a href="#name-managing-transport-route-vis" class="section-name selfRef">Managing Transport Route Visibility</a>
        </h3>
<p id="section-20.1-1">This section details the usage of BGP-CT RD and label allocation
        modes to calibrate the level of path visibility and the amount of
        route churn in a multi-domain network.<a href="#section-20.1-1" class="pilcrow">¶</a></p>
<p id="section-20.1-2">Consider a multi-domain BGP-CT network as illustrated in the figure
        below.<a href="#section-20.1-2" class="pilcrow">¶</a></p>
<span id="name-multi-domain-network-2"></span><div id="MultiDomainNetwork">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-20.1-3.1">
<pre>
       |-----AS3-----|  |-------AS1------|

                +--------ASBR11     +--PE11 (EP1)
                |              \   /
         +----ASBR31            (P)----PE12 (EP2)
         |      |              / | \
         |      +--------ASBR12  |  +--PE13 (EP3)
         |                       |
         |                       +-----PE14 (EP4)
  PE31--(P)
         |
         |
         |      +--------ASBR21     +--PE21 (EP5)
         |      |              \   /
         +----ASBR32            (P)----PE22 (EP6)
                |              / | \
                +--------ASBR22  |  +--PE22 (EP7)
                                 |
                                 +-----PE24 (EP8)

       |-----AS3-----|  |-------AS2------|
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-multi-domain-network-2" class="selfRef">Multi-Domain Network</a>
          </figcaption></figure>
</div>
<p id="section-20.1-4">The following table details the BGP-CT route and path visibility at
        PE31-- for each TC.<a href="#section-20.1-4" class="pilcrow">¶</a></p>
<span id="name-route-and-path-visibility-at"></span><div id="RDLabelVis">
<figure id="figure-6">
          <div class="alignLeft art-text artwork" id="section-20.1-5.1">
<pre>
      +--------+------+-------+-------+---------+---------+
      |EP-type |Origin|RD-Mode|PP-Mode|CT Routes|CT Labels|
      +--------+------+-------+-------+---------+---------+
      |Unicast |SN    |Unique |TC,EP  |    16   |    8    |
      |Unicast |SN    |Unique |RD,EP  |    16   |   16    |
      |Unicast |BN    |Unique |TC,EP  |    16   |    8    |
      |Unicast |BN    |Unique |RD,EP  |    16   |   16    |
      |--------|------|-------|-------|---------|---------|
      |Anycast |SN    |Unique |TC,EP  |    16   |    2    |
      |Anycast |SN    |Unique |RD,EP  |    16   |   16    |
      |Anycast |SN    |Same   |TC,EP  |     2   |    2    |
      |Anycast |SN    |Same   |RD,EP  |     2   |    2    |
      |Anycast |BN    |Unique |TC,EP  |     4   |    2    |
      |Anycast |BN    |Unique |RD,EP  |     4   |    4    |
      |Anycast |BN    |Same   |TC,EP  |     2   |    2    |
      |Anycast |BN    |Same   |RD,IP  |     2   |    2    |
      +--------+------+-------+-------+---------+---------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-route-and-path-visibility-at" class="selfRef">Route and Path Visibility at Ingress Node</a>
          </figcaption></figure>
</div>
<p id="section-20.1-6">In the above example, both route churn and TE granularity are
        directly proportional to the number of CT labels received.<a href="#section-20.1-6" class="pilcrow">¶</a></p>
<p id="section-20.1-7">Above table demonstrates that BGP CT allows an operator to control
        how much path visibility and forwarding diversity is desired in the
        network, for Unicast and Anycast endpoints.<a href="#section-20.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-20.2">
        <h3 id="name-managing-intent-at-service-a">
<a href="#section-20.2" class="section-number selfRef">20.2. </a><a href="#name-managing-intent-at-service-a" class="section-name selfRef">Managing Intent at Service and Transport layers.</a>
        </h3>
<p id="section-20.2-1"><span><a href="#CTProc" class="xref">Illustration of BGP CT Procedures</a> (<a href="#CTProc" class="xref">Section 19</a>)</span>
        shows multiple domains that agree on a color name space (Agreeing
        Color Domains) and contain tunnels with equivalent set of colors
        (Homogenous Color Domains).<a href="#section-20.2-1" class="pilcrow">¶</a></p>
<p id="section-20.2-2">However in the real world, this may not always be gauranteed. Two
        domains may independently manage their color namespaces, these are
        known as Non-Agreeing Color Domains. Two domains may have tunnels with
        unequal set of colors, these are known as Heterogenous Color
        Domains.<a href="#section-20.2-2" class="pilcrow">¶</a></p>
<p id="section-20.2-3">This section describes how BGP CT is deployed in such scenarios to
        preserve end to end Intent. Example described in this section use
        Inter AS option C domains. But similar mechanisms will work for Inter
        AS option A and Inter AS option B scenarios as-well.<a href="#section-20.2-3" class="pilcrow">¶</a></p>
<section id="section-20.2.1">
          <h4 id="name-service-layer-color-manageme">
<a href="#section-20.2.1" class="section-number selfRef">20.2.1. </a><a href="#name-service-layer-color-manageme" class="section-name selfRef">Service layer Color Management</a>
          </h4>
<p id="section-20.2.1-1">At the service layer, it is recommended that a global color
          namespace be maintained across multiple co-operating domains. BGP CT
          allows indirection using resolution schemes to be able to maintain a
          global namespace in the service layer. This is possible even if each
          domain independantly maintains its own local transport color
          namespace.<a href="#section-20.2.1-1" class="pilcrow">¶</a></p>
<p id="section-20.2.1-2">As explained in <span><a href="#Nexthop_Resoln_Schm" class="xref">Nexthop
          Resolution Scheme</a> (<a href="#Nexthop_Resoln_Schm" class="xref">Section 6</a>)</span> , mapping community carried on service
          route maps to a resolution scheme. The mapping community values for
          the service route can be abstract and does not require to match the
          transport color namespace. This abstract mapping commnunity value
          representing a global service layer intent is mapped to an local
          transport layer intent available in each domain.<a href="#section-20.2.1-2" class="pilcrow">¶</a></p>
<p id="section-20.2.1-3">In this manner, it is recommended to keep color namespace
          management at service layer and the transport layer decoupled from
          each other. In the following sections the service layer agrees on a
          single global namespace.<a href="#section-20.2.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-20.2.2">
          <h4 id="name-non-agreeing-color-domains-2">
<a href="#section-20.2.2" class="section-number selfRef">20.2.2. </a><a href="#name-non-agreeing-color-domains-2" class="section-name selfRef">Non-Agreeing Color Domains</a>
          </h4>
<p id="section-20.2.2-1">Non-agreeing color domains require a mapping community rewrite on
          each domain boundry. This rewrite helps to map one domain's
          namespace to another.<a href="#section-20.2.2-1" class="pilcrow">¶</a></p>
<p id="section-20.2.2-2">The below example illustrates how traffic is stitched and SLA is
          preserved when domains don't use the same namespace at the transport
          layer. Each domain specifies the same SLA using different color
          values.<a href="#section-20.2.2-2" class="pilcrow">¶</a></p>
<span id="name-transport-layer-with-non-agr"></span><div id="BGPCT_NON_AGREEING_COLOR_DOMAIN">
<figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-20.2.2-3.1">
<pre>

          Gold(100)              Gold(300)               Gold(500)


     [PE11]----[ASBR11]---[ASBR21------[ASBR22]---[ASBR31-------[PE31]
            AS1                     AS2                    AS3


          Bronze(200)          Bronze(400)             Bronze(600)

            ----------- Packet Forwarding Direction --------&gt;
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-transport-layer-with-non-agr" class="selfRef">Transport Layer with Non-agreeing Color Domains</a>
            </figcaption></figure>
</div>
<p id="section-20.2.2-4">In the above topology we have three Autonomous Systems. All the
          nodes in the topology supports BGP CT.<a href="#section-20.2.2-4" class="pilcrow">¶</a></p>
<p id="section-20.2.2-5">In AS1 Gold SLA is represented by color 100 and Bronze by
          200.<a href="#section-20.2.2-5" class="pilcrow">¶</a></p>
<p id="section-20.2.2-6">In AS2 Gold SLA is represented by color 300 and Bronze by
          400.<a href="#section-20.2.2-6" class="pilcrow">¶</a></p>
<p id="section-20.2.2-7">In AS3 Gold SLA is represented by color 500 and Bronze by
          600.<a href="#section-20.2.2-7" class="pilcrow">¶</a></p>
<p id="section-20.2.2-8">Though the color values are different, they map to tunnels with
          same TE characteristics in each domain.<a href="#section-20.2.2-8" class="pilcrow">¶</a></p>
<p id="section-20.2.2-9">The service route carries an abstract mapping community that maps
          to the required SLA. For example, Service routes that need to
          resolve over gold transport tunnels, carries a mapping community
          color:0:100500. In AS3 it maps to a resolution scheme containing
          TRDB with color 500 whereas in AS2 it maps a to TRDB with color 300
          and in AS1 it maps to a TRDB with color 100. Co-ordination is needed
          to provision the resolution schemes in each domain as explained
          above.<a href="#section-20.2.2-9" class="pilcrow">¶</a></p>
<p id="section-20.2.2-10">At the AS boundary the transport-class route-target is rewritten
          for the BGP CT routes. In the above topology, At ASBR31 the
          transport-target:0:500 for gold tunnels is rewritten to
          transport-target:0:300 and then advertised to ASBR22. Similarly the
          transport-target:0:300 for gold tunnels are re-written to
          transport-target:0:100 at ASBR21 before advertising to ASBR11. At
          PE11, the transport route received with transport-target:0:100 will
          be added to the color 100 TRDB. The service route received with
          mapping community color:0:100500 at PE1 maps to the gold TRDB and
          resolves over this transport route.<a href="#section-20.2.2-10" class="pilcrow">¶</a></p>
<p id="section-20.2.2-11">Inter-domain traffic forwarding in the above topology works as
          explained in <a href="#CTProc" class="xref">Section 19</a>.<a href="#section-20.2.2-11" class="pilcrow">¶</a></p>
<p id="section-20.2.2-12">Transport-target re-write requires co-ordination of color values
          between domains in the transport layer. This method avoids the need
          to re-write service route mapping community, keeping the service
          layer homogenous and simple to manage. Co-ordinating transport-class
          route-target between adjacent domains is easier than co-ordinating
          service layer colors deployed in various non-adjacent domains.<a href="#section-20.2.2-12" class="pilcrow">¶</a></p>
</section>
<section id="section-20.2.3">
          <h4 id="name-heterogeneous-agreeing-color">
<a href="#section-20.2.3" class="section-number selfRef">20.2.3. </a><a href="#name-heterogeneous-agreeing-color" class="section-name selfRef">Heterogeneous Agreeing Color Domains</a>
          </h4>
<p id="section-20.2.3-1">In a heterogenous domains scenario, it might not be possible to
          map a service layer intent to the matching transport color as the
          color might not be locally available in a domain.<a href="#section-20.2.3-1" class="pilcrow">¶</a></p>
<p id="section-20.2.3-2">In this model, resolution schemes are customized to map the
          received mapping community (eg: transport-target or color community)
          to locally available TRDBs that are acceptable to realize the
          desired intent.<a href="#section-20.2.3-2" class="pilcrow">¶</a></p>
<p id="section-20.2.3-3">The below example illustrates how traffic is stitched, when a
          transit AS contains more shades for an SLA paths compared to Ingress
          and Egress domains. This example shows how service routes can
          traverse through finer shades when available and take coarse shades
          otherwise.<a href="#section-20.2.3-3" class="pilcrow">¶</a></p>
<span id="name-tranport-layer-with-heteroge"></span><div id="BGPCT_HETERGENOUS_COLOR_DOMAIN">
<figure id="figure-8">
            <div class="alignLeft art-text artwork" id="section-20.2.3-4.1">
<pre>
           &lt;---------- Service Routes SAFI-128 ------------------------

                                     Gold1(101)
                                     Gold2(102)
          Gold(100)                                             Gold(100)

    [PE11]------[ASBR11]----[ASBR21--------[ASBR22]----[ASBR31--------[PE31]
       AS1-Metro-Ingress            AS2-Core              AS3-Metro-Egress


                ----------- Packet Forwarding Direction --------&gt;
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-tranport-layer-with-heteroge" class="selfRef">Tranport Layer with Heterogenous Color Domains</a>
            </figcaption></figure>
</div>
<p id="section-20.2.3-5">In the above topology we have three Autonomous Systems. All the
          nodes in the topology support BGP CT.<a href="#section-20.2.3-5" class="pilcrow">¶</a></p>
<p id="section-20.2.3-6">In AS1 Gold SLA is represented by color 100.<a href="#section-20.2.3-6" class="pilcrow">¶</a></p>
<p id="section-20.2.3-7">In AS2 Gold has finer shades: Gold1 by color 101 and Gold2 by
          color 102.<a href="#section-20.2.3-7" class="pilcrow">¶</a></p>
<p id="section-20.2.3-8">In AS3 Gold SLA is represented by color 100.<a href="#section-20.2.3-8" class="pilcrow">¶</a></p>
<p id="section-20.2.3-9">Service routes advertised by PE31 that need to resolve over Gold1
          transport tunnels carry a mapping community color:0:101. In AS3 and
          AS1 where Gold1 is not available, it is mapped to color 100 TRDB
          using a customized resolution scheme. In AS2, Gold1 is available and
          it maps to color 101 TRDB.<a href="#section-20.2.3-9" class="pilcrow">¶</a></p>
<p id="section-20.2.3-10">To facilitate this mapping every SN/BN in all AS provision
          required transport classes viz. 100, 101 and 102. SN and BN in AS1
          and AS3 are provisioned with customized resolution schemes that
          resolve routes with transport-target:0:101 or transport-target:0:102
          strictly over color 100 TRDB.<a href="#section-20.2.3-10" class="pilcrow">¶</a></p>
<p id="section-20.2.3-11">PE31 is provisioned to originate BGP CT route with color 101 for
          endpoint PE31. This route is sent with NLRI RD prefix RD1:PE31 and
          route target extended community transport-target:0:101.<a href="#section-20.2.3-11" class="pilcrow">¶</a></p>
<p id="section-20.2.3-12">At ASBR31, the route target "transport-target:0:101" on this BGP
          CT route instructs to add the route to color 101 TRDB. ASBR31 is
          provisioned with customized resolution scheme that resolves the
          routes carrying mapping community transport-target:0:101 to resolve
          using color 100 TRDB. This route is then re-advertised from color
          101 TRDB to ASBR22 with route-target:0:101.<a href="#section-20.2.3-12" class="pilcrow">¶</a></p>
<p id="section-20.2.3-13">At ASBR22, the BGP CT routes received with transport-target:0:101
          will be added to color 101 TRDB and strictly resolve over tunnel
          routes in the same TRDB. This route is re-advertised to ASBR21 with
          transport-target:0:101.<a href="#section-20.2.3-13" class="pilcrow">¶</a></p>
<p id="section-20.2.3-14">Similarily at ASBR21, the BGP CT routes received with
          transport-target:0:101 will be added to color 101 TRDB and strictly
          resolve over tunnel routes in the same TRDB. This route is
          re-advertised to ASBR11 with transport-target:0:101.<a href="#section-20.2.3-14" class="pilcrow">¶</a></p>
<p id="section-20.2.3-15">At ASBR11, the route target "transport-target:0:101" on this BGP
          CT route instructs to add the route to color 101 TRDB. ASBR11 is
          provisioned with a customized resolution scheme that resolves the
          routes carrying transport-target:0:101 to use color 100 TRDB. This
          route is then re-advertised from color 101 TRDB to PE11 with
          route-target:0:101.<a href="#section-20.2.3-15" class="pilcrow">¶</a></p>
<p id="section-20.2.3-16">At PE11, the route target "transport-target:0:101" on this BGP CT
          route instructs to add the route to color 101 TRDB. PE11 is
          provisioned with a customized resolution scheme that resolves the
          routes carrying transport-target:0:101 to use color 100 TRDB.<a href="#section-20.2.3-16" class="pilcrow">¶</a></p>
<p id="section-20.2.3-17">When PE11 receives the service route with the mapping community
          color:0:101 it directly resolves over the BGP CT route in color 101
          TRDB, which inturn resolves over tunnel routes in color 100
          TRDB.<a href="#section-20.2.3-17" class="pilcrow">¶</a></p>
<p id="section-20.2.3-18">In this manner, PE11 can put traffic on tunnels with color 101,
          color 102 in the core domain, and color 100 in the metro
          domains.<a href="#section-20.2.3-18" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-20.3">
        <h3 id="name-migration-scenarios-2">
<a href="#section-20.3" class="section-number selfRef">20.3. </a><a href="#name-migration-scenarios-2" class="section-name selfRef">Migration scenarios.</a>
        </h3>
<section id="section-20.3.1">
          <h4 id="name-bgp-ct-islands-connected-via">
<a href="#section-20.3.1" class="section-number selfRef">20.3.1. </a><a href="#name-bgp-ct-islands-connected-via" class="section-name selfRef">BGP CT islands connected via BGP LU domain.</a>
          </h4>
<p id="section-20.3.1-1">This section explains how end-to-end SLA can be achieved while
          transiting a domain that does not support BGP-CT. BGP-LU is used in
          such domains to connect the BGP CT islands.<a href="#section-20.3.1-1" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-in-as1-and-as3-connec"></span><div id="BGPCTIsles">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="section-20.3.1-2.1">
<pre>
              +----------------EBGP-MHOP-CT-----------+
              |                                       |
        AS3   |                   AS2                 |   AS1
  [PE31-----ASBR31]--------[ASBR22---ASBR21]-------[ASBR11---PE11]

                 &lt;-EBGP-LU-&gt;              &lt;-EBGP-LU-&gt;
   &lt;---IBGP-CT---&gt;          &lt;---IBGP-LU---&gt;        &lt;---IBGP-CT---&gt;

            ---------Packet Forwarding Direction---------&gt;


</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-bgp-ct-in-as1-and-as3-connec" class="selfRef">BGP CT in AS1 and AS3 connected by BGP LU in AS2</a>
            </figcaption></figure>
</div>
<p id="section-20.3.1-3">In the above topology there are three ASs. AS1 and AS3 supports
          BGP-CT. AS2 is a domain that does not support BGP CT.<a href="#section-20.3.1-3" class="pilcrow">¶</a></p>
<p id="section-20.3.1-4">Nodes in AS1,AS2 and AS3 negotiate IBGP-LU within the domain.
          Nodes in AS1 and AS3 negotiate IBGP CT within the domain. ASBR11 and
          ASBR21 as well as ASBR22 and ASBR31 negotiate EBGP-LU over directly
          connected interdomain links. ASBR11 and ASBR31 have reachability to
          each other's loopbacks through BGP-LU. ASBR11 and ASBR31
          negotiate BGP-CT over a multihop EBGP session formed using BGP-LU
          reachability.<a href="#section-20.3.1-4" class="pilcrow">¶</a></p>
<p id="section-20.3.1-5">The following tunnels exist for Gold transport class<a href="#section-20.3.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-20.3.1-6.1">PE11_to_ASBR11_gold - RSVP-TE tunnel<a href="#section-20.3.1-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-20.3.1-6.2">ASBR11_to_PE11_gold - RSVP-TE tunnel<a href="#section-20.3.1-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-20.3.1-6.3">PE31_to_ASBR31_gold - SRTE tunnel<a href="#section-20.3.1-6.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-20.3.1-6.4">ASBR31_to_PE31_gold - SRTE tunnel<a href="#section-20.3.1-6.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-20.3.1-7">Following tunnels exist for Bronze transport class<a href="#section-20.3.1-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-20.3.1-8.1">PE11_to_ASBR11_bronze - RSVP-TE tunnel<a href="#section-20.3.1-8.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-20.3.1-8.2">ASBR11_to_PE11_bronze - RSVP-TE tunnel<a href="#section-20.3.1-8.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-20.3.1-8.3">PE31_to_ASBR31_bronze - SRTE tunnel<a href="#section-20.3.1-8.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-20.3.1-8.4">ASBR31_to_PE31_bronze - SRTE tunnel<a href="#section-20.3.1-8.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-20.3.1-9">These tunnels are provisioned to belong to transport class gold
          and bronze, and are advertised between ASBR31 and ASBR11 with
          Nexthop self.<a href="#section-20.3.1-9" class="pilcrow">¶</a></p>
<p id="section-20.3.1-10">Further in AS2 the following tunnels exist to satisfy the
          different SLAs, using per SLA endpoint:<a href="#section-20.3.1-10" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-20.3.1-11.1">ASBR21_to_ASBR22_lpbk_gold - RSVP-TE tunnel<a href="#section-20.3.1-11.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-20.3.1-11.2">ASBR22_to_ASBR21_lpbk_gold - RSVP-TE tunnel<a href="#section-20.3.1-11.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-20.3.1-11.3">ASBR21_to_ASBR22_lpbk_bronze - RSVP-TE tunnel<a href="#section-20.3.1-11.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-20.3.1-11.4">ASBR22_to_ASBR21_lpbk_bronze - RSVP-TE tunnel<a href="#section-20.3.1-11.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-20.3.1-12">RD:PE11 BGP CT route is originated from PE11 towards ASBR11 with
          transport-target gold. ASBR11 readvertises this route with Nexthop
          as SLA endpoint ASBR11_lpbk_gold on the EBGP CT MHOP session towards
          ASBR31. ASBR11 originates ASBR11_lpbk_gold in EBGP LU towards ABR21
          with gold SLA community. Similarily for ASBR11 originates per SLA
          loopback routes for each SLA it supports attaching the community for
          that SLA. This SLA community is used by ASBR31 to leak the LU routes
          into their respective CT TRDBs.<a href="#section-20.3.1-12" class="pilcrow">¶</a></p>
<p id="section-20.3.1-13">ASBR21 readvertises the ASBR11_lpbk_gold BGP-LU route to ASBR22
          with the nexthop as a unique loopback (ASBR21_lpbk_gold)
          representing gold SLA. ASBR22 on receiving these endpoints resolve
          them over the appropriate SLA transport tunnels by virtue of per SLA
          tunnel endpoint provisioned in AS2. ASBR22, on succesful resolution,
          readvertises this BGP-LU routes to ASBR31 with nexthop self and a
          new label.<a href="#section-20.3.1-13" class="pilcrow">¶</a></p>
<p id="section-20.3.1-14">ASBR31 imports ASBR11_lpbk_gold route received via EBGP-LU from
          ASBR22 to gold TRDB based on the received SLA community. ASBR31 uses
          this gold TRDB route to resolve the NH ASBR11_lpbk_gold of RD:PE11
          route received over the MHOP EBGP-MHOP-CT session with
          transport-target gold, thus preserving the end-to-end SLA. Now
          ASBR31 readvertises RD:PE11 route with nexthop as self thus
          stitching with the BGP-LU LSP. Intradomain traffic forwarding in AS1
          and AS3 follows the procedures as explained in <span><a href="#CTProc" class="xref">Illustration of CT Procedures</a> (<a href="#CTProc" class="xref">Section 19</a>)</span><a href="#section-20.3.1-14" class="pilcrow">¶</a></p>
<p id="section-20.3.1-15">In cases where an SLA cannot be preserved in AS2, it can be
          carried over available SLAs (ex: best-effort SLA) by rewriting the
          nexthop to ASBR21 loopback assigned to that endpoint. This eases
          migration in case of heterogenous color domains.<a href="#section-20.3.1-15" class="pilcrow">¶</a></p>
</section>
<section id="section-20.3.2">
          <h4 id="name-bgp-ct-interop-between-mpls-an">
<a href="#section-20.3.2" class="section-number selfRef">20.3.2. </a><a href="#name-bgp-ct-interop-between-mpls-an" class="section-name selfRef">BGP CT - Interop between MPLS and other forwarding technologies.</a>
          </h4>
<p id="section-20.3.2-1">This section describes how nodes supporting dissimilar
          encapsulation technologies can interoperate with each other when
          using BGP CT family.<a href="#section-20.3.2-1" class="pilcrow">¶</a></p>
<section id="section-20.3.2.1">
            <h5 id="name-interop-between-mpls-and-srv">
<a href="#section-20.3.2.1" class="section-number selfRef">20.3.2.1. </a><a href="#name-interop-between-mpls-and-srv" class="section-name selfRef">Interop between MPLS and SRv6 nodes.</a>
            </h5>
<p id="section-20.3.2.1-1">BGP speakers may carry MPLS label and SRv6 SID in BGP CT SAFI
            76 routes using protocol encoding as described in <span><a href="#CTMultiEncap" class="xref">Carrying Multiple Encapsulation
            information</a> (<a href="#CTMultiEncap" class="xref">Section 7.1</a>)</span><a href="#section-20.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-20.3.2.1-2">MPLS Labels are carried using RFC 8277 encoding, and SRv6 SID
            is carried using Prefix SID attribute as specified in RFC 9252<a href="#section-20.3.2.1-2" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-interop-between-mpls-and"></span><div id="BGPCT_MPLS_SRV6">
<figure id="figure-10">
              <div class="alignLeft art-text artwork" id="section-20.3.2.1-3.1">
<pre>

                      RR1--+
                             \  +-------R2  [MPLS + SRv6]
                              \ |
                      R1--------P-------R3  [MPLS only]
                [MPLS + SRv6]   |
                                +-------R4  [SRv6 only]

                  &lt;---- Bidirectional Traffic ----&gt;
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-bgp-ct-interop-between-mpls-and" class="selfRef">BGP CT Interop between MPLS and SRv6 nodes</a>
              </figcaption></figure>
</div>
<p id="section-20.3.2.1-4">This example shows a provider network with a mix of devices
            with different forwarding capabilities. R1 and R2 support
            forwarding both MPLS and SRv6 packets. R3 supports forwarding MPLS
            packets only. R4 supports forwarding SRv6 packets only. All these
            nodes have BGP session with Route Reflector RR1 which reflects
            routes between these nodes with nexthop unchanged. BGP CT family
            is negotiated on these sessions.<a href="#section-20.3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-20.3.2.1-5">R1 and R2 send and receive both MPLS label and SRv6 SID in the
            BGP CT control plane routes. This allows them to be ingress and
            egress for both MPLS and SRv6 data planes. MPLS Label is carried
            using RFC 8277 encoding, and SRv6 SID is carried using Prefix SID
            attribute as specified in RFC 9252, without Transposition Scheme.
            The Transposition Length is set to 0 and Transposition Offset is
            set to 0 to indicate nothing is transposed and that the entire
            SRv6 SID value is encoded in the SID Information Sub-TLV. In this
            way, either MPLS or SRv6 forwarding can be used between R1 and
            R2.<a href="#section-20.3.2.1-5" class="pilcrow">¶</a></p>
<p id="section-20.3.2.1-6">R1 and R3 send and receive MPLS label in the BGP CT control
            plane routes using RFC 8277 encoding. This allows them to be
            ingress and egress for MPLS data plane. R1 will carry SRv6 SID in
            Prefix-SID attribute, which will not be used by R3. In order to
            interoperate with MPLS only device R3, R1 MUST NOT use SRv6
            Transposition scheme described in RFC 9252 that overloads the RFC
            8277 MPLS-Label field with SRv6 Transposition information. MPLS
            forwarding will be used between R1 and R3.<a href="#section-20.3.2.1-6" class="pilcrow">¶</a></p>
<p id="section-20.3.2.1-7">R1 and R4 send and receive SRv6 SID in the BGP CT control plane
            routes using BGP Prefix-SID attribute, without Transposition
            Scheme. This allows them to be ingress and egress for SRv6 data
            plane. R4 will carry the special MPLS Label with value 3
            (Implicit-NULL) in RFC 8277 encoding, which tells R1 not to push
            any MPLS label towards R4. The MPLS Label advertised by R1 in RFC
            8277 NLRI will not be used by R4. SRv6 forwarding will be used
            between R1 and R4.<a href="#section-20.3.2.1-7" class="pilcrow">¶</a></p>
<p id="section-20.3.2.1-8">Note in this example that R3 and R4 cannot communicate directly
            with each other, because they dont support a common forwarding
            technology. The BGP CT routes received at R3, R4 from each other
            will remain unusable, due to incompatible forwarding
            technology.<a href="#section-20.3.2.1-8" class="pilcrow">¶</a></p>
</section>
<section id="section-20.3.2.2">
            <h5 id="name-interop-between-nodes-suppor">
<a href="#section-20.3.2.2" class="section-number selfRef">20.3.2.2. </a><a href="#name-interop-between-nodes-suppor" class="section-name selfRef">Interop between nodes supporting MPLS and UDP tunneling.</a>
            </h5>
<p id="section-20.3.2.2-1">This section describes how nodes supporting MPLS forwarding can
            interoperate with other nodes supporting UDP (or IP) tunneling,
            when using BGP CT family.<a href="#section-20.3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-20.3.2.2-2">MPLS Labels are carried using RFC 8277 encoding, and UDP (or
            IP) tunneling information is carried using TEA attribute as
            specified in RFC 9012<a href="#section-20.3.2.2-2" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-interop-between-mpls-and-"></span><div id="BGPCT_MPLS_UDP">
<figure id="figure-11">
              <div class="alignLeft art-text artwork" id="section-20.3.2.2-3.1">
<pre>

                      RR1--+
                             \  +-------R2  [MPLS + UDP]
                              \ |
                      R1--------P-------R3  [MPLS only]
                [MPLS + UDP]    |
                                +-------R4  [UDP only]

                  &lt;---- Bidirectional Traffic ----&gt;
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-bgp-ct-interop-between-mpls-and-" class="selfRef">BGP CT Interop between MPLS and UDP tunneling nodes.</a>
              </figcaption></figure>
</div>
<p id="section-20.3.2.2-4">In this example, R1 and R2 support forwarding both MPLS and UDP
            tunneled packets. R3 supports forwarding MPLS packets only. R4
            supports forwarding UDP tunneled packets only. All these nodes
            have BGP session with Route Reflector RR1 which reflects routes
            between these nodes with nexthop unchanged. BGP CT family is
            negotiated on these sessions.<a href="#section-20.3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-20.3.2.2-5">R1 and R2 send and receive both MPLS label and UDP tunneling
            info in the BGP CT control plane routes. This allows them to be
            ingress and egress for both MPLS and UDP tunneling data planes.
            MPLS Label is carried using RFC 8277 encoding. UDP tunneling
            information is carried using TEA attribute as specified in RFC
            9012. Either MPLS or UDP tunneled forwarding can be used between
            R1 and R2.<a href="#section-20.3.2.2-5" class="pilcrow">¶</a></p>
<p id="section-20.3.2.2-6">R1 and R3 send and receive MPLS label in the BGP CT control
            plane routes using RFC 8277 encoding. This allows them to be
            ingress and egress for MPLS data plane. R1 will carry UDP
            tunneling info in TEA attribute, which will not be used by R3.
            MPLS forwarding will be used between R1 and R3.<a href="#section-20.3.2.2-6" class="pilcrow">¶</a></p>
<p id="section-20.3.2.2-7">R1 and R4 send and receive UDP tunneling info in the BGP CT
            control plane routes using BGP TEA attribute. This allows them to
            be ingress and egress for UDP tunneled data plane. R4 will carry
            special MPLS Label with value 3 (Implicit-NULL) in RFC 8277
            encoding, which tells R1 not to push any MPLS label towards R4.
            The MPLS Label advertised by R1 will not be used by R4. UDP
            tunneled forwarding will be used between R1 and R4.<a href="#section-20.3.2.2-7" class="pilcrow">¶</a></p>
<p id="section-20.3.2.2-8">Note in this example that R3 and R4 cannot communicate directly
            with each other, because they dont support a common forwarding
            technology. The BGP CT routes received at R3, R4 from each other
            will remain unusable, due to incompatible forwarding
            technology.<a href="#section-20.3.2.2-8" class="pilcrow">¶</a></p>
</section>
</section>
</section>
</section>
<div id="IANA">
<section id="section-21">
      <h2 id="name-iana-considerations-2">
<a href="#section-21" class="section-number selfRef">21. </a><a href="#name-iana-considerations-2" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-21-1">This document makes following requests of IANA.<a href="#section-21-1" class="pilcrow">¶</a></p>
<section id="section-21.1">
        <h3 id="name-new-bgp-safi-2">
<a href="#section-21.1" class="section-number selfRef">21.1. </a><a href="#name-new-bgp-safi-2" class="section-name selfRef">New BGP SAFI</a>
        </h3>
<p id="section-21.1-1">Please assign a new BGP SAFI code for "Classful Transport". Value
        76.<a href="#section-21.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-21.1-2">
<pre>
Registry Group: Subsequent Address Family Identifiers (SAFI) Parameters

Registry Name: SAFI Values

       Value              Description
      -------------+--------------------------
        76            Classful-Transport SAFI
</pre><a href="#section-21.1-2" class="pilcrow">¶</a>
</div>
<p id="section-21.1-3">This will be used to create new AFI,SAFI pairs for IPv4, IPv6
        Classful Transport families. viz:<a href="#section-21.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-21.1-4.1">"Inet, Classful Transport". AFI/SAFI = "1/76" for carrying IPv4
            Classful Transport prefixes.<a href="#section-21.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-21.1-4.2">"Inet6, Classful Transport". AFI/SAFI = "2/76" for carrying
            IPv6 Classful Transport prefixes.<a href="#section-21.1-4.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-21.2">
        <h3 id="name-new-format-for-bgp-extended-">
<a href="#section-21.2" class="section-number selfRef">21.2. </a><a href="#name-new-format-for-bgp-extended-" class="section-name selfRef">New Format for BGP Extended Community</a>
        </h3>
<p id="section-21.2-1">Please assign a new Format (Type high = 0xa) of extended community
        <span><a href="#RFC4360" class="xref">EXT-COMM</a> [<a href="#RFC4360" class="xref">RFC4360</a>]</span> called "Transport Class" from
        the following registries:<a href="#section-21.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-21.2-2.1">the "BGP Transitive Extended Community Types" registry, and<a href="#section-21.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-21.2-2.2">the "BGP Non-Transitive Extended Community Types" registry.<a href="#section-21.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-21.2-3">Please assign the same low-order six bits for both allocations.<a href="#section-21.2-3" class="pilcrow">¶</a></p>
<p id="section-21.2-4">This document uses this new Format with subtype 0x2 (route target),
        as a transitive extended community.<a href="#section-21.2-4" class="pilcrow">¶</a></p>
<p id="section-21.2-5">The Route Target thus formed is called "Transport Class" route
        target extended community.<a href="#section-21.2-5" class="pilcrow">¶</a></p>
<p id="section-21.2-6">Taking reference of <span><a href="#RFC7153" class="xref">RFC7153</a> [<a href="#RFC7153" class="xref">RFC7153</a>]</span> ,
        following requests are made:<a href="#section-21.2-6" class="pilcrow">¶</a></p>
<section id="section-21.2.1">
          <h4 id="name-existing-registries-to-be-mo">
<a href="#section-21.2.1" class="section-number selfRef">21.2.1. </a><a href="#name-existing-registries-to-be-mo" class="section-name selfRef">Existing registries to be modified</a>
          </h4>
<section id="section-21.2.1.1">
            <h5 id="name-registries-for-the-type-fiel">
<a href="#section-21.2.1.1" class="section-number selfRef">21.2.1.1. </a><a href="#name-registries-for-the-type-fiel" class="section-name selfRef">Registries for the "Type" Field</a>
            </h5>
<section id="section-21.2.1.1.1">
              <h6 id="name-transitive-types-2">
<a href="#section-21.2.1.1.1" class="section-number selfRef">21.2.1.1.1. </a><a href="#name-transitive-types-2" class="section-name selfRef">Transitive Types</a>
              </h6>
<p id="section-21.2.1.1.1-1">This registry contains values of the high-order octet (the
              "Type" field) of a Transitive Extended Community.<a href="#section-21.2.1.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-21.2.1.1.1-2">
<pre>Registry Group: Border Gateway Protocol (BGP) Extended Communities

Registry Name: BGP Transitive Extended Community Types

       Type Value        Name
      --------------+---------------
         0x0a          Transport Class

  (Sub-Types are defined in the
  "Transitive Transport Class Extended Community Sub-Types"
   registry)</pre><a href="#section-21.2.1.1.1-2" class="pilcrow">¶</a>
</div>
</section>
<section id="section-21.2.1.1.2">
              <h6 id="name-non-transitive-types-2">
<a href="#section-21.2.1.1.2" class="section-number selfRef">21.2.1.1.2. </a><a href="#name-non-transitive-types-2" class="section-name selfRef">Non-Transitive Types</a>
              </h6>
<p id="section-21.2.1.1.2-1">This registry contains values of the high-order octet (the
              "Type" field) of a Non-transitive Extended Community.<a href="#section-21.2.1.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-21.2.1.1.2-2">
<pre> Registry Group: Border Gateway Protocol (BGP) Extended Communities

 Registry Name: BGP Non-Transitive Extended Community Types

      Type Value         Name
     --------------+------------------
         0x4a         Transport Class

 (Sub-Types are defined in the
  "Non-Transitive Transport Class Extended Community Sub-Types"
   registry)
</pre><a href="#section-21.2.1.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</section>
</section>
<section id="section-21.2.2">
          <h4 id="name-new-registries-to-be-created">
<a href="#section-21.2.2" class="section-number selfRef">21.2.2. </a><a href="#name-new-registries-to-be-created" class="section-name selfRef">New registries to be created</a>
          </h4>
<section id="section-21.2.2.1">
            <h5 id="name-transitive-transport-class-e">
<a href="#section-21.2.2.1" class="section-number selfRef">21.2.2.1. </a><a href="#name-transitive-transport-class-e" class="section-name selfRef">Transitive Transport Class Extended Community Sub-Types Registry</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-21.2.2.1-1">
<pre> Registry Group: Border Gateway Protocol (BGP) Extended Communities

 Registry Name: Transitive Transport Class Extended Community Sub-Types

 Note:
    This registry contains values of the second octet (the
    "Sub-Type" field) of an extended community when the value of the
     first octet (the "Type" field) is 0x0a.

 Range                 Registration Procedures
 -----------------+----------------------------
 0x00-0xBF           First Come First Served
 0xC0-0xFF           IETF Review

 Sub-Type Value         Name
 -----------------+--------------
   0x02              Route Target
</pre><a href="#section-21.2.2.1-1" class="pilcrow">¶</a>
</div>
</section>
<section id="section-21.2.2.2">
            <h5 id="name-non-transitive-transport-cla">
<a href="#section-21.2.2.2" class="section-number selfRef">21.2.2.2. </a><a href="#name-non-transitive-transport-cla" class="section-name selfRef">Non-Transitive Transport Class Extended Community Sub-Types Registry</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-21.2.2.2-1">
<pre> Registry Group: Border Gateway Protocol (BGP) Extended Communities

 Registry Name: Non-Transitive Transport Class Extended Community Sub-Types

 Note:
    This registry contains values of the second octet (the
    "Sub-Type" field) of an extended community when the value of the
     first octet (the "Type" field) is 0x4a.

 Range                 Registration Procedures
 -----------------+----------------------------
 0x00-0xBF           First Come First Served
 0xC0-0xFF           IETF Review

 Sub-Type Value         Name
 -----------------+--------------
   0x02              Route Target

</pre><a href="#section-21.2.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</section>
</section>
<section id="section-21.3">
        <h3 id="name-mpls-oam-code-points-2">
<a href="#section-21.3" class="section-number selfRef">21.3. </a><a href="#name-mpls-oam-code-points-2" class="section-name selfRef">MPLS OAM code points</a>
        </h3>
<p id="section-21.3-1">The following two code points are sought for Target FEC Stack
        sub-TLVs:<a href="#section-21.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-21.3-2.1">IPv4 BGP Classful Transport<a href="#section-21.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-21.3-2.2">IPv6 BGP Classful Transport<a href="#section-21.3-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<div class="alignLeft art-text artwork" id="section-21.3-3">
<pre> Registry Group: Multiprotocol Label Switching (MPLS)
                 Label Switched Paths (LSPs) Ping Parameters

 Registry Name: Sub-TLVs for TLV Types 1, 16, and 21

  Sub-Type                Name
 -----------------+------------------------------
   31744              IPv4 BGP Classful Transport
   31745              IPv6 BGP Classful Transport

</pre><a href="#section-21.3-3" class="pilcrow">¶</a>
</div>
</section>
<section id="section-21.4">
        <h3 id="name-best-effort-transport-class-i">
<a href="#section-21.4" class="section-number selfRef">21.4. </a><a href="#name-best-effort-transport-class-i" class="section-name selfRef">Best Effort Transport Class ID</a>
        </h3>
<p id="section-21.4-1">This document reserves the Transport class ID value 0 to represent
        "Best Effort Transport Class ID". This is used in the 'Transport Class
        ID' field of Transport Route Target extended community that represents
        best effort transport class. Please create a new registry for
        this.<a href="#section-21.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-21.4-2">
<pre> Registry Group: BGP CT Parameters

 Registry Name: Transport Class ID

  Value                 Name
 -----------------+--------------------------------
   0                Best Effort Transport Class ID

</pre><a href="#section-21.4-2" class="pilcrow">¶</a>
</div>
</section>
</section>
</div>
<div id="Security">
<section id="section-22">
      <h2 id="name-security-considerations-2">
<a href="#section-22" class="section-number selfRef">22. </a><a href="#name-security-considerations-2" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-22-1">Mechanisms described in this document carry Transport routes in a new
      BGP address family. That minimizes possibility of these routes leaking
      outside the expected domain or mixing with service routes.<a href="#section-22-1" class="pilcrow">¶</a></p>
<p id="section-22-2">When redistributing between SAFI 4 and SAFI 76 Classful Transport
      routes, there is a possibility of SAFI 4 routes mixing with SAFI 1
      service routes. To avoid such scenarios, it is RECOMMENDED that
      implementations support keeping SAFI 4 routes in a separate transport
      RIB, distinct from service RIB that contain SAFI 1 service routes.<a href="#section-22-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-23">
      <h2 id="name-normative-references-2">
<a href="#section-23" class="section-number selfRef">23. </a><a href="#name-normative-references-2" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="BGP-CT-UPDATE-PACKING-TEST">[BGP-CT-UPDATE-PACKING-TEST]</dt>
      <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span>, <span class="refTitle">"BGP CT Update packing Test Results"</span>, <time datetime="2022-11-23" class="refDate">23 November 2022</time>, <span>&lt;<a href="https://raw.githubusercontent.com/ietf-wg-idr/draft-ietf-idr-bgp-ct/main/update-packing-test-results.txt">https://raw.githubusercontent.com/ietf-wg-idr/draft-ietf-idr-bgp-ct/main/update-packing-test-results.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BGP-LU-EPE">[BGP-LU-EPE]</dt>
      <dd>
<span class="refAuthor">Gredler, Ed.</span>, <span class="refTitle">"Egress Peer Engineering using BGP-LU"</span>, <time datetime="2021-07-06" class="refDate">6 July 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-gredler-idr-bgplu-epe-14">https://datatracker.ietf.org/doc/html/draft-gredler-idr-bgplu-epe-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FLOWSPEC-REDIR-IP">[FLOWSPEC-REDIR-IP]</dt>
      <dd>
<span class="refAuthor">Simpson, Ed.</span>, <span class="refTitle">"BGP Flow-Spec Redirect to IP Action"</span>, <time datetime="2015-02-02" class="refDate">2 February 2015</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-idr-flowspec-redirect-ip-02">https://datatracker.ietf.org/doc/html/draft-ietf-idr-flowspec-redirect-ip-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Intent-Routing">[Intent-Routing]</dt>
      <dd>
<span class="refAuthor">Hegde, Ed.</span>, <span class="refTitle">"Intent-aware Routing using Color"</span>, <time datetime="2022-07-14" class="refDate">14 July 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-hr-spring-intentaware-routing-using-color-00#section-6.3.2">https://datatracker.ietf.org/doc/html/draft-hr-spring-intentaware-routing-using-color-00#section-6.3.2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MPLS-NAMESPACES">[MPLS-NAMESPACES]</dt>
      <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span>, <span class="refTitle">"BGP signalled MPLS-namespaces"</span>, <time datetime="2021-06-11" class="refDate">11 June 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kaliraj-bess-bgp-sig-private-mpls-labels-05#section-6.1">https://datatracker.ietf.org/doc/html/draft-kaliraj-bess-bgp-sig-private-mpls-labels-05#section-6.1</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MULTI-NH-ATTR">[MULTI-NH-ATTR]</dt>
      <dd>
<span class="refAuthor">Vairavakkalai, Ed.</span>, <span class="refTitle">"BGP MultiNexthop Attribute"</span>, <time datetime="2021-12-28" class="refDate">28 December 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-kaliraj-idr-multinexthop-attribute-04#section-5.5.2.2">https://datatracker.ietf.org/doc/html/draft-kaliraj-idr-multinexthop-attribute-04#section-5.5.2.2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PCEP-RSVP-COLOR">[PCEP-RSVP-COLOR]</dt>
      <dd>
<span class="refAuthor">Rajagopalan, Ed.</span>, <span class="refTitle">"Path Computation Element Protocol(PCEP) Extension for RSVP Color"</span>, <time datetime="2021-01-15" class="refDate">15 January 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-rajagopalan-pcep-rsvp-color-00">https://datatracker.ietf.org/doc/html/draft-rajagopalan-pcep-rsvp-color-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2474">[RFC2474]</dt>
      <dd>
<span class="refAuthor">Nichols, K.</span>, <span class="refAuthor">Blake, S.</span>, <span class="refAuthor">Baker, F.</span>, and <span class="refAuthor">D. Black</span>, <span class="refTitle">"Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers"</span>, <span class="seriesInfo">RFC 2474</span>, <span class="seriesInfo">DOI 10.17487/RFC2474</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2474">https://www.rfc-editor.org/info/rfc2474</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
      <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4360">[RFC4360]</dt>
      <dd>
<span class="refAuthor">Sangli, S.</span>, <span class="refAuthor">Tappan, D.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"BGP Extended Communities Attribute"</span>, <span class="seriesInfo">RFC 4360</span>, <span class="seriesInfo">DOI 10.17487/RFC4360</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4360">https://www.rfc-editor.org/info/rfc4360</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4364">[RFC4364]</dt>
      <dd>
<span class="refAuthor">Rosen, E.</span> and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"BGP/MPLS IP Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4364</span>, <span class="seriesInfo">DOI 10.17487/RFC4364</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4364">https://www.rfc-editor.org/info/rfc4364</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4456">[RFC4456]</dt>
      <dd>
<span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Chen, E.</span>, and <span class="refAuthor">R. Chandra</span>, <span class="refTitle">"BGP Route Reflection: An Alternative to Full Mesh Internal BGP (IBGP)"</span>, <span class="seriesInfo">RFC 4456</span>, <span class="seriesInfo">DOI 10.17487/RFC4456</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4456">https://www.rfc-editor.org/info/rfc4456</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4684">[RFC4684]</dt>
      <dd>
<span class="refAuthor">Marques, P.</span>, <span class="refAuthor">Bonica, R.</span>, <span class="refAuthor">Fang, L.</span>, <span class="refAuthor">Martini, L.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">J. Guichard</span>, <span class="refTitle">"Constrained Route Distribution for Border Gateway Protocol/MultiProtocol Label Switching (BGP/MPLS) Internet Protocol (IP) Virtual Private Networks (VPNs)"</span>, <span class="seriesInfo">RFC 4684</span>, <span class="seriesInfo">DOI 10.17487/RFC4684</span>, <time datetime="2006-11" class="refDate">November 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4684">https://www.rfc-editor.org/info/rfc4684</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4760">[RFC4760]</dt>
      <dd>
<span class="refAuthor">Bates, T.</span>, <span class="refAuthor">Chandra, R.</span>, <span class="refAuthor">Katz, D.</span>, and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"Multiprotocol Extensions for BGP-4"</span>, <span class="seriesInfo">RFC 4760</span>, <span class="seriesInfo">DOI 10.17487/RFC4760</span>, <time datetime="2007-01" class="refDate">January 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4760">https://www.rfc-editor.org/info/rfc4760</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7153">[RFC7153]</dt>
      <dd>
<span class="refAuthor">Rosen, E.</span> and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"IANA Registries for BGP Extended Communities"</span>, <span class="seriesInfo">RFC 7153</span>, <span class="seriesInfo">DOI 10.17487/RFC7153</span>, <time datetime="2014-03" class="refDate">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7153">https://www.rfc-editor.org/info/rfc7153</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7911">[RFC7911]</dt>
      <dd>
<span class="refAuthor">Walton, D.</span>, <span class="refAuthor">Retana, A.</span>, <span class="refAuthor">Chen, E.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"Advertisement of Multiple Paths in BGP"</span>, <span class="seriesInfo">RFC 7911</span>, <span class="seriesInfo">DOI 10.17487/RFC7911</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7911">https://www.rfc-editor.org/info/rfc7911</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8029">[RFC8029]</dt>
      <dd>
<span class="refAuthor">Kompella, K.</span>, <span class="refAuthor">Swallow, G.</span>, <span class="refAuthor">Pignataro, C., Ed.</span>, <span class="refAuthor">Kumar, N.</span>, <span class="refAuthor">Aldrin, S.</span>, and <span class="refAuthor">M. Chen</span>, <span class="refTitle">"Detecting Multiprotocol Label Switched (MPLS) Data-Plane Failures"</span>, <span class="seriesInfo">RFC 8029</span>, <span class="seriesInfo">DOI 10.17487/RFC8029</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8029">https://www.rfc-editor.org/info/rfc8029</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8212">[RFC8212]</dt>
      <dd>
<span class="refAuthor">Mauch, J.</span>, <span class="refAuthor">Snijders, J.</span>, and <span class="refAuthor">G. Hankins</span>, <span class="refTitle">"Default External BGP (EBGP) Route Propagation Behavior without Policies"</span>, <span class="seriesInfo">RFC 8212</span>, <span class="seriesInfo">DOI 10.17487/RFC8212</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8212">https://www.rfc-editor.org/info/rfc8212</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8277">[RFC8277]</dt>
      <dd>
<span class="refAuthor">Rosen, E.</span>, <span class="refTitle">"Using BGP to Bind MPLS Labels to Address Prefixes"</span>, <span class="seriesInfo">RFC 8277</span>, <span class="seriesInfo">DOI 10.17487/RFC8277</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8277">https://www.rfc-editor.org/info/rfc8277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8664">[RFC8664]</dt>
      <dd>
<span class="refAuthor">Sivabalan, S.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Tantsura, J.</span>, <span class="refAuthor">Henderickx, W.</span>, and <span class="refAuthor">J. Hardwick</span>, <span class="refTitle">"Path Computation Element Communication Protocol (PCEP) Extensions for Segment Routing"</span>, <span class="seriesInfo">RFC 8664</span>, <span class="seriesInfo">DOI 10.17487/RFC8664</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8664">https://www.rfc-editor.org/info/rfc8664</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8669">[RFC8669]</dt>
      <dd>
<span class="refAuthor">Previdi, S.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Lindem, A., Ed.</span>, <span class="refAuthor">Sreekantiah, A.</span>, and <span class="refAuthor">H. Gredler</span>, <span class="refTitle">"Segment Routing Prefix Segment Identifier Extensions for BGP"</span>, <span class="seriesInfo">RFC 8669</span>, <span class="seriesInfo">DOI 10.17487/RFC8669</span>, <time datetime="2019-12" class="refDate">December 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8669">https://www.rfc-editor.org/info/rfc8669</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8986">[RFC8986]</dt>
      <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Camarillo, P., Ed.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Voyer, D.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">Z. Li</span>, <span class="refTitle">"Segment Routing over IPv6 (SRv6) Network Programming"</span>, <span class="seriesInfo">RFC 8986</span>, <span class="seriesInfo">DOI 10.17487/RFC8986</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8986">https://www.rfc-editor.org/info/rfc8986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9012">[RFC9012]</dt>
      <dd>
<span class="refAuthor">Patel, K.</span>, <span class="refAuthor">Van de Velde, G.</span>, <span class="refAuthor">Sangli, S.</span>, and <span class="refAuthor">J. Scudder</span>, <span class="refTitle">"The BGP Tunnel Encapsulation Attribute"</span>, <span class="seriesInfo">RFC 9012</span>, <span class="seriesInfo">DOI 10.17487/RFC9012</span>, <time datetime="2021-04" class="refDate">April 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9012">https://www.rfc-editor.org/info/rfc9012</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9252">[RFC9252]</dt>
      <dd>
<span class="refAuthor">Dawra, G., Ed.</span>, <span class="refAuthor">Talaulikar, K., Ed.</span>, <span class="refAuthor">Raszuk, R.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Zhuang, S.</span>, and <span class="refAuthor">J. Rabadan</span>, <span class="refTitle">"BGP Overlay Services Based on Segment Routing over IPv6 (SRv6)"</span>, <span class="seriesInfo">RFC 9252</span>, <span class="seriesInfo">DOI 10.17487/RFC9252</span>, <time datetime="2022-07" class="refDate">July 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9252">https://www.rfc-editor.org/info/rfc9252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RTC-Ext">[RTC-Ext]</dt>
      <dd>
<span class="refAuthor">Zhang, Z., Ed.</span>, <span class="refTitle">"Route Target Constrain Extension"</span>, <time datetime="2020-07-12" class="refDate">12 July 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-zzhang-idr-bgp-rt-constrains-extension-00#section-2">https://tools.ietf.org/html/draft-zzhang-idr-bgp-rt-constrains-extension-00#section-2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRTE">[SRTE]</dt>
      <dd>
<span class="refAuthor">Previdi, S., Ed.</span>, <span class="refTitle">"Advertising Segment Routing Policies in BGP"</span>, <time datetime="2019-11-18" class="refDate">18 November 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-idr-segment-routing-te-policy-08">https://tools.ietf.org/html/draft-ietf-idr-segment-routing-te-policy-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SRV6-INTER-DOMAIN">[SRV6-INTER-DOMAIN]</dt>
    <dd>
<span class="refAuthor">K A, Ed.</span>, <span class="refTitle">"SRv6 inter-domain mapping SIDs"</span>, <time datetime="2021-01-10" class="refDate">10 January 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-salih-spring-srv6-inter-domain-sids-00">https://datatracker.ietf.org/doc/html/draft-salih-spring-srv6-inter-domain-sids-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="Appendix_A">
<section id="appendix-A">
      <h2 id="name-applicability-to-intra-as-an">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-applicability-to-intra-as-an" class="section-name selfRef">Applicability to Intra AS and different Inter AS deployments.</a>
      </h2>
<p id="appendix-A-1">As described in <span><a href="#RFC4364" class="xref">BGP VPN</a> [<a href="#RFC4364" class="xref">RFC4364</a>]</span> Section 10, in
      an option-C network, service routes (VPN-IPv4) are neither maintained
      nor distributed by the ASBRs. Transport routes are maintained in the
      ASBRs and propagated in BGP LU (SAFI 4) or BGP CT (SAFI 76).<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2"><span><a href="#CTProc" class="xref">Illustration of CT Procedures</a> (<a href="#CTProc" class="xref">Section 19</a>)</span>
      illustrates how constructs of BGP CT work in an Inter AS option-C
      deployment. The BGP CT constructs: SAFI 76, Transport Class and
      Resolution Scheme are used in an option-C deploymnent.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<p id="appendix-A-3">In Intra AS and Inter AS option-A, option-B scenarios, SAFI 76 may
      not be used, but the Transport Class and Resolution Scheme mechanisms
      are used to provide service mapping.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">This section illustrates how BGP CT constructs work in Intra AS and
      Inter AS option-A, B deployment scenarios.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<section id="appendix-A.1">
        <h3 id="name-intra-as-usecase-2">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-intra-as-usecase-2" class="section-name selfRef">Intra AS usecase</a>
        </h3>
<section id="appendix-A.1.1">
          <h4 id="name-topology-7">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-topology-7" class="section-name selfRef">Topology</a>
          </h4>
<span id="name-bgp-ct-intra-as-2"></span><div id="BGPCT_INTRA_AS">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="appendix-A.1.1-1.1">
<pre>
                                    [RR11]
                                     |
                                     +
              [CE21]---[PE11]-------[P1]------[PE12]------[CE31]
                     |                             |
                     +                             +
                     |                             |
               AS2               ...AS1...               AS3

             10.21.21.21 ---- Traffic Direction ----&gt; 10.31.31.31
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-bgp-ct-intra-as-2" class="selfRef">BGP CT Intra-AS.</a>
            </figcaption></figure>
</div>
<p id="appendix-A.1.1-2">This example shows a provider network Autonomous system AS1. It
          serves customers AS2, AS3. Traffic direction being described is CE21
          to CE31. CE31 may request a specific SLA (e.g. Gold for this
          traffic), when traversing this provider network.<a href="#appendix-A.1.1-2" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.1.2">
          <h4 id="name-transport-layer-4">
<a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-transport-layer-4" class="section-name selfRef">Transport Layer</a>
          </h4>
<p id="appendix-A.1.2-1">AS1 uses RSVP-TE intra-domain tunnels between PE11 and PE12. And
          LDP tunnels for best effort traffic.<a href="#appendix-A.1.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-2">The network has two Transport classes: Gold with transport class
          id 100, Bronze with transport class id 200. These transport classes
          are provisioned at the PEs. This creates the Resolution Schemes for
          these transport classes at these PEs.<a href="#appendix-A.1.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-3">Following tunnels exist for Gold transport class.<a href="#appendix-A.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A.1.2-4.1">PE11_to_PE12_gold - RSVP-TE tunnel<a href="#appendix-A.1.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.1.2-4.2">PE12_to_PE11_gold - RSVP-TE tunnel<a href="#appendix-A.1.2-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A.1.2-5">Following tunnels exist for Bronze transport class.<a href="#appendix-A.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A.1.2-6.1">PE11_to_PE12_bronze - RSVP-TE tunnel<a href="#appendix-A.1.2-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.1.2-6.2">PE11_to_PE12_bronze - RSVP-TE tunnel<a href="#appendix-A.1.2-6.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A.1.2-7">These tunnels are provisioned to belong to transport class 100 or
          200.<a href="#appendix-A.1.2-7" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.1.3">
          <h4 id="name-service-layer-route-exchange-5">
<a href="#appendix-A.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-service-layer-route-exchange-5" class="section-name selfRef">Service Layer route exchange</a>
          </h4>
<p id="appendix-A.1.3-1">Service nodes PE11, PE12 negotiate service families (SAFI 128) on
          the BGP session with RR11. Service helper RR11 reflects service
          routes between the two PEs with nexthop unchanged. There are no
          tunnels for transport-class 100 or 200 from RR11 to the PEs.<a href="#appendix-A.1.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.3-2">Forwarding happens using service routes at service nodes PE11,
          PE12. Routes received from CEs are not present in any other nodes'
          FIB in the provider network.<a href="#appendix-A.1.3-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1.3-3">CE31 advertises a route for example prefix 10.31.31.31 with
          nexthop self to PE12. CE31 can attach a Mapping Community
          Color:0:100 on this route, to indicate its request for Gold SLA. Or,
          PE11 can attach the same using locally configured policies.<a href="#appendix-A.1.3-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1.3-4">Consider CE31 is getting VPN service from PE12. The
          RD:10.31.31.31 route is readvertised in SAFI 128 by PE12 with
          nexthop self (10.12.12.12) and label V-L1, to RR11 with the Mapping
          Community Color:0:100 attached. This SAFI 128 route reaches PE11 via
          RR11 with the nexthop unchanged as PE12 and label V-L1. Now PE11 can
          resolve the PNH 10.12.12.12 using PE11_to_PE12_gold RSVP TE LSP.<a href="#appendix-A.1.3-4" class="pilcrow">¶</a></p>
<p id="appendix-A.1.3-5">The IP FIB at PE11 VRF will have a route for 10.31.31.31 with a
          nexthop when resolved using Resolution Scheme belonging to the
          mapping community Color:0:100, points to a PE11_to_PE12_gold
          tunnel.<a href="#appendix-A.1.3-5" class="pilcrow">¶</a></p>
<p id="appendix-A.1.3-6">BGP CT SAFI 76 is not used in this Intra AS deployment. But the
          Transport class and Resolution Scheme constructs are used to
          preserve end-to-end SLA.<a href="#appendix-A.1.3-6" class="pilcrow">¶</a></p>
</section>
</section>
<section id="appendix-A.2">
        <h3 id="name-inter-as-option-a-usecase-2">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-inter-as-option-a-usecase-2" class="section-name selfRef">Inter AS option-A usecase</a>
        </h3>
<section id="appendix-A.2.1">
          <h4 id="name-topology-8">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-topology-8" class="section-name selfRef">Topology</a>
          </h4>
<span id="name-bgp-ct-inter-as-option-a-2"></span><div id="BGPCT_INTERAS_A">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="appendix-A.2.1-1.1">
<pre>
                  [RR11]                        [RR21]
                    |                             |
                    +                             +
[CE31]---[PE11]----[P1]----[ASBR11]---[ASBR21]---[P2]---[PE21]----[CE41]
        |                           |                           |
        +                           +                           +
        |                           |                           |
  AS3               ..AS1..               ..AS2..                  AS4

10.31.31.31          ---- Traffic Direction ----&gt;           10.41.41.41
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-bgp-ct-inter-as-option-a-2" class="selfRef">BGP CT Inter-AS option A.</a>
            </figcaption></figure>
</div>
<p id="appendix-A.2.1-2">This example shows two provider network Autonomous systems AS1,
          AS2. They serve L3VPN customers AS3, AS4 respectively. The ASBRs
          ASBR11 and ASBR21 have IP VRFs connected directly. The inter AS link
          is IP enabled with no MPLS forwarding.<a href="#appendix-A.2.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2.1-3">Traffic direction being described is CE31 to CE41. CE41 may
          request a specific SLA (e.g. Gold for this traffic), when traversing
          these provider core networks.<a href="#appendix-A.2.1-3" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.2.2">
          <h4 id="name-transport-layer-5">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-transport-layer-5" class="section-name selfRef">Transport Layer</a>
          </h4>
<p id="appendix-A.2.2-1">AS1 uses RSVP-TE intra-domain tunnels between PE11 and ASBR11.
          And LDP tunnels for best effort traffic. AS2 uses SRTE intra-domain
          tunnels between ASBR21 and PE21, and L-ISIS for best effort
          tunnels.<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-2">The networks have two Transport classes: Gold with transport
          class id 100, Bronze with transport class id 200. These transport
          classes are provisioned at the PEs and ASBRs. This creates the
          Resolution Schemes for these transport classes at these PEs and
          ASBRs.<a href="#appendix-A.2.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-3">Following tunnels exist for Gold transport class.<a href="#appendix-A.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A.2.2-4.1">PE11_to_ASBR11_gold - RSVP-TE tunnel<a href="#appendix-A.2.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.2.2-4.2">ASBR11_to_PE11_gold - RSVP-TE tunnel<a href="#appendix-A.2.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.2.2-4.3">PE21_to_ASBR21_gold - SRTE tunnel<a href="#appendix-A.2.2-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.2.2-4.4">ASBR21_to_PE21_gold - SRTE tunnel<a href="#appendix-A.2.2-4.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A.2.2-5">Following tunnels exist for Bronze transport class.<a href="#appendix-A.2.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A.2.2-6.1">PE11_to_ASBR11_bronze - RSVP-TE tunnel<a href="#appendix-A.2.2-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.2.2-6.2">ASBR11_to_PE11_bronze - RSVP-TE tunnel<a href="#appendix-A.2.2-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.2.2-6.3">PE21_to_ASBR21_bronze - SRTE tunnel<a href="#appendix-A.2.2-6.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.2.2-6.4">ASBR21_to_PE21_bronze - SRTE tunnel<a href="#appendix-A.2.2-6.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A.2.2-7">These tunnels are provisioned to belong to transport class 100 or
          200.<a href="#appendix-A.2.2-7" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.2.3">
          <h4 id="name-service-layer-route-exchange-6">
<a href="#appendix-A.2.3" class="section-number selfRef">A.2.3. </a><a href="#name-service-layer-route-exchange-6" class="section-name selfRef">Service Layer route exchange</a>
          </h4>
<p id="appendix-A.2.3-1">Service nodes PE11, ASBR11 negotiate service familiy (SAFI 128)
          on the BGP session with RR11. Service helper RR11 reflects service
          routes between the PE11 and ASBR11 with nexthop unchanged.<a href="#appendix-A.2.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.3-2">Similarly, in AS2 PE21, ASBR21 negotiate service family (SAFI
          128) on the BGP session with RR21, which reflects service routes
          between the PE21 and ASBR21 with nexthop unchanged .<a href="#appendix-A.2.3-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2.3-3">CE41 advertises a route for example prefix 10.41.41.41 with
          nexthop self to PE21 VRF. CE41 can attach a Mapping Community
          Color:0:100 on this route, to indicate its request for Gold SLA. Or,
          PE21 can attach the same using locally configured policies.<a href="#appendix-A.2.3-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2.3-4">Consider CE41 is getting VPN service from PE21. The
          RD:10.41.41.41 route is readvertised in SAFI 128 by PE21 with
          nexthop self (10.21.21.21) and label V-L1, to RR21 with the Mapping
          Community Color:0:100 attached. This SAFI 128 route reaches ASBR21
          via RR21 with the nexthop unchanged as PE21 and label V-L1. Now
          ASBR21 can resolve the PNH 10.21.21.21 using ASBR21_to_PE21_gold
          SRTE LSP.<a href="#appendix-A.2.3-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2.3-5">The IP FIB at ASBR21 VRF will have a route for 10.41.41.41 with a
          nexthop resolved using Resolution Scheme associated with mapping
          community Color:0:100, pointing to ASBR21_to_PE21_gold tunnel.<a href="#appendix-A.2.3-5" class="pilcrow">¶</a></p>
<p id="appendix-A.2.3-6">This route is readvertised by ASBR21 on BGP session inside VRF
          with nexthop self. EBGP session peering on interface address. ASBR21
          acts like a CE to ASBR11, and the above mentioned process repeats in
          AS1, until route reaches PE11 and resolves over PE11_to_ASBR11_gold
          RSVP TE tunnel.<a href="#appendix-A.2.3-6" class="pilcrow">¶</a></p>
<p id="appendix-A.2.3-7">Traffic traverses as IP packet on the following legs: CE31-PE11,
          ASBR11-ASBR21, PE21-CE41. And uses MPLS forwarding inside AS1, AS2
          core.<a href="#appendix-A.2.3-7" class="pilcrow">¶</a></p>
<p id="appendix-A.2.3-8">BGP CT SAFI 76 is not used in this Inter AS option-A deployment.
          But the Transport class and Resolution Scheme constructs are used to
          preserve end-to-end SLA.<a href="#appendix-A.2.3-8" class="pilcrow">¶</a></p>
</section>
</section>
<section id="appendix-A.3">
        <h3 id="name-inter-as-option-b-usecase-2">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-inter-as-option-b-usecase-2" class="section-name selfRef">Inter AS option-B usecase</a>
        </h3>
<section id="appendix-A.3.1">
          <h4 id="name-topology-9">
<a href="#appendix-A.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-topology-9" class="section-name selfRef">Topology</a>
          </h4>
<span id="name-bgp-ct-inter-as-option-b-2"></span><div id="BGPCT_INTERAS_B">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="appendix-A.3.1-1.1">
<pre>
                  [RR13]                        [RR23]
                    |                             |
                    +                             +
[CE31]---[PE11]----[P1]----[ASBR12]---[ASBR21]---[P2]---[PE22]----[CE41]
        |                           |                           |
        +                           +                           +
        |                           |                           |
  AS3               ..AS1..               ..AS2..                  AS4

10.31.31.31          ---- Traffic Direction ----&gt;           10.41.41.41
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-bgp-ct-inter-as-option-b-2" class="selfRef">BGP CT Inter-AS option B.</a>
            </figcaption></figure>
</div>
<p id="appendix-A.3.1-2">This example shows two provider network Autonomous systems AS1,
          AS2. They serve L3VPN customers AS3, AS4 respectively. The ASBRs
          ASBR12 and ASBR21 dont have any IP VRFs . The inter AS link is MPLS
          forwarding enabled.<a href="#appendix-A.3.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3.1-3">Traffic direction being described is CE31 to CE41. CE41 may
          request a specific SLA (e.g. Gold for this traffic), when traversing
          these provider core networks.<a href="#appendix-A.3.1-3" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.3.2">
          <h4 id="name-transport-layer-6">
<a href="#appendix-A.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-transport-layer-6" class="section-name selfRef">Transport Layer</a>
          </h4>
<p id="appendix-A.3.2-1">AS1 uses RSVP-TE intra-domain tunnels between PE11 and ASBR21.
          And LDP tunnels for best effort traffic. AS2 uses SRTE intra-domain
          tunnels between ASBR21 and PE22, and L-ISIS for best effort
          tunnels.<a href="#appendix-A.3.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3.2-2">The networks have two Transport classes: Gold with transport
          class id 100, Bronze with transport class id 200. These transport
          classes are provisioned at the PEs and ASBRs. This creates the
          Resolution Schemes for these transport classes at these PEs and
          ASBRs.<a href="#appendix-A.3.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3.2-3">Following tunnels exist for Gold transport class.<a href="#appendix-A.3.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A.3.2-4.1">PE11_to_ASBR12_gold - RSVP-TE tunnel<a href="#appendix-A.3.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.3.2-4.2">ASBR12_to_PE11_gold - RSVP-TE tunnel<a href="#appendix-A.3.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.3.2-4.3">PE22_to_ASBR21_gold - SRTE tunnel<a href="#appendix-A.3.2-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.3.2-4.4">ASBR21_to_PE22_gold - SRTE tunnel<a href="#appendix-A.3.2-4.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A.3.2-5">Following tunnels exist for Bronze transport class.<a href="#appendix-A.3.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-A.3.2-6.1">PE11_to_ASBR12_bronze - RSVP-TE tunnel<a href="#appendix-A.3.2-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.3.2-6.2">ASBR12_to_PE11_bronze - RSVP-TE tunnel<a href="#appendix-A.3.2-6.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.3.2-6.3">PE22_to_ASBR21_bronze - SRTE tunnel<a href="#appendix-A.3.2-6.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="appendix-A.3.2-6.4">ASBR21_to_PE22_bronze - SRTE tunnel<a href="#appendix-A.3.2-6.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-A.3.2-7">These tunnels are provisioned to belong to transport class 100 or
          200.<a href="#appendix-A.3.2-7" class="pilcrow">¶</a></p>
</section>
<section id="appendix-A.3.3">
          <h4 id="name-service-layer-route-exchange-7">
<a href="#appendix-A.3.3" class="section-number selfRef">A.3.3. </a><a href="#name-service-layer-route-exchange-7" class="section-name selfRef">Service Layer route exchange</a>
          </h4>
<p id="appendix-A.3.3-1">Service nodes PE11, ASBR12 negotiate service familiy (SAFI 128)
          on the BGP session with RR13. Service helper RR13 reflects service
          routes between the PE11 and ASBR12 with nexthop unchanged.<a href="#appendix-A.3.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-2">Similarly, in AS2 PE22, ASBR21 negotiate service family (SAFI
          128) on the BGP session with RR23, which reflects service routes
          between the PE22 and ASBR21 with nexthop unchanged .<a href="#appendix-A.3.3-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-3">ASBR21 and ASBR12 negotiate SAFI 128 between them, and
          readvertise L3VPN routes with nexthop self, allocating new labels.
          EBGP session peering on interface address.<a href="#appendix-A.3.3-3" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-4">CE41 advertises a route for example prefix 10.41.41.41 with
          nexthop self to PE22 VRF. CE41 can attach a Mapping Community
          Color:0:100 on this route, to indicate its request for Gold SLA. Or,
          PE22 can attach the same using locally configured policies.<a href="#appendix-A.3.3-4" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-5">Consider CE41 is getting VPN service from PE22. The
          RD:10.41.41.41 route is readvertised in SAFI 128 by PE22 with
          nexthop self (10.22.22.22) and label V-L1, to RR23 with the Mapping
          Community Color:0:100 attached. This SAFI 128 route reaches ASBR21
          via RR23 with the nexthop unchanged as PE22 and label V-L1. Now
          ASBR21 can resolve the PNH 10.22.22.22 using ASBR21_to_PE22_gold
          SRTE LSP.<a href="#appendix-A.3.3-5" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-6">Next, ASBR21 readvertises the RD:10.41.41.41 route with nexthop
          self to ASBR12, with a newly allocated MPLS label, V-L2. Forwarding
          for this label is installed to Swap V-L1, and Push labels for
          ASBR21_to_PE22_gold tunnel.<a href="#appendix-A.3.3-6" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-7">ASBR12 further readvertises the RD:10.41.41.41 route via RR13 to
          PE11 with nexthop self 10.12.12.12. PE1 resolves the nexthop
          10.12.12.12 over PE11_to_ASBR11_gold RSVP TE tunnel.<a href="#appendix-A.3.3-7" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-8">Traffic traverses as IP packet on the following legs: CE31-PE11,
          PE21-CE41. And uses MPLS forwarding on ASBR11-ASBR21 link, and
          inside AS1, AS2 core.<a href="#appendix-A.3.3-8" class="pilcrow">¶</a></p>
<p id="appendix-A.3.3-9">BGP CT SAFI 76 is not used in this Inter AS option-B deployment.
          But the Transport class and Resolution Scheme constructs are used to
          preserve end-to-end SLA.<a href="#appendix-A.3.3-9" class="pilcrow">¶</a></p>
</section>
</section>
</section>
</div>
<div id="Appendix_B">
<section id="appendix-B">
      <h2 id="name-why-reuse-rfc-8277-and-rfc-4">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-why-reuse-rfc-8277-and-rfc-4" class="section-name selfRef">Why reuse RFC 8277 and RFC 4364?</a>
      </h2>
<p id="appendix-B-1">RFC 4364 is one of the key design patterns produced by networking
      industry. It introduced virtualization and allowed sharing of resources
      in service provider space with multiple tenant networks, providing
      isolated and secure Layer3 VPN services. This design pattern has been
      reused since to provide other service layer virtualizations like Layer2
      virtualization (VPLS, L2VPN, EVPN), ISO virtualization, ATM
      virtualization, Flowspec VPN.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">It is to be noted that these services have different NLRI encoding.
      L3VPN Service family that binds MPLS label to an IP prefix use RFC 8277
      encoding, and others define different NLRI encodings.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<p id="appendix-B-3">BGP CT reuses RFC 4364 procedures to slice a transport network into
      multiple transport planes that different service routes can bind to,
      using Color.<a href="#appendix-B-3" class="pilcrow">¶</a></p>
<p id="appendix-B-4">BGP CT reuses RFC 8277 because it precisely fits the purpose. viz. In
      a MPLS network, BGP CT needs to bind MPLS label for transport endpoints
      which are IPv4 or IPv6 endpoints, and disambiguate between multiple
      instances of those endpoints in multiple transport planes. Hence use of
      RD:IP_Prefix and carrying a Label for it as specified in RFC 8277 works
      well for this purpose.<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<p id="appendix-B-5">Another advantage of using the precise encoding as defined in RFC
      4364 and RFC 8277 is that it allows to interoperate with BGP speakers
      that support SAFI 128. This can be useful during transition, until all
      BGP speakers in the network support BGP CT.<a href="#appendix-B-5" class="pilcrow">¶</a></p>
<p id="appendix-B-6">In future, if RFC 8277 evolves into a typed NLRI, that does not carry
      Label in the NLRI, BGP CT will be compatible with that as-well. In
      essence, BGP CT encoding is compatible with existing deployed
      technologies (RFC 4364, RFC 8277) and will adapt to any changes RFC 8277
      mechanisms undergo in future.<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<p id="appendix-B-7">This is a more pragmatic approach which leverages the benefits of
      time tested design patterns proposed in RFC 4364 and RFC 8277. Moreover,
      this approach greatly reduces operational training costs and protocol
      compatibility considerations as it complements and works well with
      existing protocol machineries. This problem does not need reinventing
      the wheel with brand new NLRI and procedures.<a href="#appendix-B-7" class="pilcrow">¶</a></p>
<p id="appendix-B-8">This is a more pragmatic approach, rather than abandoning time tested
      design pattern like RFC 4364 and RFC 8277, just to invent something
      completely new that is not backward compatible with existing
      deployements. Overloading RFC 8277 NLRI MPLS Label field with
      information related to non MPLS dataplane leads to backward
      compatibility issues.<a href="#appendix-B-8" class="pilcrow">¶</a></p>
<section id="appendix-B.1">
        <h3 id="name-update-packing-consideration">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-update-packing-consideration" class="section-name selfRef">Update packing considerations</a>
        </h3>
<p id="appendix-B.1-1">BGP CT carries transport class as an attribute. This means routes
        that dont share the same transport class cannot be packed into same
        Update message. Update packing in BGP CT will be similar to RFC 8277
        family routes carrying attributes like communities or extended
        communities. Service families like SAFI 128 have considerably more
        scale than transport families like SAFI 4 or SAFI 76, which carry only
        loopbacks. Update packing mechanisms that scale for SAFI 128 routes
        will scale similarly for SAFI 76 routes also.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.1-2">The document <span><a href="#Intent-Routing" class="xref">Intent-aware Routing
        using Color</a> [<a href="#Intent-Routing" class="xref">Intent-Routing</a>]</span> section 6.3.2.1 suggests scaling numbers for
        transport network where BGP CT can be deployed. Experiments were
        conducted with this scale to find the convergence time with BGP CT for
        those scaling numbers. Scenarios involving BGP CT carrying IPv4, IPv6
        endpoints with MPLS label, and IPv6 endpoints with SRv6 SID were
        tested.<a href="#appendix-B.1-2" class="pilcrow">¶</a></p>
<p id="appendix-B.1-3">Tests were conducted with 1.9 million BGP CT route scale (387K
        endpoints in 5 transport classes). Initial convergence time for all
        cases was less than 2 minutes, This experiment proves that carrying
        transport class information as an attribute keeps BGP convergence
        within acceptable range. Details of the experiment and test results
        are available in <span><a href="#BGP-CT-UPDATE-PACKING-TEST" class="xref">BGP CT
        Update packing Test Results</a> [<a href="#BGP-CT-UPDATE-PACKING-TEST" class="xref">BGP-CT-UPDATE-PACKING-TEST</a>]</span>.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<p id="appendix-B.1-4">Further, even in today's BGP LU deployments each egress node
        originates BGP LU route for it's loopback, with some attributes like
        community identifying the originating node or region, and AIGP
        attribute. These attributes may be unique per egress node, thus do not
        help with update packing in transport layer family routes.<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="Appendix_C">
<section id="appendix-C">
      <h2 id="name-scaling-using-bgp-mpls-names">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-scaling-using-bgp-mpls-names" class="section-name selfRef">Scaling using BGP MPLS Namespaces</a>
      </h2>
<p id="appendix-C-1">This section describes how scaling is achieved in an Inter domain
      MPLS network, where a domain is an AS or IGP area. Domain boundary is
      demarcated by a BN performing BGP nexthop self action on the transport
      route.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">It considers the scenario suggested in the document <span><a href="#Intent-Routing" class="xref">Intent-aware Routing using Color</a> [<a href="#Intent-Routing" class="xref">Intent-Routing</a>]</span> section
      6.3.2.1. where 300K nodes exist in the network with 5 transport
      classes.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">This may result in 1.5M transport layer routes and MPLS transit
      routes in all Border Nodes in the network, which may overwhelm the
      nodes' MPLS forwarding resources.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">This section explains how mechanism described in <span><a href="#MPLS-NAMESPACES" class="xref">MPLS Namespaces</a> [<a href="#MPLS-NAMESPACES" class="xref">MPLS-NAMESPACES</a>]</span> is used to scale such a
      network. This approach reduces the number of PNHs that are globally
      visible in the network, thus reducing forwarding resource usage network
      wide. Service route state is kept confined closer to network edge, and
      any churn is confined within the region containing the point of failure,
      which improves convergence.<a href="#appendix-C-4" class="pilcrow">¶</a></p>
<p id="appendix-C-5">In order to achieve these scaling benefits, new functionality is
      required only at a Region's Border Nodes and the Regional RRs. All other
      nodes can remain legacy nodes, and still get the scaling and convergence
      benefits of this mechanism. This is mainly advantageous to ingress and
      egress PE devices which may be low end devices not capable of pushing
      deep label stacks or supporting large number of ECMP nexthops. They can
      enjoy the scaling benefits without needing software upgrades.<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<section id="appendix-C.1">
        <h3 id="name-illustration-2">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-illustration-2" class="section-name selfRef">Illustration.</a>
        </h3>
<p id="appendix-C.1-1">Let us consider the decomposition of this example network with 300K
        nodes to be such that there are 300 domains containing 1000 nodes
        each. The mechanism described here will reduce the forwarding resource
        usage in all Border Nodes to become a function of number of domains
        (300) instead of number of nodes (300K). Thus drastically reducing
        MPLS transit routes from 1.5M to 1500. The Border Nodes and Regional
        RRs in a Region do the job of abstracting the 1000 PE loopbacks from
        the rest of the network. The rest of the network sees this region as 1
        BGP nexthop, and not as 1000 BGP nexthops.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-C.2">
        <h3 id="name-topology-10">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-topology-10" class="section-name selfRef">Topology</a>
        </h3>
<span id="name-bgp-mpls-namespaces-2"></span><div id="BGP_MPLS_NS">
<figure id="figure-15">
          <div class="alignLeft art-text artwork" id="appendix-C.2-1.1">
<pre>

               [RR11]                           [RR31]
                 |                                |
                 |                                |
        [PE11]\  |  /[BN11]--+       +--[BN31]\   |   /[PE31]
               \ | /          \     /          \  |  /
[CE41]--[PE12]--[P11]          [BN21]           [P31]--[PE32]--[CE31]
         ..    /   \          /     \          /     \    ..
         ..   /     \[BN12]--+       +--[BN32]/       \   ..
        [PE11000]                                      [PE31000]
      |                  |                |                   |
 AS4  |     ..Domain1..  |  ..Domain2..   |    ..Domain3..    | AS3
      |                  |   (backbone)   |                   |

                  &lt;---- Traffic Direction ----
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-bgp-mpls-namespaces-2" class="selfRef">BGP MPLS Namespaces.</a>
          </figcaption></figure>
</div>
<p id="appendix-C.2-2">This topology shows a cross section of the network with focus on
        two domains Domain1 and Domain3 connected via a backbone domain
        Domain2. Rest of the domains are not shown for brevity. The border
        nodes have forwarding state pertaining to all domains in the network.
        The control plane and forwarding plane state in node BN21 can be
        examined to determine the MPLS scaling characteristics of the
        network.<a href="#appendix-C.2-2" class="pilcrow">¶</a></p>
<p id="appendix-C.2-3">L3VPN Service routes are present only at ingress and egress PEs.
        L3VPN family (SAFI 128) is negotiated between PE11..PE11000 and
        regional route reflector RR11. RR11 has multihop EBGP peering with
        RR31 and negotiates SAFI 128. RR31 further peers with all PEs
        PE31..PE31000 in Domain3.<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
<p id="appendix-C.2-4">At the Transport layer - in Domain1, PE11..PE11000 negotiate BGP
        families (SAFI 4, SAFI 76) with BN11, BN12. In Domain2, BN11 and BN12
        similarly negotiate the transport families with BN21, which in turn
        peers with BN31 and BN32. In Domain3, BN31 and BN32 peer with PEs
        PE31..PE31000. Each of these BNs change BGP nexthop to self, when re
        advertising the SAFI 4, SAFI 76 transport routes.<a href="#appendix-C.2-4" class="pilcrow">¶</a></p>
<p id="appendix-C.2-5">When all nodes loopback addresses are visible through out the
        network, it will result in 1.5M transport layer routes and MPLS
        transit routes in BN21.<a href="#appendix-C.2-5" class="pilcrow">¶</a></p>
<p id="appendix-C.2-6">Following sections describe the control plane and forwarding plane
        mechanics to reduce this to 1500 routes, when MPLS Namespaces is
        deployed in this network.<a href="#appendix-C.2-6" class="pilcrow">¶</a></p>
<p id="appendix-C.2-7">Traffic direction being described is CE41 to CE31. Reverse
        direction would work in similar way.<a href="#appendix-C.2-7" class="pilcrow">¶</a></p>
<p id="appendix-C.2-8">Traffic direction being described is CE41 to CE31. Reverse
        direction would work in similar way.<a href="#appendix-C.2-8" class="pilcrow">¶</a></p>
</section>
<section id="appendix-C.3">
        <h3 id="name-context-protocol-nexthop-add">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-context-protocol-nexthop-add" class="section-name selfRef">Context Protocol Nexthop Address (CPNH)</a>
        </h3>
<p id="appendix-C.3-1">A MPLS Namespace is identified by a Context PNH address. In MPLS
        forwarding, labels are locally significant to the node advertising it.
        E.g. labels in default/global MPLS Namespace are scoped by the node's
        loopback address. The labels belonging to a MPLS Namespace are locally
        significant in scope of the Context PNH address.<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
<p id="appendix-C.3-2">A UHP label called as "Context Label" is advertised for the CPNH in
        a transport protocol, which points to the MPLS Namespace forwarding
        context. When Context label is received as outer label in a MPLS
        packet, it is Popped, and lookup is performed for the MPLS label that
        appears in the MPLS Namespace identified by the CPNH.<a href="#appendix-C.3-2" class="pilcrow">¶</a></p>
<p id="appendix-C.3-3">In this example, CPNH is an anycast IP address that represents set
        of PEs in a domain. E.g. CPNH1 represent all PEs in Domain1. And CPNH3
        represents all PEs in Domain3.<a href="#appendix-C.3-3" class="pilcrow">¶</a></p>
</section>
<section id="appendix-C.4">
        <h3 id="name-service-forwarding-helper-an">
<a href="#appendix-C.4" class="section-number selfRef">C.4. </a><a href="#name-service-forwarding-helper-an" class="section-name selfRef">Service Forwarding Helper, and changes to transport layer.</a>
        </h3>
<p id="appendix-C.4-1">The border nodes BN11, BN12 maintain the forwarding context for
        MPLS Namespace identified by CPNH1. They advertise CPNH1 in transport
        layer routes like SAFI-4 or SAFI-76 with a UHP Context Label CL1. Any
        transport layer protocol may be used to advertise the UHP Context
        Label for the CPNH.<a href="#appendix-C.4-1" class="pilcrow">¶</a></p>
<p id="appendix-C.4-2">In this way, BN11 and BN12 serve as Service Forwarding Helpers for
        CPNH1 MPLS Namespace. They attract traffic that remote devices send
        towards the BGP nexthop CPNH1, and forward the MPLS packets received
        with the MPLS labels belonging to the MPLS Namespace identified by
        CPNH1.<a href="#appendix-C.4-2" class="pilcrow">¶</a></p>
<p id="appendix-C.4-3">The individual loopback addresses of the PEs need not be advertised
        outside the local region. E.g. PE11..PE11000 are not advertised beyond
        BN11, BN12. Only CPNH1 and RR11 addresses are advertised out. RR1 is
        used for the control plane peering. and CPNH1 is used as an forwarding
        anchor point.<a href="#appendix-C.4-3" class="pilcrow">¶</a></p>
<p id="appendix-C.4-4">Similarly, Domain3 advertises only RR31 and CPNH3 to Domain2. This
        significantly reduces the transport route scale and MPLS forwarding
        resource usage at the border nodes throughout the network.<a href="#appendix-C.4-4" class="pilcrow">¶</a></p>
</section>
<section id="appendix-C.5">
        <h3 id="name-bgp-mpls-namespace-address-f">
<a href="#appendix-C.5" class="section-number selfRef">C.5. </a><a href="#name-bgp-mpls-namespace-address-f" class="section-name selfRef">BGP MPLS Namespace Address family (AFI:16399, SAFI:128)</a>
        </h3>
<p id="appendix-C.5-1">In Domain1, the regional route reflector RR11 negotiates MPLS
        Namespace Signaling address family with the border nodes BN11, BN12.
        RR11 is an external label allocator for the MPLS Namespace identified
        by CPNH1. RR1 advertises in the MPLS Namespace address family, the
        labels it allocated in scope of CPNH1. These routes are advertised
        with a route target that identifies CPNH1. BN11 and BN12 use this
        route target to import the label route into the forwarding context
        associated with CPNH1.<a href="#appendix-C.5-1" class="pilcrow">¶</a></p>
<p id="appendix-C.5-2">Similarly, in Domain3, RR31 negotiates MPLS Namespace Signaling
        address family with the border nodes BN31, BN32.<a href="#appendix-C.5-2" class="pilcrow">¶</a></p>
</section>
<section id="appendix-C.6">
        <h3 id="name-changes-to-service-layer-rou">
<a href="#appendix-C.6" class="section-number selfRef">C.6. </a><a href="#name-changes-to-service-layer-rou" class="section-name selfRef">Changes to Service Layer route exchange</a>
        </h3>
<p id="appendix-C.6-1">When RR11 re-advertises to RR31 a VPN route RD:Pfx1 received with
        label VL1 from egress PE11 in Domain1, it sets BGP nexthop to CPNH1,
        and advertises a new label PL1. This label PL1 is allocated within the
        scope of CPNH1 namespace.<a href="#appendix-C.6-1" class="pilcrow">¶</a></p>
<p id="appendix-C.6-2">The label PL1 is advertised to BN1, BN2 in MPLS Namespace address
        family with a route target identifying CPNH1, and BGP nexthop PE11 and
        label VL1 that were received from the egress PE. BN1 and BN2 resolve
        the path to that BGP nexthop PE11 and use as nexthop for the PL1 route
        installed in CPNH1 forwarding context.<a href="#appendix-C.6-2" class="pilcrow">¶</a></p>
<p id="appendix-C.6-3">The remote PEs in Domain3 consume the BGP updates from Domain1
        following regular procedures for SAFI 128. When resolving the BGP
        nexthop CPNH1, they will push the context label that lands the traffic
        into the correct forwarding context in one of the border nodes.<a href="#appendix-C.6-3" class="pilcrow">¶</a></p>
</section>
<section id="appendix-C.7">
        <h3 id="name-analysis-of-forwarding-behav">
<a href="#appendix-C.7" class="section-number selfRef">C.7. </a><a href="#name-analysis-of-forwarding-behav" class="section-name selfRef">Analysis of forwarding behavior</a>
        </h3>
<p id="appendix-C.7-1">The forwarding behavior thus achieved is similar to Inter AS
        option-b, without carrying any service routes at the border nodes.
        Further, the MPLS namespace labels are installed in all the border
        nodes, which allows for quicker traffic convergence in case of border
        node failure. The number of border nodes can be increased in a scale
        out manner, which gives a cookie cutter template to scale a network
        region.<a href="#appendix-C.7-1" class="pilcrow">¶</a></p>
<p id="appendix-C.7-2">In conclusion, this mechanism provides both scaling and convergence
        benefits for the MPLS network, and allows to support huge scale
        networks.<a href="#appendix-C.7-2" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="AppendixD">
<section id="appendix-D">
      <h2 id="name-bgp-ct-deployment-in-srv6-ne">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-bgp-ct-deployment-in-srv6-ne" class="section-name selfRef">BGP CT deployment in SRv6 networks</a>
      </h2>
<p id="appendix-D-1">This section describes BGP CT deployment in SRv6 multi-domain network
      using Inter-AS Option C architecture.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-in-srv6-only-dataplan"></span><div id="BGPCTSRv6">
<figure id="figure-16">
        <div class="alignLeft art-text artwork" id="appendix-D-2.1">
<pre>
             AS1                   AS2
  CE1---[PE1-----ASBR1]-----[ASBR2-----PE2]---CE2

         -------Forwarding Direction-----&gt;
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-bgp-ct-in-srv6-only-dataplan" class="selfRef">BGP CT in SRv6 Only Dataplane</a>
        </figcaption></figure>
</div>
<p id="appendix-D-3">In the above topology there are two ASs, AS1 and AS2<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">Intra-AS Nodes in AS1 and AS2 speak IBGP-CT and ISIS-SRv6 between
      them. The Inter-AS Nodes speak EBGP-CT between them. Transport Classes
      Gold (100) and Bronze (200) are provisioned in SNs and BNs. All BGP CT
      advertisements in this example will carry a MPLS label value of 3
      (Implicit Null).<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<p id="appendix-D-5">The following SRv6 locators are provisioned<a href="#appendix-D-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-D-6.1">PE1-SRv6 - SRv6 Locator for PE1<a href="#appendix-D-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="appendix-D-6.2">PE2-SRv6 - SRv6 Locator for PE2<a href="#appendix-D-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="appendix-D-6.3">ASBR1-SRv6 - SRv6 Locator for ASBR1<a href="#appendix-D-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="appendix-D-6.4">ASBR2-SRv6 - SRv6 Locator for ASBR2<a href="#appendix-D-6.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-D-7">The following SRv6 End SIDs are provisioned<a href="#appendix-D-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="appendix-D-8.1">PE2-SRv6-gold - PE2 End SID for gold transport class<a href="#appendix-D-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="appendix-D-8.2">PE2-SRv6-bronze - PE2 End SID for bronze transport class<a href="#appendix-D-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="appendix-D-8.3">ASBR1-SRv6-gold - ASBR1 End SID for gold transport class<a href="#appendix-D-8.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="appendix-D-8.4">ASBR1-SRv6-bronze - ASBR1 End SID for bronze transport class<a href="#appendix-D-8.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-D-9">The above provisioned SRv6 End SIDs will be advertised via ISIS
      between Intra-AS nodes and the established SRv6 tunnels will be
      installed into the correct TRDB based on color. The illustrations that
      follow, show how the import processing and BGP CT advertisements are
      made. Firstly, PE2 advertises its SRv6 End Points to ASBR2 via IBGP-CT
      as shown below.<a href="#appendix-D-9" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-advertisements-from-p"></span><figure id="figure-17">
        <div class="alignLeft art-text artwork" id="appendix-D-10.1">
<pre>  IBGP-CT: PE2---&gt;ASBR2

      RD1:PE2-SRv6-gold,
        transport-target:0:100,
        Prefix-SID: PE2-SRv6-gold,
        NH: PE2-LPBK

      RD2:PE2-SRv6-bronze,
        transport-target:0:200,
        Prefix-SID: PE2-SRv6-bronze,
        NH: PE2-LPBK
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-bgp-ct-advertisements-from-p" class="selfRef">BGP CT advertisements from PE2 to ASBR2</a>
        </figcaption></figure>
<p id="appendix-D-11">When ASBR2 receives the IBGP CT advertisement from PE2, it performs
      import processing and nexthop resolution for the SRv6 End Point
      PE2-SRv6-gold in the gold TRDB based on its transport target. On
      successful resolution, a route for PE2-SRv6-gold is installed in the
      global IPv6 FIB for enabling SRv6 forwarding. The BGP-CT route for
      RD1:PE2-SRv6-gold is further advertised towards ASBR1 via EBGP CT as
      shown below.<a href="#appendix-D-11" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-processing-at-asbr2-2"></span><figure id="figure-18">
        <div class="alignLeft art-text artwork" id="appendix-D-12.1">
<pre>  ASBR2: IPv6 FIB for SRv6

      [BGP-CT]PE2-SRv6-gold,
        NH: Gold SRv6-Tunnel-to-PE2

      [BGP-CT]PE2-SRv6-bronze,
        NH: Bronze SRv6-Tunnel-to-PE2


  EBGP-CT: ASBR2---&gt;ASBR1

      RD1:PE2-SRv6-gold,
        transport-target:0:100,
        Prefix-SID: PE2-SRv6-gold,
        NH: ASBR2_InterAS_Link

      RD2:PE2-SRv6-bronze,
        transport-target:0:200,
        Prefix-SID: PE2-SRv6-bronze,
        NH: ASBR2_InterAS_Link</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-bgp-ct-processing-at-asbr2-2" class="selfRef">BGP CT processing at ASBR2</a>
        </figcaption></figure>
<p id="appendix-D-13">When ASBR1 receives the EBGP CT advertisement from ASBR2, a route for
      PE2-SRv6-gold is installed with a nexthop of ASBR1_InterAS_Link in the
      global IPv6 FIB for enabling SRv6 forwarding. The BGP-CT route for
      RD1:PE2-SRv6-gold is further advertised with SID ASBR1-SRv6-gold towards
      PE1 via IBGP CT as shown below.<a href="#appendix-D-13" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-processing-at-asbr1-2"></span><figure id="figure-19">
        <div class="alignLeft art-text artwork" id="appendix-D-14.1">
<pre>  ASBR1: IPv6 FIB for SRv6

      [BGP-CT]PE2-SRv6-gold,
        NH: ASBR2_InterAS_Link

      [BGP-CT]PE2-SRv6-bronze,
        NH: ASBR2_InterAS_Link


  IBGP-CT: ASBR1---&gt;PE1

      RD1:PE2-SRv6-gold,
        transport-target:0:100,
        Prefix-SID: ASBR1-SRv6-gold,
        NH: ASBR1-LPBK

      RD2:PE2-SRv6-bronze,
        transport-target:0:200,
        Prefix-SID: ASBR1-SRv6-bronze,
        NH: ASBR1-LPBK</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-bgp-ct-processing-at-asbr1-2" class="selfRef">BGP CT processing at ASBR1</a>
        </figcaption></figure>
<p id="appendix-D-15">When PE1 receives the IBGP CT advertisement from ASBR1, it resolves
      the SID ASBR1-SRv6-gold in its corresponding TRDB over the SRv6 underlay
      tunnel installed by SRv6-ISIS. Furthermore, any service routes requiring
      intent based resolution will use the Resolution Scheme associated with
      its Mapping Community to resolve over the PE2-SRv6-gold CT route
      installed in the gold TRDB.<a href="#appendix-D-15" class="pilcrow">¶</a></p>
<span id="name-bgp-ct-processing-at-pe1-2"></span><figure id="figure-20">
        <div class="alignLeft art-text artwork" id="appendix-D-16.1">
<pre>  PE1: IPv6 FIB for SRv6

      [BGP-INET] SVC_PFX1, color:0:100
        NH: PE2-SRv6-gold, Gold SRv6-Tunnel-to-ASBR1

      [BGP-INET] SVC_PFX2, color:0:200
        NH: PE2-SRv6-bronze, Bronze SRv6-Tunnel-to-ASBR1

      [BGP-CT]PE2-SRv6-gold,
        NH: Gold SRv6-Tunnel-to-ASBR1

      [BGP-CT]PE2-SRv6-bronze,
        NH: Bronze SRv6-Tunnel-to-ASBR1</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-bgp-ct-processing-at-pe1-2" class="selfRef">BGP CT processing at PE1</a>
        </figcaption></figure>
<p id="appendix-D-17">Similar processing is followed for the bronze transport plane as
      well.<a href="#appendix-D-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Contributors">
<section id="appendix-E">
      <h2 id="name-contributors-2">
<a href="#name-contributors-2" class="section-name selfRef">Contributors</a>
      </h2>
<div id="Co-Authors">
<section id="appendix-E.1">
        <h3 id="name-co-authors-2">
<a href="#name-co-authors-2" class="section-name selfRef">Co-Authors</a>
        </h3>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Israel Means</span></div>
<div dir="auto" class="left"><span class="org">AT&amp;T</span></div>
<div dir="auto" class="left"><span class="street-address">2212 Avenida Mara,</span></div>
<div dir="auto" class="left">
<span class="locality">Chula Vista</span>, <span class="region">California</span> <span class="postal-code">91914</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:israel.means@att.com" class="email">israel.means@att.com</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Csaba Mate</span></div>
<div dir="auto" class="left"><span class="org">KIFU, Hungarian NREN</span></div>
<div dir="auto" class="left"><span class="locality">Budapest</span></div>
<div dir="auto" class="left"><span class="street-address">35 Vaci street,</span></div>
<div dir="auto" class="left"><span class="postal-code">1134</span></div>
<div dir="auto" class="left"><span class="country-name">Hungary</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ietf@nop.hu" class="email">ietf@nop.hu</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Deepak J Gowda</span></div>
<div dir="auto" class="left"><span class="org">Extreme Networks</span></div>
<div dir="auto" class="left"><span class="street-address">55 Commerce Valley Drive West, Suite 300,</span></div>
<div dir="auto" class="left">
<span class="locality">Thornhill, Toronto,</span> <span class="region">Ontario</span> <span class="postal-code">L3T 7V9</span>
</div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dgowda@extremenetworks.com" class="email">dgowda@extremenetworks.com</a>
</div>
</address>
</section>
</div>
<div id="Other_Contributors">
<section id="appendix-E.2">
        <h3 id="name-other-contributors-2">
<a href="#name-other-contributors-2" class="section-name selfRef">Other Contributors</a>
        </h3>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Balaji Rajagopalan</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">Electra, Exora Business Park~Marathahalli - Sarjapur Outer Ring Road,</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560103</span>
</div>
<div dir="auto" class="left"><span class="region">KA</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:balajir@juniper.net" class="email">balajir@juniper.net</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Reshma Das</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1133 Innovation Way,</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dreshma@juniper.net" class="email">dreshma@juniper.net</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Rajesh M</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">Electra, Exora Business Park~Marathahalli - Sarjapur Outer Ring Road,</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560103</span>
</div>
<div dir="auto" class="left"><span class="region">KA</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mrajesh@juniper.net" class="email">mrajesh@juniper.net</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Chaitanya Yadlapalli</span></div>
<div dir="auto" class="left"><span class="org">AT&amp;T</span></div>
<div dir="auto" class="left"><span class="street-address">200 S Laurel Ave,</span></div>
<div dir="auto" class="left">
<span class="locality">Middletown,</span>, <span class="region">NJ</span> <span class="postal-code">07748</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cy098d@att.com" class="email">cy098d@att.com</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Gyan Mishra</span></div>
<div dir="auto" class="left"><span class="org">Verizon Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">13101 Columbia Pike</span></div>
<div dir="auto" class="left">
<span class="locality">Silver Spring</span>, <span class="region">MD</span> <span class="postal-code">20904</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gyan.s.mishra@verizon.com" class="email">gyan.s.mishra@verizon.com</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Mazen Khaddam</span></div>
<div dir="auto" class="left"><span class="org">Cox Communications Inc.</span></div>
<div dir="auto" class="left">
<span class="locality">Atlanta</span>, <span class="region">GA</span> </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mazen.khaddam@cox.com" class="email">mazen.khaddam@cox.com</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Rafal Jan Szarecki</span></div>
<div dir="auto" class="left"><span class="org">Google.</span></div>
<div dir="auto" class="left"><span class="street-address">1160 N Mathilda Ave, Bldg 5,</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale,</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:szarecki@google.com" class="email">szarecki@google.com</a>
</div>
</address>
<address class="vcard">
          <div dir="auto" class="left"><span class="fn nameRole">Xiaohu Xu</span></div>
<div dir="auto" class="left"><span class="org">Capitalonline.</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:xiaohu.xu@capitalonline.net" class="email">xiaohu.xu@capitalonline.net</a>
</div>
</address>
</section>
</div>
</section>
</div>
<div id="Acknowledgements">
<section id="appendix-F">
      <h2 id="name-acknowledgements-2">
<a href="#name-acknowledgements-2" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-F-1">The authors thank Jeff Haas, John Scudder, Susan Hares, Moses
      Nagarajah, Navaneetha Krishnan, Ravi M R, Chandrasekar Ramachandran,
      Shradha Hegde, Richard Roberts, Krzysztof Szarkowicz, John E Drake,
      Srihari Sangli, Vijay Kestur, Santosh Kolenchery, Robert Raszuk, Ahmed
      Darwish, Aravind Srinivas Srinivasa Prabhakar, Moshiko Nayman, Chris
      Trip for the valuable discussions and review comments.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<p id="appendix-F-2">The decision to not reuse SAFI 128 and create a new address-family to
      carry these transport-routes was based on suggestion made by Richard
      Roberts and Krzysztof Szarkowicz.<a href="#appendix-F-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-G">
      <h2 id="name-authors-addresses-2">
<a href="#name-authors-addresses-2" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kaliraj Vairavakkalai (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1133 Innovation Way,</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:kaliraj@juniper.net" class="email">kaliraj@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Natrajan Venkataraman (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1133 Innovation Way,</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94089</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:natv@juniper.net" class="email">natv@juniper.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
